{"file_contents":{"client/src/pages/manager/ManagerDashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { format, isToday, isTomorrow, startOfDay } from \"date-fns\";\nimport {\n  Calendar,\n  UserCheck,\n  UserMinus,\n  Clock,\n  ArrowRight,\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport type { BookingWithDetails, BookingStatus } from \"@shared/schema\";\n\nconst statusColors: Record<BookingStatus, string> = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400\",\n  confirmed: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\",\n  checked_in: \"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400\",\n  checked_out: \"bg-gray-100 text-gray-800 dark:bg-gray-800/50 dark:text-gray-400\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400\",\n};\n\nconst statusLabels: Record<BookingStatus, string> = {\n  pending: \"Pending\",\n  confirmed: \"Confirmed\",\n  checked_in: \"Checked In\",\n  checked_out: \"Checked Out\",\n  cancelled: \"Cancelled\",\n};\n\ninterface ManagerStats {\n  todayCheckIns: number;\n  todayCheckOuts: number;\n  currentGuests: number;\n  pendingBookings: number;\n}\n\nexport default function ManagerDashboard() {\n  const { data: stats, isLoading: isLoadingStats } = useQuery<ManagerStats>({\n    queryKey: [\"/api/manager/stats\"],\n  });\n\n  const { data: todayBookings, isLoading: isLoadingBookings } = useQuery<BookingWithDetails[]>({\n    queryKey: [\"/api/manager/bookings/today\"],\n  });\n\n  const checkInsToday = todayBookings?.filter(\n    (b) =>\n      (b.status === \"confirmed\" || b.status === \"pending\") &&\n      isToday(new Date(b.checkInDate))\n  );\n\n  const checkOutsToday = todayBookings?.filter(\n    (b) => b.status === \"checked_in\" && isToday(new Date(b.checkOutDate))\n  );\n\n  const statCards = [\n    {\n      title: \"Today's Check-ins\",\n      value: stats?.todayCheckIns ?? 0,\n      icon: UserCheck,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-100 dark:bg-green-900/30\",\n    },\n    {\n      title: \"Today's Check-outs\",\n      value: stats?.todayCheckOuts ?? 0,\n      icon: UserMinus,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-100 dark:bg-blue-900/30\",\n    },\n    {\n      title: \"Current Guests\",\n      value: stats?.currentGuests ?? 0,\n      icon: Calendar,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-100 dark:bg-purple-900/30\",\n    },\n    {\n      title: \"Pending Bookings\",\n      value: stats?.pendingBookings ?? 0,\n      icon: Clock,\n      color: \"text-amber-600\",\n      bgColor: \"bg-amber-100 dark:bg-amber-900/30\",\n    },\n  ];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold\">Manager Dashboard</h1>\n          <p className=\"text-muted-foreground\">\n            {format(new Date(), \"EEEE, MMMM d, yyyy\")}\n          </p>\n        </div>\n        <Button asChild>\n          <Link href=\"/manager/bookings\" data-testid=\"link-view-all-bookings\">\n            View All Bookings\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n          </Link>\n        </Button>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {statCards.map((stat) => (\n          <Card key={stat.title}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">{stat.title}</p>\n                  {isLoadingStats ? (\n                    <Skeleton className=\"h-8 w-16 mt-1\" />\n                  ) : (\n                    <p className=\"text-2xl font-bold\" data-testid={`stat-${stat.title.toLowerCase().replace(/'/g, \"\").replace(/ /g, \"-\")}`}>\n                      {stat.value}\n                    </p>\n                  )}\n                </div>\n                <div className={`p-3 rounded-full ${stat.bgColor}`}>\n                  <stat.icon className={`h-5 w-5 ${stat.color}`} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <UserCheck className=\"h-5 w-5 text-green-600\" />\n              Check-ins Today\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoadingBookings ? (\n              <div className=\"space-y-3\">\n                {[...Array(3)].map((_, i) => (\n                  <div key={i} className=\"flex items-center gap-3\">\n                    <Skeleton className=\"h-10 w-10 rounded\" />\n                    <div className=\"flex-1 space-y-1\">\n                      <Skeleton className=\"h-4 w-1/2\" />\n                      <Skeleton className=\"h-3 w-1/3\" />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : checkInsToday && checkInsToday.length > 0 ? (\n              <div className=\"space-y-3\">\n                {checkInsToday.map((booking) => (\n                  <div\n                    key={booking._id}\n                    className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\n                    data-testid={`checkin-${booking._id}`}\n                  >\n                    <div>\n                      <p className=\"font-medium\">\n                        {booking.user?.firstName} {booking.user?.lastName}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {booking.room?.name} - Room {booking.room?.roomNumber}\n                      </p>\n                    </div>\n                    <Badge className={statusColors[booking.status]}>\n                      {statusLabels[booking.status]}\n                    </Badge>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-center text-muted-foreground py-8\">\n                No check-ins scheduled for today.\n              </p>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <UserMinus className=\"h-5 w-5 text-blue-600\" />\n              Check-outs Today\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoadingBookings ? (\n              <div className=\"space-y-3\">\n                {[...Array(3)].map((_, i) => (\n                  <div key={i} className=\"flex items-center gap-3\">\n                    <Skeleton className=\"h-10 w-10 rounded\" />\n                    <div className=\"flex-1 space-y-1\">\n                      <Skeleton className=\"h-4 w-1/2\" />\n                      <Skeleton className=\"h-3 w-1/3\" />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : checkOutsToday && checkOutsToday.length > 0 ? (\n              <div className=\"space-y-3\">\n                {checkOutsToday.map((booking) => (\n                  <div\n                    key={booking._id}\n                    className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\n                    data-testid={`checkout-${booking._id}`}\n                  >\n                    <div>\n                      <p className=\"font-medium\">\n                        {booking.user?.firstName} {booking.user?.lastName}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {booking.room?.name} - Room {booking.room?.roomNumber}\n                      </p>\n                    </div>\n                    <Badge className={statusColors[booking.status]}>\n                      {statusLabels[booking.status]}\n                    </Badge>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <p className=\"text-center text-muted-foreground py-8\">\n                No check-outs scheduled for today.\n              </p>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8327,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"server/routes/rooms.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { Room, Review, Booking } from '../db/models';\n\nconst router = Router();\n\nrouter.get('/', async (req: Request, res: Response) => {\n  try {\n    const {\n      category,\n      minPrice,\n      maxPrice,\n      amenities,\n      limit = '20',\n      offset = '0',\n    } = req.query;\n\n    const filter: any = { isAvailable: true };\n\n    if (category) {\n      filter.category = category;\n    }\n\n    if (minPrice || maxPrice) {\n      filter.pricePerNight = {};\n      if (minPrice) filter.pricePerNight.$gte = Number(minPrice);\n      if (maxPrice) filter.pricePerNight.$lte = Number(maxPrice);\n    }\n\n    if (amenities) {\n      const amenityList = (amenities as string).split(',').map(a => a.trim());\n      filter.amenities = { $all: amenityList };\n    }\n\n    const rooms = await Room.find(filter)\n      .limit(Number(limit))\n      .skip(Number(offset))\n      .sort({ createdAt: -1 });\n\n    const roomsWithReviews = await Promise.all(\n      rooms.map(async (room) => {\n        const reviews = await Review.find({ roomId: room._id })\n          .populate('userId', 'firstName lastName')\n          .sort({ createdAt: -1 });\n\n        const averageRating =\n          reviews.length > 0\n            ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length\n            : 0;\n\n        return {\n          ...room.toJSON(),\n          reviews: reviews.map((r) => ({\n            ...r.toJSON(),\n            user: r.userId,\n          })),\n          averageRating,\n        };\n      })\n    );\n\n    res.json(roomsWithReviews);\n  } catch (error) {\n    console.error('Error fetching rooms:', error);\n    res.status(500).json({ message: 'Failed to fetch rooms' });\n  }\n});\n\nrouter.get('/:id', async (req: Request, res: Response) => {\n  try {\n    const room = await Room.findById(req.params.id);\n    if (!room) {\n      return res.status(404).json({ message: 'Room not found' });\n    }\n\n    const reviews = await Review.find({ roomId: room._id })\n      .populate('userId', 'firstName lastName')\n      .sort({ createdAt: -1 });\n\n    const averageRating =\n      reviews.length > 0\n        ? reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length\n        : 0;\n\n    res.json({\n      ...room.toJSON(),\n      reviews: reviews.map((r) => ({\n        ...r.toJSON(),\n        user: r.userId,\n      })),\n      averageRating,\n    });\n  } catch (error) {\n    console.error('Error fetching room:', error);\n    res.status(500).json({ message: 'Failed to fetch room' });\n  }\n});\n\nrouter.get('/:id/availability', async (req: Request, res: Response) => {\n  try {\n    const { checkIn, checkOut } = req.query;\n    \n    if (!checkIn || !checkOut) {\n      return res.status(400).json({ message: 'Check-in and check-out dates required' });\n    }\n\n    const checkInDate = new Date(checkIn as string);\n    const checkOutDate = new Date(checkOut as string);\n\n    const conflictingBookings = await Booking.find({\n      roomId: req.params.id,\n      status: { $nin: ['cancelled'] },\n      $or: [\n        {\n          checkInDate: { $lt: checkOutDate },\n          checkOutDate: { $gt: checkInDate },\n        },\n      ],\n    });\n\n    res.json({\n      available: conflictingBookings.length === 0,\n      conflictingBookings: conflictingBookings.length,\n    });\n  } catch (error) {\n    console.error('Error checking availability:', error);\n    res.status(500).json({ message: 'Failed to check availability' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":3448,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"server/services/email.ts":{"content":"import nodemailer from 'nodemailer';\nimport { IBooking } from '../db/models/Booking';\nimport { IRoom } from '../db/models/Room';\nimport { IUser } from '../db/models/User';\n\nlet transporter: nodemailer.Transporter | null = null;\n\nfunction getTransporter() {\n  const smtpUser = process.env.SMTP_USER?.trim();\n  const smtpPass = process.env.SMTP_PASS?.trim();\n  \n  if (!smtpUser || !smtpPass) {\n    return null;\n  }\n  \n  if (!transporter) {\n    transporter = nodemailer.createTransport({\n      host: process.env.SMTP_HOST || 'smtp.gmail.com',\n      port: parseInt(process.env.SMTP_PORT || '587'),\n      secure: false,\n      auth: {\n        user: smtpUser,\n        pass: smtpPass,\n      },\n    });\n  }\n  \n  return transporter;\n}\n\nexport async function sendBookingConfirmation(\n  user: IUser,\n  booking: IBooking,\n  room: IRoom\n): Promise<void> {\n  const checkIn = new Date(booking.checkInDate).toLocaleDateString('en-US', {\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n  });\n  \n  const checkOut = new Date(booking.checkOutDate).toLocaleDateString('en-US', {\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric',\n  });\n\n  const mailOptions = {\n    from: '\"Grand Horizon Hotel\" <bookings@grandhorizon.com>',\n    to: user.email,\n    subject: 'Booking Confirmation - Grand Horizon Hotel',\n    html: `\n      <div style=\"font-family: 'Helvetica Neue', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n        <div style=\"text-align: center; padding: 20px; background: linear-gradient(135deg, #1a365d 0%, #2563eb 100%); border-radius: 12px 12px 0 0;\">\n          <h1 style=\"color: white; margin: 0; font-size: 28px;\">Grand Horizon Hotel</h1>\n          <p style=\"color: rgba(255,255,255,0.9); margin-top: 8px;\">Your Booking is Confirmed!</p>\n        </div>\n        \n        <div style=\"background: #f8fafc; padding: 30px; border-radius: 0 0 12px 12px;\">\n          <h2 style=\"color: #1a365d; margin-top: 0;\">Hello ${user.firstName},</h2>\n          \n          <p style=\"color: #475569; line-height: 1.6;\">\n            Thank you for choosing Grand Horizon Hotel. We're excited to welcome you!\n          </p>\n          \n          <div style=\"background: white; border-radius: 8px; padding: 20px; margin: 20px 0; border: 1px solid #e2e8f0;\">\n            <h3 style=\"color: #1a365d; margin-top: 0;\">Booking Details</h3>\n            \n            <table style=\"width: 100%; border-collapse: collapse;\">\n              <tr>\n                <td style=\"padding: 8px 0; color: #64748b;\">Room</td>\n                <td style=\"padding: 8px 0; color: #1e293b; font-weight: 500; text-align: right;\">\n                  ${room.name} (${room.category})\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #64748b;\">Room Number</td>\n                <td style=\"padding: 8px 0; color: #1e293b; font-weight: 500; text-align: right;\">\n                  ${room.roomNumber}\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #64748b;\">Check-in</td>\n                <td style=\"padding: 8px 0; color: #1e293b; font-weight: 500; text-align: right;\">\n                  ${checkIn}\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #64748b;\">Check-out</td>\n                <td style=\"padding: 8px 0; color: #1e293b; font-weight: 500; text-align: right;\">\n                  ${checkOut}\n                </td>\n              </tr>\n              <tr>\n                <td style=\"padding: 8px 0; color: #64748b;\">Guests</td>\n                <td style=\"padding: 8px 0; color: #1e293b; font-weight: 500; text-align: right;\">\n                  ${booking.guestCount}\n                </td>\n              </tr>\n              <tr style=\"border-top: 1px solid #e2e8f0;\">\n                <td style=\"padding: 12px 0; color: #1a365d; font-weight: 600;\">Total Amount</td>\n                <td style=\"padding: 12px 0; color: #1a365d; font-weight: 600; text-align: right; font-size: 18px;\">\n                  $${booking.totalPrice}\n                </td>\n              </tr>\n            </table>\n          </div>\n          \n          ${booking.specialRequests ? `\n            <div style=\"background: #fffbeb; border-radius: 8px; padding: 15px; margin: 20px 0; border-left: 4px solid #f59e0b;\">\n              <strong style=\"color: #92400e;\">Special Requests:</strong>\n              <p style=\"color: #78350f; margin: 8px 0 0 0;\">${booking.specialRequests}</p>\n            </div>\n          ` : ''}\n          \n          <div style=\"background: #f0fdf4; border-radius: 8px; padding: 15px; margin: 20px 0;\">\n            <h4 style=\"color: #166534; margin: 0 0 8px 0;\">Important Information</h4>\n            <ul style=\"color: #15803d; margin: 0; padding-left: 20px; line-height: 1.6;\">\n              <li>Check-in time: 3:00 PM</li>\n              <li>Check-out time: 11:00 AM</li>\n              <li>Please bring a valid ID for check-in</li>\n            </ul>\n          </div>\n          \n          <p style=\"color: #475569; line-height: 1.6;\">\n            If you have any questions or need to modify your booking, please don't hesitate to contact us.\n          </p>\n          \n          <p style=\"color: #475569; margin-bottom: 0;\">\n            We look forward to welcoming you!<br>\n            <strong style=\"color: #1a365d;\">The Grand Horizon Team</strong>\n          </p>\n        </div>\n        \n        <div style=\"text-align: center; padding: 20px; color: #94a3b8; font-size: 12px;\">\n          <p>123 Ocean Drive, Paradise Bay, CA 90210</p>\n          <p>Phone: +1 (555) 123-4567 | Email: info@grandhorizon.com</p>\n        </div>\n      </div>\n    `,\n  };\n\n  try {\n    const mailTransporter = getTransporter();\n    \n    if (!mailTransporter) {\n      console.log('Email not configured (SMTP_USER/SMTP_PASS not set) - skipping email notification');\n      return;\n    }\n    \n    await mailTransporter.sendMail(mailOptions);\n    console.log('Booking confirmation email sent to:', user.email);\n  } catch (error) {\n    console.error('Failed to send booking confirmation email:', error);\n  }\n}\n","path":null,"size_bytes":6172,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/pages/auth/Login.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation, useSearch } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Hotel, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth\";\nimport { api } from \"@/lib/api\";\nimport { loginUserSchema, type LoginUser, type AuthResponse } from \"@shared/schema\";\n\nexport default function Login() {\n  const [, setLocation] = useLocation();\n  const search = useSearch();\n  const redirect = new URLSearchParams(search).get(\"redirect\") || \"/\";\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<LoginUser>({\n    resolver: zodResolver(loginUserSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  const onSubmit = async (data: LoginUser) => {\n    setIsLoading(true);\n    try {\n      const response = await api.post<AuthResponse>(\"/auth/login\", data);\n      login(response.token, response.user);\n      toast({\n        title: \"Welcome back!\",\n        description: \"You have successfully signed in.\",\n      });\n      setLocation(redirect);\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Invalid email or password.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <Link href=\"/\" className=\"flex items-center justify-center gap-2 mb-4\">\n            <Hotel className=\"h-8 w-8 text-primary\" />\n            <span className=\"font-serif text-xl font-semibold\">Grand Horizon</span>\n          </Link>\n          <CardTitle className=\"text-2xl\">Welcome back</CardTitle>\n          <CardDescription>\n            Sign in to your account to continue\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"you@example.com\"\n                        {...field}\n                        data-testid=\"input-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Enter your password\"\n                        {...field}\n                        data-testid=\"input-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={isLoading}\n                data-testid=\"button-login\"\n              >\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                Sign In\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center text-sm\">\n            <span className=\"text-muted-foreground\">Don't have an account? </span>\n            <Link\n              href=\"/register\"\n              className=\"text-primary hover:underline font-medium\"\n              data-testid=\"link-register\"\n            >\n              Sign up\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4524,"size_tokens":null},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\nimport { User, IUser } from '../db/models';\n\nconst JWT_SECRET = process.env.JWT_SECRET || process.env.SESSION_SECRET || 'your-secret-key';\n\nexport interface AuthRequest extends Request {\n  user?: IUser;\n}\n\nexport function generateToken(userId: string): string {\n  return jwt.sign({ userId }, JWT_SECRET, { expiresIn: '7d' });\n}\n\nexport async function authenticate(req: AuthRequest, res: Response, next: NextFunction) {\n  try {\n    const authHeader = req.headers.authorization;\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res.status(401).json({ message: 'Authentication required' });\n    }\n\n    const token = authHeader.split(' ')[1];\n    const decoded = jwt.verify(token, JWT_SECRET) as { userId: string };\n    \n    const user = await User.findById(decoded.userId);\n    if (!user) {\n      return res.status(401).json({ message: 'User not found' });\n    }\n\n    req.user = user;\n    next();\n  } catch (error) {\n    return res.status(401).json({ message: 'Invalid token' });\n  }\n}\n\nexport function requireRole(...roles: Array<'customer' | 'manager' | 'admin'>) {\n  return (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user) {\n      return res.status(401).json({ message: 'Authentication required' });\n    }\n\n    if (!roles.includes(req.user.role)) {\n      return res.status(403).json({ message: 'Access denied' });\n    }\n\n    next();\n  };\n}\n","path":null,"size_bytes":1484,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nfunction getAuthToken(): string | null {\n  return localStorage.getItem(\"token\");\n}\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const data = await res.json().catch(() => ({ message: res.statusText }));\n    throw new Error(data.message || `${res.status}: ${res.statusText}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const token = getAuthToken();\n  const headers: HeadersInit = {\n    ...(data ? { \"Content-Type\": \"application/json\" } : {}),\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\n  };\n\n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const token = getAuthToken();\n    const url = typeof queryKey[0] === \"string\" ? queryKey[0] : \"\";\n    \n    const res = await fetch(url, {\n      credentials: \"include\",\n      headers: {\n        ...(token ? { Authorization: `Bearer ${token}` } : {}),\n      },\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: 5 * 60 * 1000,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1833,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"server/db/models/PromoCode.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IPromoCode extends Document {\n  _id: mongoose.Types.ObjectId;\n  code: string;\n  description?: string;\n  discountType: 'percentage' | 'fixed';\n  discountValue: number;\n  minBookingAmount: number;\n  maxDiscountAmount?: number;\n  validFrom: Date;\n  validTo: Date;\n  usageLimit?: number;\n  usageCount: number;\n  isActive: boolean;\n  createdAt: Date;\n}\n\nconst promoCodeSchema = new Schema<IPromoCode>({\n  code: {\n    type: String,\n    required: true,\n    unique: true,\n    uppercase: true,\n    trim: true,\n    minlength: 3,\n    maxlength: 20,\n  },\n  description: {\n    type: String,\n  },\n  discountType: {\n    type: String,\n    enum: ['percentage', 'fixed'],\n    required: true,\n  },\n  discountValue: {\n    type: Number,\n    required: true,\n    min: 0,\n  },\n  minBookingAmount: {\n    type: Number,\n    default: 0,\n    min: 0,\n  },\n  maxDiscountAmount: {\n    type: Number,\n    min: 0,\n  },\n  validFrom: {\n    type: Date,\n    required: true,\n  },\n  validTo: {\n    type: Date,\n    required: true,\n  },\n  usageLimit: {\n    type: Number,\n    min: 1,\n  },\n  usageCount: {\n    type: Number,\n    default: 0,\n    min: 0,\n  },\n  isActive: {\n    type: Boolean,\n    default: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\n// Note: code field already has unique: true which creates an index\npromoCodeSchema.index({ isActive: 1, validFrom: 1, validTo: 1 });\n\npromoCodeSchema.set('toJSON', {\n  transform: function (doc, ret) {\n    ret._id = ret._id.toString();\n    delete ret.__v;\n    return ret;\n  },\n});\n\nexport const PromoCode = mongoose.model<IPromoCode>('PromoCode', promoCodeSchema);\n","path":null,"size_bytes":1671,"size_tokens":null},"server/db/models/Room.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IRoom extends Document {\n  _id: mongoose.Types.ObjectId;\n  name: string;\n  description: string;\n  category: 'Standard' | 'Deluxe' | 'Suite' | 'Executive' | 'Presidential' | 'Family' | 'Penthouse';\n  pricePerNight: number;\n  capacity: number;\n  images: string[];\n  amenities: string[];\n  isAvailable: boolean;\n  roomNumber: string;\n  createdAt: Date;\n}\n\nconst roomSchema = new Schema<IRoom>({\n  name: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  description: {\n    type: String,\n    required: true,\n    minlength: 10,\n  },\n  category: {\n    type: String,\n    enum: ['Standard', 'Deluxe', 'Suite', 'Executive', 'Presidential', 'Family', 'Penthouse'],\n    required: true,\n  },\n  pricePerNight: {\n    type: Number,\n    required: true,\n    min: 0,\n  },\n  capacity: {\n    type: Number,\n    required: true,\n    min: 1,\n  },\n  images: [{\n    type: String,\n  }],\n  amenities: [{\n    type: String,\n  }],\n  isAvailable: {\n    type: Boolean,\n    default: true,\n  },\n  roomNumber: {\n    type: String,\n    required: true,\n    unique: true,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\nroomSchema.set('toJSON', {\n  transform: function (doc, ret) {\n    ret._id = ret._id.toString();\n    delete ret.__v;\n    return ret;\n  },\n});\n\nexport const Room = mongoose.model<IRoom>('Room', roomSchema);\n","path":null,"size_bytes":1391,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"design_guidelines.md":{"content":"# Hotel Booking System Design Guidelines\n\n## Design Approach\n\n**Reference-Based Approach**: Drawing inspiration from leading hospitality platforms (Airbnb, Booking.com, Marriott) to create a trustworthy, visually appealing booking experience that balances elegance with functionality.\n\n**Core Design Principles**:\n- Visual trust through generous imagery and clean layouts\n- Intuitive booking flow with clear status indicators\n- Professional dashboard interfaces for admin/manager roles\n- Consistent spacing and hierarchy across all pages\n\n---\n\n## Typography\n\n**Font Stack**: \n- Primary: Inter or DM Sans (headers, UI elements)\n- Secondary: System font stack for body text\n\n**Hierarchy**:\n- H1: 3xl to 5xl (Hero headlines)\n- H2: 2xl to 3xl (Section headers)\n- H3: xl to 2xl (Card titles, subsection headers)\n- Body: base to lg (descriptions, content)\n- Small: sm to xs (captions, meta info)\n\n**Weights**: Regular (400), Medium (500), Semibold (600), Bold (700)\n\n---\n\n## Layout System\n\n**Spacing Units**: Tailwind units of 2, 4, 6, 8, 12, 16, 20, 24\n- Component padding: p-4 to p-8\n- Section spacing: py-12 to py-24\n- Card gaps: gap-4 to gap-6\n- Grid gaps: gap-6 to gap-8\n\n**Container Widths**:\n- Full-width sections: w-full with max-w-7xl mx-auto\n- Content sections: max-w-6xl\n- Forms/dashboards: max-w-4xl\n\n**Grid System**:\n- Room cards: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Dashboard stats: grid-cols-2 lg:grid-cols-4\n- Admin tables: Full-width responsive tables\n\n---\n\n## Component Library\n\n### Navigation\n- Sticky header with logo (left), navigation links (center), user menu (right)\n- Mobile: Hamburger menu with slide-out drawer\n- Include CTA button: \"Book Now\" or user avatar with dropdown\n- Height: h-16 to h-20\n\n### Hero Section\n- **Large hero banner** (h-[500px] to h-[600px])\n- Background image with overlay for text readability\n- Centered content: Hotel name/logo, tagline, search bar\n- Search bar with date pickers, guest selector, search button\n- Buttons on image: Use backdrop-blur-sm with semi-transparent backgrounds\n- Responsive: h-[400px] on mobile, full height on desktop\n\n### Room Cards\n- Image carousel (3-5 images per room)\n- Room type badge, price prominently displayed\n- Amenities icons (WiFi, AC, TV, etc.) in grid\n- \"View Details\" button\n- Hover: Subtle lift effect (shadow increase)\n\n### Room Detail Page\n- Large image gallery (masonry or carousel layout)\n- Two-column layout: Images (60%), booking panel (40%)\n- Sticky booking panel on desktop\n- Amenities grid with icons\n- Reviews section with star ratings and customer photos\n- \"Book Now\" sticky footer on mobile\n\n### Booking Flow\n- Multi-step indicator (Select Dates  Review  Payment  Confirmation)\n- Booking summary card always visible\n- Form sections with clear labels and validation\n- Status badges for booking states:\n  - Pending: Soft yellow/amber\n  - Confirmed: Green\n  - Checked-In: Blue\n  - Checked-Out: Gray\n  - Cancelled: Red\n\n### Dashboards (Admin/Manager)\n- Sidebar navigation (200px to 240px width)\n- Main content area with stats cards at top\n- Data tables with sorting, filtering, pagination\n- Action buttons (Edit, Delete, Update Status) in table rows\n- Modal overlays for forms and confirmations\n\n### Forms\n- Admin room management: Multi-column layout on desktop\n- Amenities: Dropdown with checkboxes, \"Other\" option reveals text input\n- Image upload: Drag-and-drop area with preview thumbnails\n- Consistent input styling with focus states\n- Floating labels or top-aligned labels\n\n### Buttons\n- Primary: Large, rounded corners (rounded-lg)\n- Secondary: Outline style\n- Icon buttons for actions\n- Loading states with spinners\n- All buttons implement hover/active states\n\n### Cards\n- Rounded corners (rounded-xl)\n- Subtle shadows (shadow-sm to shadow-lg)\n- Padding: p-6 to p-8\n- Hover states for interactive cards\n\n---\n\n## Images\n\n**Hero Section**:\n- Large, high-quality hotel exterior or luxury room image\n- Professional photography with warm, inviting tones\n- Image should convey comfort and hospitality\n\n**Room Galleries**:\n- Multiple angles: bed, bathroom, amenities, view\n- Consistent aspect ratio (4:3 or 16:9)\n- High resolution with proper compression\n\n**Placeholder Images**:\n- Use reputable placeholder services for development\n- Descriptive alt text for accessibility\n\n---\n\n## Page Layouts\n\n### Landing/Home Page\n1. **Large Hero** with search functionality\n2. Featured Rooms (3-column grid)\n3. Amenities/Services section with icons\n4. Testimonials/Reviews (carousel or grid)\n5. Call-to-action section\n6. Footer with links, contact info, newsletter signup\n\n### Room Listing Page\n- Filters sidebar (desktop) or drawer (mobile)\n- Grid of room cards\n- Pagination or infinite scroll\n- Sort options (price, rating, availability)\n\n### Customer Dashboard\n- Welcome section with user info\n- Tabs: Active Bookings, Past Bookings, Reviews\n- Booking cards with status, dates, actions\n- Empty states with helpful messages\n\n### Admin/Manager Panel\n- Sidebar with navigation sections\n- Dashboard: Stats cards + recent bookings table\n- Rooms page: Add button, searchable table\n- Bookings page: Filterable table with status updates\n- Room form: Grid layout with image upload area\n\n---\n\n## Accessibility & Interactions\n\n- Focus indicators on all interactive elements\n- ARIA labels for icons and actions\n- Keyboard navigation support\n- Form validation with clear error messages\n- Toast notifications for actions (top-right position)\n- Loading states for async operations\n- Disabled states clearly differentiated\n\n---\n\n## Responsive Behavior\n\n**Breakpoints**:\n- Mobile: < 768px (single column, stacked layouts)\n- Tablet: 768px - 1024px (2-column grids)\n- Desktop: > 1024px (3+ column grids, sidebars visible)\n\n**Mobile Optimizations**:\n- Sticky booking panel becomes fixed footer\n- Navigation collapses to hamburger\n- Tables switch to card-based lists\n- Filters move to bottom sheet/drawer\n- Touch-friendly button sizes (min h-12)","path":null,"size_bytes":5930,"size_tokens":null},"client/src/pages/PaymentComplete.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useParams, useLocation } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format, differenceInDays } from \"date-fns\";\nimport {\n  ArrowLeft,\n  Calendar,\n  Users,\n  CreditCard,\n  Check,\n  Loader2,\n  AlertCircle,\n  Bed,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport type { BookingWithDetails } from \"@shared/schema\";\n\nexport default function PaymentComplete() {\n  const { bookingId } = useParams<{ bookingId: string }>();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isConfirmed, setIsConfirmed] = useState(false);\n\n  const { data: booking, isLoading, error } = useQuery<BookingWithDetails>({\n    queryKey: [`/api/bookings/${bookingId}`],\n    enabled: !!bookingId,\n  });\n\n  const confirmPaymentMutation = useMutation({\n    mutationFn: async () => {\n      return api.post<{ success: boolean }>(`/bookings/${bookingId}/confirm-payment`);\n    },\n    onSuccess: () => {\n      setIsConfirmed(true);\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings/my\"] });\n      toast({\n        title: \"Payment Successful!\",\n        description: \"Your booking has been confirmed. Check your email for details.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Payment Failed\",\n        description: error.message || \"Payment processing failed. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <Skeleton className=\"h-8 w-32 mb-6\" />\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n            <div className=\"lg:col-span-2\">\n              <Skeleton className=\"h-64 rounded-xl\" />\n            </div>\n            <div>\n              <Skeleton className=\"h-96 rounded-xl\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !booking) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"h-12 w-12 mx-auto text-destructive mb-4\" />\n          <h2 className=\"text-2xl font-semibold mb-2\">Booking Not Found</h2>\n          <p className=\"text-muted-foreground mb-4\">\n            We couldn't find this booking. It may have been cancelled or doesn't exist.\n          </p>\n          <Button asChild>\n            <Link href=\"/dashboard\" data-testid=\"link-back-to-dashboard\">\n              Back to Dashboard\n            </Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  if (booking.status !== \"pending\" && !isConfirmed) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <Check className=\"h-12 w-12 mx-auto text-green-500 mb-4\" />\n          <h2 className=\"text-2xl font-semibold mb-2\">Already Processed</h2>\n          <p className=\"text-muted-foreground mb-4\">\n            This booking has already been processed. Current status: {booking.status}\n          </p>\n          <Button asChild>\n            <Link href=\"/dashboard\" data-testid=\"link-back-to-dashboard\">\n              Back to Dashboard\n            </Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  const room = booking.room;\n  const checkIn = new Date(booking.checkInDate);\n  const checkOut = new Date(booking.checkOutDate);\n  const nights = differenceInDays(checkOut, checkIn);\n\n  if (isConfirmed) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"max-w-2xl mx-auto\">\n            <Card>\n              <CardContent className=\"py-12 text-center\">\n                <div className=\"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6\">\n                  <Check className=\"h-8 w-8 text-green-600 dark:text-green-400\" />\n                </div>\n                <h2 className=\"text-2xl font-semibold mb-2\">Booking Confirmed!</h2>\n                <p className=\"text-muted-foreground mb-6\">\n                  Your reservation has been successfully confirmed.\n                  A confirmation email has been sent to your registered email address.\n                </p>\n                <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n                  <Button asChild>\n                    <Link href=\"/dashboard\" data-testid=\"link-view-bookings\">\n                      View My Bookings\n                    </Link>\n                  </Button>\n                  <Button variant=\"outline\" asChild>\n                    <Link href=\"/rooms\" data-testid=\"link-browse-more\">\n                      Browse More Rooms\n                    </Link>\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <Button variant=\"ghost\" asChild className=\"mb-6 gap-2\">\n          <Link href=\"/dashboard\" data-testid=\"link-back-to-dashboard\">\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Dashboard\n          </Link>\n        </Button>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <CreditCard className=\"h-5 w-5\" />\n                  Complete Your Payment\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <Alert>\n                  <AlertCircle className=\"h-4 w-4\" />\n                  <AlertDescription>\n                    This is a test environment. No real payment will be processed.\n                    Click \"Confirm Payment\" to simulate a successful payment.\n                  </AlertDescription>\n                </Alert>\n\n                <div className=\"p-6 border rounded-lg bg-muted/50\">\n                  <p className=\"text-center text-muted-foreground mb-4\">\n                    Stripe Payment Form would appear here in production\n                  </p>\n                  <div className=\"space-y-4\">\n                    <div className=\"h-10 bg-muted rounded-md\" />\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"h-10 bg-muted rounded-md\" />\n                      <div className=\"h-10 bg-muted rounded-md\" />\n                    </div>\n                  </div>\n                </div>\n\n                <Button\n                  className=\"w-full\"\n                  size=\"lg\"\n                  onClick={() => confirmPaymentMutation.mutate()}\n                  disabled={confirmPaymentMutation.isPending}\n                  data-testid=\"button-confirm-payment\"\n                >\n                  {confirmPaymentMutation.isPending && (\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  )}\n                  Confirm Payment (${booking.totalPrice})\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-24\">\n              <CardHeader>\n                <CardTitle>Booking Summary</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-4\">\n                  {room?.images && room.images.length > 0 ? (\n                    <img\n                      src={room.images[0]}\n                      alt={room?.name}\n                      className=\"w-20 h-20 object-cover rounded-lg\"\n                    />\n                  ) : (\n                    <div className=\"w-20 h-20 bg-muted rounded-lg flex items-center justify-center\">\n                      <Bed className=\"h-6 w-6 text-muted-foreground\" />\n                    </div>\n                  )}\n                  <div>\n                    <h3 className=\"font-semibold\">{room?.name || \"Room\"}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{room?.category}</p>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Check-in</span>\n                    <span>{format(checkIn, \"MMM d, yyyy\")}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Check-out</span>\n                    <span>{format(checkOut, \"MMM d, yyyy\")}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Guests</span>\n                    <span>{booking.guestCount}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Duration</span>\n                    <span>{nights} night{nights > 1 ? \"s\" : \"\"}</span>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"flex justify-between font-semibold text-lg\">\n                  <span>Total</span>\n                  <span>${booking.totalPrice}</span>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":10141,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/pages/admin/AdminRooms.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useDropzone } from \"react-dropzone\";\nimport {\n  Plus,\n  Pencil,\n  Trash2,\n  Loader2,\n  Upload,\n  X,\n  Search,\n  Image as ImageIcon,\n  Building,\n  CheckCircle,\n  Users,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api, uploadImages } from \"@/lib/api\";\nimport { insertRoomSchema, roomCategories, predefinedAmenities, type Room, type InsertRoom } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst roomFormSchema = insertRoomSchema.extend({\n  customAmenity: z.string().optional(),\n});\n\ntype RoomFormData = z.infer<typeof roomFormSchema>;\n\ninterface CategoryStats {\n  category: string;\n  totalRooms: number;\n  availableRooms: number;\n  occupiedRooms: number;\n}\n\ninterface RoomStats {\n  statsByCategory: CategoryStats[];\n  totals: {\n    totalRooms: number;\n    availableRooms: number;\n    occupiedRooms: number;\n  };\n  occupiedRoomIds: string[];\n}\n\nexport default function AdminRooms() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingRoom, setEditingRoom] = useState<Room | null>(null);\n  const [deleteRoomId, setDeleteRoomId] = useState<string | null>(null);\n  const [uploadedImages, setUploadedImages] = useState<string[]>([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [selectedAmenities, setSelectedAmenities] = useState<string[]>([]);\n  const [showCustomAmenity, setShowCustomAmenity] = useState(false);\n\n  const { data: rooms, isLoading } = useQuery<Room[]>({\n    queryKey: [\"/api/admin/rooms\"],\n  });\n\n  const { data: roomStats, isLoading: statsLoading } = useQuery<RoomStats>({\n    queryKey: [\"/api/admin/room-stats\"],\n  });\n\n  const form = useForm<RoomFormData>({\n    resolver: zodResolver(roomFormSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      category: \"Standard\",\n      pricePerNight: 100,\n      capacity: 2,\n      roomNumber: \"\",\n      images: [],\n      amenities: [],\n      isAvailable: true,\n      customAmenity: \"\",\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: async (data: InsertRoom) => {\n      return api.post<Room>(\"/admin/rooms\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/rooms\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/room-stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/rooms\"] });\n      toast({ title: \"Room created successfully\" });\n      handleCloseDialog();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create room\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<InsertRoom> }) => {\n      return api.put<Room>(`/admin/rooms/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/rooms\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/room-stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/rooms\"] });\n      toast({ title: \"Room updated successfully\" });\n      handleCloseDialog();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update room\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return api.delete(`/admin/rooms/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/rooms\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/room-stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/rooms\"] });\n      toast({ title: \"Room deleted successfully\" });\n      setDeleteRoomId(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete room\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    accept: { \"image/*\": [\".jpeg\", \".jpg\", \".png\", \".webp\"] },\n    maxFiles: 5,\n    onDrop: async (acceptedFiles) => {\n      if (acceptedFiles.length === 0) return;\n      setIsUploading(true);\n      try {\n        const urls = await uploadImages(acceptedFiles);\n        setUploadedImages((prev) => [...prev, ...urls]);\n      } catch (error: any) {\n        toast({\n          title: \"Upload Failed\",\n          description: error.message,\n          variant: \"destructive\",\n        });\n      } finally {\n        setIsUploading(false);\n      }\n    },\n  });\n\n  const handleOpenDialog = (room?: Room) => {\n    if (room) {\n      setEditingRoom(room);\n      form.reset({\n        name: room.name,\n        description: room.description,\n        category: room.category,\n        pricePerNight: room.pricePerNight,\n        capacity: room.capacity,\n        roomNumber: room.roomNumber,\n        images: room.images,\n        amenities: room.amenities,\n        isAvailable: room.isAvailable,\n        customAmenity: \"\",\n      });\n      setUploadedImages(room.images);\n      setSelectedAmenities(room.amenities);\n      const hasCustom = room.amenities.some(\n        (a) => !predefinedAmenities.includes(a as any)\n      );\n      setShowCustomAmenity(hasCustom);\n    } else {\n      setEditingRoom(null);\n      form.reset({\n        name: \"\",\n        description: \"\",\n        category: \"Standard\",\n        pricePerNight: 100,\n        capacity: 2,\n        roomNumber: \"\",\n        images: [],\n        amenities: [],\n        isAvailable: true,\n        customAmenity: \"\",\n      });\n      setUploadedImages([]);\n      setSelectedAmenities([]);\n      setShowCustomAmenity(false);\n    }\n    setIsDialogOpen(true);\n  };\n\n  const handleCloseDialog = () => {\n    setIsDialogOpen(false);\n    setEditingRoom(null);\n    setUploadedImages([]);\n    setSelectedAmenities([]);\n    setShowCustomAmenity(false);\n    form.reset();\n  };\n\n  const handleRemoveImage = (index: number) => {\n    setUploadedImages((prev) => prev.filter((_, i) => i !== index));\n  };\n\n  const handleAmenityToggle = (amenity: string, checked: boolean) => {\n    if (amenity === \"Other\") {\n      setShowCustomAmenity(checked);\n      if (!checked) {\n        form.setValue(\"customAmenity\", \"\");\n      }\n    } else {\n      setSelectedAmenities((prev) =>\n        checked ? [...prev, amenity] : prev.filter((a) => a !== amenity)\n      );\n    }\n  };\n\n  const onSubmit = (data: RoomFormData) => {\n    let amenities = [...selectedAmenities];\n    if (showCustomAmenity && data.customAmenity?.trim()) {\n      amenities.push(data.customAmenity.trim());\n    }\n\n    const roomData: InsertRoom = {\n      name: data.name,\n      description: data.description,\n      category: data.category,\n      pricePerNight: data.pricePerNight,\n      capacity: data.capacity,\n      roomNumber: data.roomNumber,\n      images: uploadedImages,\n      amenities,\n      isAvailable: data.isAvailable,\n    };\n\n    if (editingRoom) {\n      updateMutation.mutate({ id: editingRoom._id, data: roomData });\n    } else {\n      createMutation.mutate(roomData);\n    }\n  };\n\n  const filteredRooms = rooms?.filter((room) => {\n    if (!searchQuery) return true;\n    const query = searchQuery.toLowerCase();\n    return (\n      room.name.toLowerCase().includes(query) ||\n      room.roomNumber.toLowerCase().includes(query) ||\n      room.category.toLowerCase().includes(query)\n    );\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-bold\">Rooms</h1>\n          <p className=\"text-muted-foreground\">Manage your hotel rooms.</p>\n        </div>\n        <Button onClick={() => handleOpenDialog()} data-testid=\"button-add-room\">\n          <Plus className=\"mr-2 h-4 w-4\" />\n          Add Room\n        </Button>\n      </div>\n\n      {/* Room Statistics by Category */}\n      <Card>\n        <CardHeader className=\"pb-3\">\n          <CardTitle className=\"text-lg\">Room Statistics by Category</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {statsLoading ? (\n            <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4\">\n              {[...Array(7)].map((_, i) => (\n                <Skeleton key={i} className=\"h-24\" />\n              ))}\n            </div>\n          ) : roomStats ? (\n            <>\n              {/* Overall Totals */}\n              <div className=\"flex flex-wrap items-center gap-4 mb-4 pb-4 border-b\">\n                <div className=\"flex items-center gap-2\">\n                  <Building className=\"h-5 w-5 text-primary\" />\n                  <span className=\"text-sm text-muted-foreground\">Total:</span>\n                  <span className=\"font-semibold\" data-testid=\"text-total-rooms\">{roomStats.totals.totalRooms}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                  <span className=\"text-sm text-muted-foreground\">Available:</span>\n                  <span className=\"font-semibold text-green-600\" data-testid=\"text-available-rooms\">{roomStats.totals.availableRooms}</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Users className=\"h-5 w-5 text-orange-500\" />\n                  <span className=\"text-sm text-muted-foreground\">Occupied:</span>\n                  <span className=\"font-semibold text-orange-600\" data-testid=\"text-occupied-rooms\">{roomStats.totals.occupiedRooms}</span>\n                </div>\n              </div>\n\n              {/* Stats by Category */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3\">\n                {roomStats.statsByCategory\n                  .filter((stat) => stat.totalRooms > 0)\n                  .map((stat) => (\n                    <Card key={stat.category} className=\"bg-muted/30\" data-testid={`card-stats-${stat.category}`}>\n                      <CardContent className=\"p-4 text-center\">\n                        <h4 className=\"font-medium text-sm mb-2 truncate\" title={stat.category}>\n                          {stat.category}\n                        </h4>\n                        <div className=\"space-y-1 text-xs\">\n                          <div className=\"flex justify-between gap-1\">\n                            <span className=\"text-muted-foreground\">Total:</span>\n                            <span className=\"font-semibold\">{stat.totalRooms}</span>\n                          </div>\n                          <div className=\"flex justify-between gap-1\">\n                            <span className=\"text-muted-foreground\">Available:</span>\n                            <span className=\"font-semibold text-green-600\">{stat.availableRooms}</span>\n                          </div>\n                          <div className=\"flex justify-between gap-1\">\n                            <span className=\"text-muted-foreground\">Occupied:</span>\n                            <span className=\"font-semibold text-orange-600\">{stat.occupiedRooms}</span>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                {roomStats.statsByCategory.every((stat) => stat.totalRooms === 0) && (\n                  <p className=\"col-span-full text-center text-muted-foreground py-4\">\n                    No rooms added yet.\n                  </p>\n                )}\n              </div>\n            </>\n          ) : null}\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center gap-4\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search rooms...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search-rooms\"\n              />\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[...Array(5)].map((_, i) => (\n                <div key={i} className=\"flex items-center gap-4\">\n                  <Skeleton className=\"h-16 w-24 rounded\" />\n                  <div className=\"space-y-2 flex-1\">\n                    <Skeleton className=\"h-4 w-1/4\" />\n                    <Skeleton className=\"h-3 w-1/3\" />\n                  </div>\n                  <Skeleton className=\"h-8 w-20\" />\n                </div>\n              ))}\n            </div>\n          ) : filteredRooms && filteredRooms.length > 0 ? (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Room</TableHead>\n                  <TableHead>Category</TableHead>\n                  <TableHead>Room #</TableHead>\n                  <TableHead>Capacity</TableHead>\n                  <TableHead>Price/Night</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead className=\"text-right\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredRooms.map((room) => (\n                  <TableRow key={room._id} data-testid={`room-row-${room._id}`}>\n                    <TableCell>\n                      <div className=\"flex items-center gap-3\">\n                        {room.images[0] ? (\n                          <img\n                            src={room.images[0]}\n                            alt={room.name}\n                            className=\"w-16 h-12 object-cover rounded\"\n                          />\n                        ) : (\n                          <div className=\"w-16 h-12 bg-muted rounded flex items-center justify-center\">\n                            <ImageIcon className=\"h-4 w-4 text-muted-foreground\" />\n                          </div>\n                        )}\n                        <span className=\"font-medium\">{room.name}</span>\n                      </div>\n                    </TableCell>\n                    <TableCell>{room.category}</TableCell>\n                    <TableCell>{room.roomNumber}</TableCell>\n                    <TableCell>{room.capacity}</TableCell>\n                    <TableCell>${room.pricePerNight}</TableCell>\n                    <TableCell>\n                      {roomStats?.occupiedRoomIds?.includes(room._id) ? (\n                        <Badge variant=\"destructive\" data-testid={`status-occupied-${room._id}`}>\n                          Occupied\n                        </Badge>\n                      ) : room.isAvailable ? (\n                        <Badge variant=\"default\" data-testid={`status-available-${room._id}`}>\n                          Available\n                        </Badge>\n                      ) : (\n                        <Badge variant=\"secondary\" data-testid={`status-unavailable-${room._id}`}>\n                          Unavailable\n                        </Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex items-center justify-end gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => handleOpenDialog(room)}\n                          data-testid={`button-edit-${room._id}`}\n                        >\n                          <Pencil className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => setDeleteRoomId(room._id)}\n                          className=\"text-destructive hover:text-destructive\"\n                          data-testid={`button-delete-${room._id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          ) : (\n            <p className=\"text-center text-muted-foreground py-8\">\n              No rooms found. Add your first room to get started.\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingRoom ? \"Edit Room\" : \"Add New Room\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingRoom\n                ? \"Update the room details below.\"\n                : \"Fill in the details to create a new room.\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Room Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Deluxe Ocean View\"\n                          {...field}\n                          data-testid=\"input-room-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"roomNumber\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Room Number</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"101\"\n                          {...field}\n                          data-testid=\"input-room-number\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Description</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"Describe the room...\"\n                        className=\"min-h-[100px]\"\n                        {...field}\n                        data-testid=\"input-room-description\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid grid-cols-3 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Category</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-room-category\">\n                            <SelectValue placeholder=\"Select category\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {roomCategories.map((category) => (\n                            <SelectItem key={category} value={category}>\n                              {category}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"pricePerNight\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Price/Night ($)</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min={1}\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                          data-testid=\"input-room-price\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"capacity\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Capacity</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          min={1}\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                          data-testid=\"input-room-capacity\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormLabel>Amenities</FormLabel>\n                <div className=\"grid grid-cols-3 gap-3 mt-2 max-h-48 overflow-y-auto p-2 border rounded-md\">\n                  {predefinedAmenities.map((amenity) => (\n                    <div key={amenity} className=\"flex items-center space-x-2\">\n                      <Checkbox\n                        id={`amenity-${amenity}`}\n                        checked={\n                          amenity === \"Other\"\n                            ? showCustomAmenity\n                            : selectedAmenities.includes(amenity)\n                        }\n                        onCheckedChange={(checked) =>\n                          handleAmenityToggle(amenity, checked as boolean)\n                        }\n                        data-testid={`checkbox-${amenity}`}\n                      />\n                      <label\n                        htmlFor={`amenity-${amenity}`}\n                        className=\"text-sm cursor-pointer\"\n                      >\n                        {amenity}\n                      </label>\n                    </div>\n                  ))}\n                </div>\n                {showCustomAmenity && (\n                  <FormField\n                    control={form.control}\n                    name=\"customAmenity\"\n                    render={({ field }) => (\n                      <FormItem className=\"mt-2\">\n                        <FormControl>\n                          <Input\n                            placeholder=\"Enter custom amenity...\"\n                            {...field}\n                            data-testid=\"input-custom-amenity\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n              </div>\n\n              <div>\n                <FormLabel>Images</FormLabel>\n                <div\n                  {...getRootProps()}\n                  className={`mt-2 border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-colors ${\n                    isDragActive\n                      ? \"border-primary bg-primary/5\"\n                      : \"border-muted-foreground/25 hover:border-primary\"\n                  }`}\n                >\n                  <input {...getInputProps()} data-testid=\"input-images\" />\n                  {isUploading ? (\n                    <div className=\"flex items-center justify-center gap-2\">\n                      <Loader2 className=\"h-5 w-5 animate-spin\" />\n                      <span>Uploading...</span>\n                    </div>\n                  ) : (\n                    <>\n                      <Upload className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\n                      <p className=\"text-sm text-muted-foreground\">\n                        Drag & drop images here, or click to select\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Max 5 images (JPEG, PNG, WebP)\n                      </p>\n                    </>\n                  )}\n                </div>\n                {uploadedImages.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2 mt-4\">\n                    {uploadedImages.map((url, index) => (\n                      <div key={index} className=\"relative group\">\n                        <img\n                          src={url}\n                          alt={`Room image ${index + 1}`}\n                          className=\"w-20 h-20 object-cover rounded-lg\"\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => handleRemoveImage(index)}\n                          className=\"absolute -top-2 -right-2 p-1 bg-destructive text-destructive-foreground rounded-full opacity-0 group-hover:opacity-100 transition-opacity\"\n                          data-testid={`button-remove-image-${index}`}\n                        >\n                          <X className=\"h-3 w-3\" />\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"isAvailable\"\n                render={({ field }) => (\n                  <FormItem className=\"flex items-center space-x-2\">\n                    <FormControl>\n                      <Checkbox\n                        checked={field.value}\n                        onCheckedChange={field.onChange}\n                        data-testid=\"checkbox-available\"\n                      />\n                    </FormControl>\n                    <FormLabel className=\"!mt-0\">Room is available for booking</FormLabel>\n                  </FormItem>\n                )}\n              />\n\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={handleCloseDialog}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={createMutation.isPending || updateMutation.isPending}\n                  data-testid=\"button-save-room\"\n                >\n                  {(createMutation.isPending || updateMutation.isPending) && (\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  )}\n                  {editingRoom ? \"Update Room\" : \"Create Room\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      <AlertDialog open={!!deleteRoomId} onOpenChange={() => setDeleteRoomId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Room</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this room? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deleteRoomId && deleteMutation.mutate(deleteRoomId)}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              Delete\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":29758,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport path from \"path\";\nimport express from \"express\";\nimport { connectToDatabase } from \"./db/connection\";\nimport authRoutes from \"./routes/auth\";\nimport roomsRoutes from \"./routes/rooms\";\nimport bookingsRoutes from \"./routes/bookings\";\nimport reviewsRoutes from \"./routes/reviews\";\nimport adminRoutes from \"./routes/admin\";\nimport managerRoutes from \"./routes/manager\";\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  await connectToDatabase();\n\n  app.use(\"/uploads\", express.static(path.join(process.cwd(), \"uploads\")));\n\n  app.use(\"/api/auth\", authRoutes);\n  app.use(\"/api/rooms\", roomsRoutes);\n  app.use(\"/api/bookings\", bookingsRoutes);\n  app.use(\"/api/reviews\", reviewsRoutes);\n  app.use(\"/api/admin\", adminRoutes);\n  app.use(\"/api/manager\", managerRoutes);\n\n  app.get(\"/api/health\", (req, res) => {\n    res.json({ status: \"ok\", timestamp: new Date().toISOString() });\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":1048,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"server/db/models/Review.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IReview extends Document {\n  _id: mongoose.Types.ObjectId;\n  userId: mongoose.Types.ObjectId;\n  roomId: mongoose.Types.ObjectId;\n  bookingId: mongoose.Types.ObjectId;\n  rating: number;\n  comment: string;\n  createdAt: Date;\n}\n\nconst reviewSchema = new Schema<IReview>({\n  userId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: true,\n  },\n  roomId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Room',\n    required: true,\n  },\n  bookingId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Booking',\n    required: true,\n    unique: true,\n  },\n  rating: {\n    type: Number,\n    required: true,\n    min: 1,\n    max: 5,\n  },\n  comment: {\n    type: String,\n    required: true,\n    minlength: 10,\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\nreviewSchema.index({ roomId: 1 });\nreviewSchema.index({ userId: 1 });\n\nreviewSchema.set('toJSON', {\n  transform: function (doc, ret) {\n    ret._id = ret._id.toString();\n    if (ret.userId) ret.userId = ret.userId.toString();\n    if (ret.roomId) ret.roomId = ret.roomId.toString();\n    if (ret.bookingId) ret.bookingId = ret.bookingId.toString();\n    delete ret.__v;\n    return ret;\n  },\n});\n\nexport const Review = mongoose.model<IReview>('Review', reviewSchema);\n","path":null,"size_bytes":1308,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"@neondatabase/serverless\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1439,"size_tokens":null},"shared/schema.ts":{"content":"import { z } from \"zod\";\n\n// ============ USER SCHEMA ============\nexport const userRoles = [\"customer\", \"manager\", \"admin\"] as const;\nexport type UserRole = (typeof userRoles)[number];\n\nexport const userSchema = z.object({\n  _id: z.string(),\n  email: z.string().email(),\n  password: z.string().min(6),\n  firstName: z.string().min(1),\n  lastName: z.string().min(1),\n  phone: z.string().optional(),\n  role: z.enum(userRoles).default(\"customer\"),\n  createdAt: z.date(),\n});\n\nexport const insertUserSchema = userSchema.omit({ _id: true, createdAt: true });\nexport const loginUserSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(1),\n});\nexport const registerUserSchema = insertUserSchema.extend({\n  confirmPassword: z.string(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Passwords don't match\",\n  path: [\"confirmPassword\"],\n});\n\nexport type User = z.infer<typeof userSchema>;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type LoginUser = z.infer<typeof loginUserSchema>;\nexport type RegisterUser = z.infer<typeof registerUserSchema>;\n\n// ============ ROOM SCHEMA ============\nexport const roomCategories = [\n  \"Standard\",\n  \"Deluxe\",\n  \"Suite\",\n  \"Executive\",\n  \"Presidential\",\n  \"Family\",\n  \"Penthouse\",\n] as const;\nexport type RoomCategory = (typeof roomCategories)[number];\n\nexport const predefinedAmenities = [\n  \"WiFi\",\n  \"Air Conditioning\",\n  \"TV\",\n  \"Mini Bar\",\n  \"Room Service\",\n  \"Ocean View\",\n  \"Balcony\",\n  \"King Bed\",\n  \"Queen Bed\",\n  \"Twin Beds\",\n  \"Jacuzzi\",\n  \"Safe\",\n  \"Coffee Maker\",\n  \"Refrigerator\",\n  \"Work Desk\",\n  \"Hair Dryer\",\n  \"Iron\",\n  \"Bathtub\",\n  \"Shower\",\n  \"Slippers\",\n  \"Bathrobes\",\n  \"Complimentary Breakfast\",\n  \"Other\",\n] as const;\n\nexport const roomSchema = z.object({\n  _id: z.string(),\n  name: z.string().min(1),\n  description: z.string().min(10),\n  category: z.enum(roomCategories),\n  pricePerNight: z.number().positive(),\n  capacity: z.number().int().positive(),\n  images: z.array(z.string()),\n  amenities: z.array(z.string()),\n  isAvailable: z.boolean().default(true),\n  roomNumber: z.string(),\n  createdAt: z.date(),\n});\n\nexport const insertRoomSchema = roomSchema.omit({ _id: true, createdAt: true });\n\nexport type Room = z.infer<typeof roomSchema>;\nexport type InsertRoom = z.infer<typeof insertRoomSchema>;\n\n// ============ BOOKING SCHEMA ============\nexport const bookingStatuses = [\n  \"pending\",\n  \"confirmed\",\n  \"checked_in\",\n  \"checked_out\",\n  \"cancelled\",\n] as const;\nexport type BookingStatus = (typeof bookingStatuses)[number];\n\nexport const bookingSchema = z.object({\n  _id: z.string(),\n  userId: z.string(),\n  roomId: z.string(),\n  checkInDate: z.date(),\n  checkOutDate: z.date(),\n  totalPrice: z.number().positive(),\n  discountAmount: z.number().min(0).default(0),\n  finalPrice: z.number().positive(),\n  promoCode: z.string().optional(),\n  status: z.enum(bookingStatuses).default(\"pending\"),\n  guestCount: z.number().int().positive(),\n  specialRequests: z.string().optional(),\n  paymentIntentId: z.string().optional(),\n  paymentStatus: z.enum([\"pending\", \"paid\", \"refunded\"]).default(\"pending\"),\n  createdAt: z.date(),\n});\n\nexport const insertBookingSchema = bookingSchema.omit({ _id: true, createdAt: true, paymentIntentId: true, paymentStatus: true, status: true });\n\nexport type Booking = z.infer<typeof bookingSchema>;\nexport type InsertBooking = z.infer<typeof insertBookingSchema>;\n\n// ============ REVIEW SCHEMA ============\nexport const reviewSchema = z.object({\n  _id: z.string(),\n  userId: z.string(),\n  roomId: z.string(),\n  bookingId: z.string(),\n  rating: z.number().int().min(1).max(5),\n  comment: z.string().min(10),\n  createdAt: z.date(),\n});\n\nexport const insertReviewSchema = reviewSchema.omit({ _id: true, createdAt: true });\n\nexport type Review = z.infer<typeof reviewSchema>;\nexport type InsertReview = z.infer<typeof insertReviewSchema>;\n\n// ============ PROMO CODE SCHEMA ============\nexport const discountTypes = [\"percentage\", \"fixed\"] as const;\nexport type DiscountType = (typeof discountTypes)[number];\n\nexport const promoCodeSchema = z.object({\n  _id: z.string(),\n  code: z.string().min(3).max(20),\n  description: z.string().optional(),\n  discountType: z.enum(discountTypes),\n  discountValue: z.number().positive(),\n  minBookingAmount: z.number().min(0).default(0),\n  maxDiscountAmount: z.number().positive().optional(),\n  validFrom: z.date(),\n  validTo: z.date(),\n  usageLimit: z.number().int().positive().optional(),\n  usageCount: z.number().int().min(0).default(0),\n  isActive: z.boolean().default(true),\n  createdAt: z.date(),\n});\n\nexport const insertPromoCodeSchema = promoCodeSchema.omit({ _id: true, createdAt: true, usageCount: true });\n\nexport type PromoCode = z.infer<typeof promoCodeSchema>;\nexport type InsertPromoCode = z.infer<typeof insertPromoCodeSchema>;\n\n// ============ API RESPONSE TYPES ============\nexport interface AuthResponse {\n  user: Omit<User, \"password\">;\n  token: string;\n}\n\nexport interface RoomWithReviews extends Room {\n  reviews: (Review & { user: Pick<User, \"_id\" | \"firstName\" | \"lastName\"> })[];\n  averageRating: number;\n}\n\nexport interface BookingWithDetails extends Booking {\n  room: Room;\n  user: Pick<User, \"_id\" | \"firstName\" | \"lastName\" | \"email\">;\n}\n\n// ============ FILTER TYPES ============\nexport interface RoomFilters {\n  category?: RoomCategory;\n  minPrice?: number;\n  maxPrice?: number;\n  amenities?: string[];\n  checkIn?: string;\n  checkOut?: string;\n  guests?: number;\n}\n","path":null,"size_bytes":5481,"size_tokens":null},"server/db/connection.ts":{"content":"import mongoose from 'mongoose';\n\nlet isConnected = false;\n\nexport async function connectToDatabase() {\n  const MONGODB_URI = process.env.MONGODB_URI;\n  \n  if (!MONGODB_URI) {\n    console.warn('MONGODB_URI not set - MongoDB features will not be available');\n    console.warn('Please set the MONGODB_URI environment variable to connect to MongoDB');\n    return null;\n  }\n\n  try {\n    if (mongoose.connection.readyState === 1) {\n      console.log('Already connected to MongoDB');\n      isConnected = true;\n      return mongoose.connection;\n    }\n\n    console.log('Connecting to MongoDB...');\n    await mongoose.connect(MONGODB_URI);\n    console.log('Connected to MongoDB successfully');\n    isConnected = true;\n    return mongoose.connection;\n  } catch (error) {\n    console.error('MongoDB connection error:', error);\n    isConnected = false;\n    return null;\n  }\n}\n\nexport function isMongoConnected() {\n  return isConnected && mongoose.connection.readyState === 1;\n}\n\nexport { mongoose };\n","path":null,"size_bytes":988,"size_tokens":null},"client/src/pages/admin/AdminLayout.tsx":{"content":"import { ReactNode } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Hotel, LayoutDashboard, BedDouble, Calendar, LogOut, Tag } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarProvider,\n  SidebarTrigger,\n} from \"@/components/ui/sidebar\";\nimport { ThemeToggle } from \"@/components/layout/ThemeToggle\";\nimport { useAuth } from \"@/lib/auth\";\n\ninterface AdminLayoutProps {\n  children: ReactNode;\n}\n\nconst adminNavItems = [\n  { href: \"/admin\", icon: LayoutDashboard, label: \"Dashboard\" },\n  { href: \"/admin/rooms\", icon: BedDouble, label: \"Rooms\" },\n  { href: \"/admin/bookings\", icon: Calendar, label: \"Bookings\" },\n  { href: \"/admin/promo-codes\", icon: Tag, label: \"Promo Codes\" },\n];\n\nexport function AdminLayout({ children }: AdminLayoutProps) {\n  const [location, setLocation] = useLocation();\n  const { logout, user } = useAuth();\n\n  const handleLogout = () => {\n    logout();\n    setLocation(\"/\");\n  };\n\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <Sidebar>\n          <SidebarHeader className=\"border-b p-4\">\n            <Link href=\"/\" className=\"flex items-center gap-2\">\n              <Hotel className=\"h-6 w-6 text-primary\" />\n              <span className=\"font-serif font-semibold\">Grand Horizon</span>\n            </Link>\n          </SidebarHeader>\n          <SidebarContent>\n            <SidebarGroup>\n              <SidebarGroupLabel>Admin Panel</SidebarGroupLabel>\n              <SidebarGroupContent>\n                <SidebarMenu>\n                  {adminNavItems.map((item) => (\n                    <SidebarMenuItem key={item.href}>\n                      <SidebarMenuButton\n                        asChild\n                        isActive={location === item.href}\n                      >\n                        <Link href={item.href} data-testid={`nav-${item.label.toLowerCase()}`}>\n                          <item.icon className=\"h-4 w-4\" />\n                          <span>{item.label}</span>\n                        </Link>\n                      </SidebarMenuButton>\n                    </SidebarMenuItem>\n                  ))}\n                </SidebarMenu>\n              </SidebarGroupContent>\n            </SidebarGroup>\n          </SidebarContent>\n          <div className=\"mt-auto p-4 border-t\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-primary-foreground text-sm font-medium\">\n                {user?.firstName?.[0]}{user?.lastName?.[0]}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium truncate\">\n                  {user?.firstName} {user?.lastName}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">Admin</p>\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"w-full gap-2\"\n              onClick={handleLogout}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"h-4 w-4\" />\n              Log out\n            </Button>\n          </div>\n        </Sidebar>\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between gap-4 p-4 border-b bg-background\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-2\">\n              <ThemeToggle />\n              <Button variant=\"outline\" size=\"sm\" asChild>\n                <Link href=\"/\" data-testid=\"link-view-site\">View Site</Link>\n              </Button>\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","path":null,"size_bytes":4174,"size_tokens":null},"server/routes/bookings.ts":{"content":"import { Router, Response } from 'express';\nimport { Booking, Room, User, PromoCode } from '../db/models';\nimport { authenticate, AuthRequest } from '../middleware/auth';\nimport { sendBookingConfirmation } from '../services/email';\nimport { z } from 'zod';\n\n// Helper function to validate and calculate promo code discount\nasync function validatePromoCode(code: string, bookingAmount: number) {\n  const promoCode = await PromoCode.findOne({ \n    code: code.toUpperCase(),\n    isActive: true,\n  });\n\n  if (!promoCode) {\n    return { valid: false, error: 'Invalid promo code' };\n  }\n\n  const now = new Date();\n  if (now < promoCode.validFrom || now > promoCode.validTo) {\n    return { valid: false, error: 'Promo code has expired or is not yet active' };\n  }\n\n  if (promoCode.usageLimit && promoCode.usageCount >= promoCode.usageLimit) {\n    return { valid: false, error: 'Promo code has reached its usage limit' };\n  }\n\n  if (bookingAmount < promoCode.minBookingAmount) {\n    return { \n      valid: false, \n      error: `Minimum booking amount of $${promoCode.minBookingAmount} required` \n    };\n  }\n\n  let discountAmount = 0;\n  if (promoCode.discountType === 'percentage') {\n    discountAmount = (bookingAmount * promoCode.discountValue) / 100;\n  } else {\n    discountAmount = promoCode.discountValue;\n  }\n\n  if (promoCode.maxDiscountAmount && discountAmount > promoCode.maxDiscountAmount) {\n    discountAmount = promoCode.maxDiscountAmount;\n  }\n\n  discountAmount = Math.min(discountAmount, bookingAmount);\n\n  return {\n    valid: true,\n    promoCode,\n    discountAmount: Math.round(discountAmount * 100) / 100,\n    finalPrice: Math.round((bookingAmount - discountAmount) * 100) / 100,\n    description: promoCode.description,\n    discountType: promoCode.discountType,\n    discountValue: promoCode.discountValue,\n  };\n}\n\nconst router = Router();\n\nconst createBookingSchema = z.object({\n  roomId: z.string(),\n  checkInDate: z.string().transform((s) => new Date(s)),\n  checkOutDate: z.string().transform((s) => new Date(s)),\n  totalPrice: z.number().positive(),\n  guestCount: z.number().int().positive(),\n  specialRequests: z.string().optional(),\n  promoCode: z.string().optional(),\n});\n\nrouter.use(authenticate);\n\n// Validate promo code endpoint\nrouter.post('/validate-promo', async (req: AuthRequest, res: Response) => {\n  try {\n    const { code, bookingAmount } = req.body;\n    \n    if (!code || typeof code !== 'string') {\n      return res.status(400).json({ valid: false, error: 'Promo code is required' });\n    }\n    \n    if (!bookingAmount || typeof bookingAmount !== 'number' || bookingAmount <= 0) {\n      return res.status(400).json({ valid: false, error: 'Valid booking amount is required' });\n    }\n\n    const result = await validatePromoCode(code, bookingAmount);\n    \n    if (!result.valid) {\n      return res.json({ valid: false, error: result.error });\n    }\n\n    res.json({\n      valid: true,\n      code: result.promoCode!.code,\n      discountAmount: result.discountAmount,\n      finalPrice: result.finalPrice,\n      description: result.description,\n      discountType: result.discountType,\n      discountValue: result.discountValue,\n    });\n  } catch (error) {\n    console.error('Error validating promo code:', error);\n    res.status(500).json({ valid: false, error: 'Failed to validate promo code' });\n  }\n});\n\nrouter.get('/my', async (req: AuthRequest, res: Response) => {\n  try {\n    const bookings = await Booking.find({ userId: req.user!._id })\n      .populate('roomId')\n      .sort({ createdAt: -1 });\n\n    const bookingsWithDetails = bookings.map((booking) => {\n      const bookingObj = booking.toJSON();\n      const room = booking.roomId as any;\n      return {\n        ...bookingObj,\n        roomId: room?._id?.toString() || bookingObj.roomId,\n        room: room,\n        user: {\n          _id: req.user!._id.toString(),\n          firstName: req.user!.firstName,\n          lastName: req.user!.lastName,\n          email: req.user!.email,\n        },\n      };\n    });\n\n    res.json(bookingsWithDetails);\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    res.status(500).json({ message: 'Failed to fetch bookings' });\n  }\n});\n\nrouter.get('/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const booking = await Booking.findOne({\n      _id: req.params.id,\n      userId: req.user!._id,\n    }).populate('roomId');\n\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    const bookingObj = booking.toJSON();\n    const room = booking.roomId as any;\n    const bookingWithDetails = {\n      ...bookingObj,\n      roomId: room?._id?.toString() || bookingObj.roomId,\n      room: room,\n      user: {\n        _id: req.user!._id.toString(),\n        firstName: req.user!.firstName,\n        lastName: req.user!.lastName,\n        email: req.user!.email,\n      },\n    };\n\n    res.json(bookingWithDetails);\n  } catch (error) {\n    console.error('Error fetching booking:', error);\n    res.status(500).json({ message: 'Failed to fetch booking' });\n  }\n});\n\nrouter.post('/', async (req: AuthRequest, res: Response) => {\n  try {\n    const data = createBookingSchema.parse(req.body);\n\n    const room = await Room.findById(data.roomId);\n    if (!room) {\n      return res.status(404).json({ message: 'Room not found' });\n    }\n\n    if (!room.isAvailable) {\n      return res.status(400).json({ message: 'Room is not available' });\n    }\n\n    const conflictingBookings = await Booking.find({\n      roomId: data.roomId,\n      status: { $nin: ['cancelled'] },\n      $or: [\n        {\n          checkInDate: { $lt: data.checkOutDate },\n          checkOutDate: { $gt: data.checkInDate },\n        },\n      ],\n    });\n\n    if (conflictingBookings.length > 0) {\n      return res.status(400).json({ message: 'Room is not available for selected dates' });\n    }\n\n    let discountAmount = 0;\n    let finalPrice = data.totalPrice;\n    let appliedPromoCode: string | undefined = undefined;\n\n    // Validate and apply promo code if provided\n    if (data.promoCode) {\n      const promoResult = await validatePromoCode(data.promoCode, data.totalPrice);\n      if (!promoResult.valid) {\n        return res.status(400).json({ message: promoResult.error });\n      }\n      discountAmount = promoResult.discountAmount!;\n      finalPrice = promoResult.finalPrice!;\n      appliedPromoCode = promoResult.promoCode!.code;\n\n      // Increment promo code usage count\n      await PromoCode.findByIdAndUpdate(promoResult.promoCode!._id, {\n        $inc: { usageCount: 1 }\n      });\n    }\n\n    const booking = new Booking({\n      userId: req.user!._id,\n      roomId: data.roomId,\n      checkInDate: data.checkInDate,\n      checkOutDate: data.checkOutDate,\n      totalPrice: data.totalPrice,\n      discountAmount,\n      finalPrice,\n      promoCode: appliedPromoCode,\n      guestCount: data.guestCount,\n      specialRequests: data.specialRequests,\n      status: 'pending',\n      paymentStatus: 'pending',\n    });\n\n    await booking.save();\n\n    res.status(201).json({\n      booking: booking.toJSON(),\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Error creating booking:', error);\n    res.status(500).json({ message: 'Failed to create booking' });\n  }\n});\n\nrouter.post('/:id/confirm-payment', async (req: AuthRequest, res: Response) => {\n  try {\n    const booking = await Booking.findOne({\n      _id: req.params.id,\n      userId: req.user!._id,\n    });\n\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    booking.status = 'confirmed';\n    booking.paymentStatus = 'paid';\n    booking.paymentIntentId = `pi_simulated_${Date.now()}`;\n    await booking.save();\n\n    const room = await Room.findById(booking.roomId);\n    if (room) {\n      await sendBookingConfirmation(req.user!, booking, room);\n    }\n\n    res.json({ success: true, booking: booking.toJSON() });\n  } catch (error) {\n    console.error('Error confirming payment:', error);\n    res.status(500).json({ message: 'Failed to confirm payment' });\n  }\n});\n\nrouter.patch('/:id/cancel', async (req: AuthRequest, res: Response) => {\n  try {\n    const booking = await Booking.findOne({\n      _id: req.params.id,\n      userId: req.user!._id,\n    });\n\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    if (booking.status === 'cancelled') {\n      return res.status(400).json({ message: 'Booking is already cancelled' });\n    }\n\n    if (booking.status === 'checked_out') {\n      return res.status(400).json({ message: 'Cannot cancel a completed booking' });\n    }\n\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    if (new Date(booking.checkInDate) <= today) {\n      return res.status(400).json({ message: 'Cannot cancel booking on or after check-in date' });\n    }\n\n    booking.status = 'cancelled';\n    await booking.save();\n\n    res.json({ success: true, booking: booking.toJSON() });\n  } catch (error) {\n    console.error('Error cancelling booking:', error);\n    res.status(500).json({ message: 'Failed to cancel booking' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":9189,"size_tokens":null},"client/src/pages/Booking.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useLocation, useSearch, Link } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { format, differenceInDays } from \"date-fns\";\nimport {\n  ArrowLeft,\n  Calendar,\n  Users,\n  CreditCard,\n  Check,\n  Loader2,\n  AlertCircle,\n  Bed,\n  Tag,\n  X,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth\";\nimport { api } from \"@/lib/api\";\nimport type { Room, InsertBooking } from \"@shared/schema\";\n\ninterface BookingResponse {\n  booking: {\n    _id: string;\n    status: string;\n    totalPrice: number;\n    discountAmount: number;\n    finalPrice: number;\n    promoCode?: string;\n  };\n  clientSecret?: string;\n  paymentIntentId?: string;\n}\n\ninterface PromoValidationResult {\n  valid: boolean;\n  error?: string;\n  code?: string;\n  discountAmount?: number;\n  finalPrice?: number;\n  description?: string;\n  discountType?: 'percentage' | 'fixed';\n  discountValue?: number;\n}\n\ntype BookingStep = \"review\" | \"payment\" | \"confirmation\";\n\nexport default function Booking() {\n  const search = useSearch();\n  const [, setLocation] = useLocation();\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  \n  const params = new URLSearchParams(search);\n  const roomId = params.get(\"roomId\");\n  const checkInParam = params.get(\"checkIn\");\n  const checkOutParam = params.get(\"checkOut\");\n  const guestsParam = params.get(\"guests\");\n\n  const checkIn = checkInParam ? new Date(checkInParam) : null;\n  const checkOut = checkOutParam ? new Date(checkOutParam) : null;\n  const guests = guestsParam ? parseInt(guestsParam) : 1;\n\n  const [step, setStep] = useState<BookingStep>(\"review\");\n  const [specialRequests, setSpecialRequests] = useState(\"\");\n  const [bookingId, setBookingId] = useState<string | null>(null);\n  const [promoCodeInput, setPromoCodeInput] = useState(\"\");\n  const [appliedPromo, setAppliedPromo] = useState<PromoValidationResult | null>(null);\n  const [isValidatingPromo, setIsValidatingPromo] = useState(false);\n\n  const { data: room, isLoading: isLoadingRoom } = useQuery<Room>({\n    queryKey: [`/api/rooms/${roomId}`],\n    enabled: !!roomId,\n  });\n\n  const createBookingMutation = useMutation({\n    mutationFn: async (data: InsertBooking) => {\n      return api.post<BookingResponse>(\"/bookings\", data);\n    },\n    onSuccess: (data) => {\n      setBookingId(data.booking._id);\n      setStep(\"payment\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Booking Failed\",\n        description: error.message || \"Unable to create booking. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const confirmPaymentMutation = useMutation({\n    mutationFn: async () => {\n      return api.post<{ success: boolean }>(`/bookings/${bookingId}/confirm-payment`);\n    },\n    onSuccess: () => {\n      setStep(\"confirmation\");\n      toast({\n        title: \"Booking Confirmed!\",\n        description: \"Your booking has been successfully confirmed. Check your email for details.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Payment Failed\",\n        description: error.message || \"Payment processing failed. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  useEffect(() => {\n    if (!isAuthenticated) {\n      setLocation(\"/login?redirect=\" + encodeURIComponent(window.location.pathname + window.location.search));\n    }\n  }, [isAuthenticated, setLocation]);\n\n  if (!roomId || !checkIn || !checkOut) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <AlertCircle className=\"h-12 w-12 mx-auto text-destructive mb-4\" />\n          <h2 className=\"text-2xl font-semibold mb-2\">Invalid Booking</h2>\n          <p className=\"text-muted-foreground mb-4\">\n            Missing booking information. Please select a room and dates.\n          </p>\n          <Button asChild>\n            <Link href=\"/rooms\">Browse Rooms</Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  if (isLoadingRoom) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <Skeleton className=\"h-8 w-32 mb-6\" />\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n            <div className=\"lg:col-span-2\">\n              <Skeleton className=\"h-64 rounded-xl\" />\n            </div>\n            <div>\n              <Skeleton className=\"h-96 rounded-xl\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!room) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-semibold mb-2\">Room not found</h2>\n          <Button asChild>\n            <Link href=\"/rooms\">Browse Rooms</Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  const nights = differenceInDays(checkOut, checkIn);\n  const totalPrice = nights * room.pricePerNight;\n  const discountAmount = appliedPromo?.discountAmount || 0;\n  const finalPrice = appliedPromo?.finalPrice || totalPrice;\n\n  const handleValidatePromo = async () => {\n    if (!promoCodeInput.trim()) {\n      toast({\n        title: \"Error\",\n        description: \"Please enter a promo code\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsValidatingPromo(true);\n    try {\n      const result = await api.post<PromoValidationResult>(\"/bookings/validate-promo\", {\n        code: promoCodeInput.trim(),\n        bookingAmount: totalPrice,\n      });\n\n      if (result.valid) {\n        setAppliedPromo(result);\n        setPromoCodeInput(\"\");\n        toast({\n          title: \"Promo Applied!\",\n          description: `You saved $${result.discountAmount?.toFixed(2)}`,\n        });\n      } else {\n        toast({\n          title: \"Invalid Code\",\n          description: result.error || \"Unable to apply promo code\",\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to validate promo code\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsValidatingPromo(false);\n    }\n  };\n\n  const handleRemovePromo = () => {\n    setAppliedPromo(null);\n    toast({\n      title: \"Promo Removed\",\n      description: \"Promo code has been removed\",\n    });\n  };\n\n  const handleCreateBooking = () => {\n    if (!user) return;\n    \n    createBookingMutation.mutate({\n      userId: user._id,\n      roomId: room._id,\n      checkInDate: checkIn,\n      checkOutDate: checkOut,\n      totalPrice,\n      finalPrice,\n      discountAmount,\n      guestCount: guests,\n      specialRequests: specialRequests || undefined,\n      promoCode: appliedPromo?.code,\n    } as any);\n  };\n\n  const handleConfirmPayment = () => {\n    confirmPaymentMutation.mutate();\n  };\n\n  const stepIndicators = [\n    { key: \"review\", label: \"Review\" },\n    { key: \"payment\", label: \"Payment\" },\n    { key: \"confirmation\", label: \"Confirmed\" },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <Button variant=\"ghost\" asChild className=\"mb-6 gap-2\">\n          <Link href={`/rooms/${roomId}`} data-testid=\"link-back-to-room\">\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Room\n          </Link>\n        </Button>\n\n        <div className=\"flex items-center justify-center mb-8\">\n          {stepIndicators.map((s, index) => (\n            <div key={s.key} className=\"flex items-center\">\n              <div\n                className={`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${\n                  step === s.key || stepIndicators.findIndex((x) => x.key === step) > index\n                    ? \"bg-primary text-primary-foreground\"\n                    : \"bg-muted text-muted-foreground\"\n                }`}\n              >\n                {stepIndicators.findIndex((x) => x.key === step) > index ? (\n                  <Check className=\"h-4 w-4\" />\n                ) : (\n                  index + 1\n                )}\n              </div>\n              <span\n                className={`ml-2 text-sm font-medium ${\n                  step === s.key ? \"text-foreground\" : \"text-muted-foreground\"\n                }`}\n              >\n                {s.label}\n              </span>\n              {index < stepIndicators.length - 1 && (\n                <div className=\"w-12 h-px bg-border mx-4\" />\n              )}\n            </div>\n          ))}\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2\">\n            {step === \"review\" && (\n              <Card>\n                <CardHeader>\n                  <CardTitle>Review Your Booking</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"flex gap-4\">\n                    {room.images && room.images.length > 0 ? (\n                      <img\n                        src={room.images[0]}\n                        alt={room.name}\n                        className=\"w-32 h-24 object-cover rounded-lg\"\n                      />\n                    ) : (\n                      <div className=\"w-32 h-24 bg-muted rounded-lg flex items-center justify-center\">\n                        <Bed className=\"h-8 w-8 text-muted-foreground\" />\n                      </div>\n                    )}\n                    <div>\n                      <h3 className=\"font-semibold text-lg\">{room.name}</h3>\n                      <p className=\"text-sm text-muted-foreground\">{room.category}</p>\n                      <p className=\"text-sm text-muted-foreground\">Room {room.roomNumber}</p>\n                    </div>\n                  </div>\n\n                  <Separator />\n\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"flex items-center gap-3\">\n                      <Calendar className=\"h-5 w-5 text-muted-foreground\" />\n                      <div>\n                        <p className=\"text-sm text-muted-foreground\">Check-in</p>\n                        <p className=\"font-medium\">{format(checkIn, \"EEE, MMM d, yyyy\")}</p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      <Calendar className=\"h-5 w-5 text-muted-foreground\" />\n                      <div>\n                        <p className=\"text-sm text-muted-foreground\">Check-out</p>\n                        <p className=\"font-medium\">{format(checkOut, \"EEE, MMM d, yyyy\")}</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-center gap-3\">\n                    <Users className=\"h-5 w-5 text-muted-foreground\" />\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Guests</p>\n                      <p className=\"font-medium\">{guests} guest{guests > 1 ? \"s\" : \"\"}</p>\n                    </div>\n                  </div>\n\n                  <Separator />\n\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block\">\n                      Special Requests (optional)\n                    </label>\n                    <Textarea\n                      placeholder=\"Any special requests for your stay?\"\n                      value={specialRequests}\n                      onChange={(e) => setSpecialRequests(e.target.value)}\n                      className=\"min-h-[100px]\"\n                      data-testid=\"input-special-requests\"\n                    />\n                  </div>\n\n                  <Separator />\n\n                  <div>\n                    <label className=\"text-sm font-medium mb-2 block flex items-center gap-2\">\n                      <Tag className=\"h-4 w-4\" />\n                      Promo Code (optional)\n                    </label>\n                    {appliedPromo ? (\n                      <div className=\"flex items-center justify-between p-3 bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg\">\n                        <div className=\"flex items-center gap-2\">\n                          <Check className=\"h-4 w-4 text-green-600\" />\n                          <div>\n                            <span className=\"font-mono font-semibold text-green-700 dark:text-green-400\" data-testid=\"text-applied-promo\">\n                              {appliedPromo.code}\n                            </span>\n                            <span className=\"text-sm text-green-600 dark:text-green-400 ml-2\">\n                              ({appliedPromo.discountType === 'percentage' \n                                ? `${appliedPromo.discountValue}% off` \n                                : `$${appliedPromo.discountValue} off`})\n                            </span>\n                          </div>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={handleRemovePromo}\n                          className=\"text-green-600 hover:text-green-700 hover:bg-green-100 dark:hover:bg-green-900\"\n                          data-testid=\"button-remove-promo\"\n                        >\n                          <X className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    ) : (\n                      <div className=\"flex gap-2\">\n                        <Input\n                          placeholder=\"Enter promo code\"\n                          value={promoCodeInput}\n                          onChange={(e) => setPromoCodeInput(e.target.value.toUpperCase())}\n                          className=\"uppercase\"\n                          data-testid=\"input-promo-code\"\n                          onKeyDown={(e) => {\n                            if (e.key === 'Enter') {\n                              e.preventDefault();\n                              handleValidatePromo();\n                            }\n                          }}\n                        />\n                        <Button\n                          variant=\"outline\"\n                          onClick={handleValidatePromo}\n                          disabled={isValidatingPromo || !promoCodeInput.trim()}\n                          data-testid=\"button-apply-promo\"\n                        >\n                          {isValidatingPromo ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            \"Apply\"\n                          )}\n                        </Button>\n                      </div>\n                    )}\n                  </div>\n\n                  <Button\n                    className=\"w-full\"\n                    size=\"lg\"\n                    onClick={handleCreateBooking}\n                    disabled={createBookingMutation.isPending}\n                    data-testid=\"button-proceed-to-payment\"\n                  >\n                    {createBookingMutation.isPending && (\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    )}\n                    Proceed to Payment\n                  </Button>\n                </CardContent>\n              </Card>\n            )}\n\n            {step === \"payment\" && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CreditCard className=\"h-5 w-5\" />\n                    Payment\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <Alert>\n                    <AlertCircle className=\"h-4 w-4\" />\n                    <AlertDescription>\n                      This is a test environment. No real payment will be processed.\n                      Click \"Confirm Payment\" to simulate a successful payment.\n                    </AlertDescription>\n                  </Alert>\n\n                  <div className=\"p-6 border rounded-lg bg-muted/50\">\n                    <p className=\"text-center text-muted-foreground mb-4\">\n                      Stripe Payment Form would appear here in production\n                    </p>\n                    <div className=\"space-y-4\">\n                      <div className=\"h-10 bg-muted rounded-md\" />\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div className=\"h-10 bg-muted rounded-md\" />\n                        <div className=\"h-10 bg-muted rounded-md\" />\n                      </div>\n                    </div>\n                  </div>\n\n                  <Button\n                    className=\"w-full\"\n                    size=\"lg\"\n                    onClick={handleConfirmPayment}\n                    disabled={confirmPaymentMutation.isPending}\n                    data-testid=\"button-confirm-payment\"\n                  >\n                    {confirmPaymentMutation.isPending && (\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    )}\n                    Confirm Payment (${finalPrice.toFixed(2)})\n                  </Button>\n                </CardContent>\n              </Card>\n            )}\n\n            {step === \"confirmation\" && (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <div className=\"w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-6\">\n                    <Check className=\"h-8 w-8 text-green-600 dark:text-green-400\" />\n                  </div>\n                  <h2 className=\"text-2xl font-semibold mb-2\">Booking Confirmed!</h2>\n                  <p className=\"text-muted-foreground mb-6\">\n                    Your reservation has been successfully confirmed. \n                    A confirmation email has been sent to your registered email address.\n                  </p>\n                  <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n                    <Button asChild>\n                      <Link href=\"/dashboard\" data-testid=\"link-view-bookings\">\n                        View My Bookings\n                      </Link>\n                    </Button>\n                    <Button variant=\"outline\" asChild>\n                      <Link href=\"/rooms\" data-testid=\"link-browse-more\">\n                        Browse More Rooms\n                      </Link>\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-24\">\n              <CardHeader>\n                <CardTitle>Booking Summary</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"flex gap-4\">\n                  {room.images && room.images.length > 0 ? (\n                    <img\n                      src={room.images[0]}\n                      alt={room.name}\n                      className=\"w-20 h-20 object-cover rounded-lg\"\n                    />\n                  ) : (\n                    <div className=\"w-20 h-20 bg-muted rounded-lg flex items-center justify-center\">\n                      <Bed className=\"h-6 w-6 text-muted-foreground\" />\n                    </div>\n                  )}\n                  <div>\n                    <h3 className=\"font-semibold\">{room.name}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{room.category}</p>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Check-in</span>\n                    <span>{format(checkIn, \"MMM d, yyyy\")}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Check-out</span>\n                    <span>{format(checkOut, \"MMM d, yyyy\")}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Guests</span>\n                    <span>{guests}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">Duration</span>\n                    <span>{nights} night{nights > 1 ? \"s\" : \"\"}</span>\n                  </div>\n                </div>\n\n                <Separator />\n\n                <div className=\"space-y-2\">\n                  <div className=\"flex justify-between text-sm\">\n                    <span>${room.pricePerNight} x {nights} nights</span>\n                    <span>${totalPrice}</span>\n                  </div>\n                  {appliedPromo && (\n                    <div className=\"flex justify-between text-sm text-green-600 dark:text-green-400\">\n                      <span className=\"flex items-center gap-1\">\n                        <Tag className=\"h-3 w-3\" />\n                        {appliedPromo.code} \n                        <span className=\"text-muted-foreground\">\n                          ({appliedPromo.discountType === 'percentage' \n                            ? `${appliedPromo.discountValue}%` \n                            : `$${appliedPromo.discountValue}`})\n                        </span>\n                      </span>\n                      <span data-testid=\"text-discount-amount\">-${discountAmount.toFixed(2)}</span>\n                    </div>\n                  )}\n                  <Separator />\n                  <div className=\"flex justify-between font-semibold text-lg\">\n                    <span>Total</span>\n                    <span data-testid=\"text-final-price\">${finalPrice.toFixed(2)}</span>\n                  </div>\n                  {appliedPromo && (\n                    <p className=\"text-xs text-green-600 dark:text-green-400 text-right\">\n                      You save ${discountAmount.toFixed(2)}!\n                    </p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":22922,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/pages/Home.tsx":{"content":"import { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { ArrowRight, Star, Wifi, Coffee, Car, Dumbbell, UtensilsCrossed, Waves } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport heroImage from \"@assets/generated_images/luxury_hotel_exterior_sunset.png\";\nimport type { Room, Review } from \"@shared/schema\";\n\ninterface RoomWithReviews extends Room {\n  reviews: Review[];\n  averageRating: number;\n}\n\nconst amenityIcons = [\n  { icon: Wifi, label: \"Free WiFi\" },\n  { icon: Coffee, label: \"Breakfast\" },\n  { icon: Car, label: \"Free Parking\" },\n  { icon: Dumbbell, label: \"Fitness Center\" },\n  { icon: UtensilsCrossed, label: \"Restaurant\" },\n  { icon: Waves, label: \"Pool & Spa\" },\n];\n\nfunction RoomCard({ room }: { room: RoomWithReviews }) {\n  return (\n    <Card className=\"overflow-hidden group hover-elevate\" data-testid={`card-room-${room._id}`}>\n      <div className=\"relative aspect-[4/3] overflow-hidden\">\n        {room.images[0] ? (\n          <img\n            src={room.images[0]}\n            alt={room.name}\n            className=\"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\"\n          />\n        ) : (\n          <div className=\"w-full h-full bg-muted flex items-center justify-center\">\n            <span className=\"text-muted-foreground\">No image</span>\n          </div>\n        )}\n        <div className=\"absolute top-3 left-3\">\n          <span className=\"px-3 py-1 text-xs font-medium bg-primary text-primary-foreground rounded-full\">\n            {room.category}\n          </span>\n        </div>\n      </div>\n      <CardContent className=\"p-5\">\n        <div className=\"flex items-start justify-between gap-2 mb-2\">\n          <h3 className=\"font-semibold text-lg line-clamp-1\">{room.name}</h3>\n          {room.averageRating > 0 && (\n            <div className=\"flex items-center gap-1 shrink-0\">\n              <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-400\" />\n              <span className=\"text-sm font-medium\">{room.averageRating.toFixed(1)}</span>\n            </div>\n          )}\n        </div>\n        <p className=\"text-sm text-muted-foreground line-clamp-2 mb-4\">\n          {room.description}\n        </p>\n        <div className=\"flex items-center justify-between gap-2\">\n          <div>\n            <span className=\"text-2xl font-bold\">${room.pricePerNight}</span>\n            <span className=\"text-sm text-muted-foreground\">/night</span>\n          </div>\n          <Button asChild size=\"sm\">\n            <Link href={`/rooms/${room._id}`} data-testid={`link-view-room-${room._id}`}>\n              View Details\n            </Link>\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction RoomCardSkeleton() {\n  return (\n    <Card className=\"overflow-hidden\">\n      <Skeleton className=\"aspect-[4/3]\" />\n      <CardContent className=\"p-5 space-y-3\">\n        <Skeleton className=\"h-6 w-3/4\" />\n        <Skeleton className=\"h-4 w-full\" />\n        <Skeleton className=\"h-4 w-2/3\" />\n        <div className=\"flex items-center justify-between pt-2\">\n          <Skeleton className=\"h-8 w-20\" />\n          <Skeleton className=\"h-9 w-24\" />\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Home() {\n  const { data: rooms, isLoading } = useQuery<RoomWithReviews[]>({\n    queryKey: [\"/api/rooms\", { limit: 6 }],\n  });\n\n  return (\n    <div className=\"min-h-screen\">\n      <section className=\"relative h-[500px] md:h-[600px] flex items-center justify-center overflow-hidden\">\n        <div className=\"absolute inset-0\">\n          <img\n            src={heroImage}\n            alt=\"Grand Horizon Hotel\"\n            className=\"w-full h-full object-cover\"\n          />\n          <div className=\"absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/70\" />\n        </div>\n        \n        <div className=\"relative z-10 container mx-auto px-4 text-center text-white\">\n          <h1 className=\"text-4xl md:text-5xl lg:text-6xl font-serif font-bold mb-4 tracking-tight\">\n            Welcome to Grand Horizon\n          </h1>\n          <p className=\"text-lg md:text-xl text-white/90 max-w-2xl mx-auto mb-8\">\n            Experience the perfect blend of luxury and comfort. \n            Your unforgettable getaway awaits with stunning ocean views and world-class amenities.\n          </p>\n          <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n            <Button size=\"lg\" asChild className=\"min-w-[160px]\">\n              <Link href=\"/rooms\" data-testid=\"link-explore-rooms\">\n                Explore Rooms\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Link>\n            </Button>\n            <Button \n              size=\"lg\" \n              variant=\"outline\" \n              asChild \n              className=\"min-w-[160px] bg-white/10 backdrop-blur-sm border-white/30 text-white hover:bg-white/20\"\n            >\n              <Link href=\"/rooms\" data-testid=\"link-book-now\">\n                Book Now\n              </Link>\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      <section className=\"py-16 md:py-24 bg-card\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"text-center mb-12\">\n            <h2 className=\"text-3xl md:text-4xl font-serif font-bold mb-4\">\n              Our Amenities\n            </h2>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              Enjoy a wide range of premium amenities designed for your comfort and convenience.\n            </p>\n          </div>\n          <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6\">\n            {amenityIcons.map(({ icon: Icon, label }) => (\n              <div\n                key={label}\n                className=\"flex flex-col items-center gap-3 p-6 rounded-xl bg-background border hover-elevate\"\n              >\n                <div className=\"p-3 rounded-full bg-primary/10\">\n                  <Icon className=\"h-6 w-6 text-primary\" />\n                </div>\n                <span className=\"text-sm font-medium text-center\">{label}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <section className=\"py-16 md:py-24\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"flex items-center justify-between mb-12\">\n            <div>\n              <h2 className=\"text-3xl md:text-4xl font-serif font-bold mb-2\">\n                Featured Rooms\n              </h2>\n              <p className=\"text-muted-foreground\">\n                Discover our most popular accommodations.\n              </p>\n            </div>\n            <Button variant=\"outline\" asChild className=\"hidden md:flex\">\n              <Link href=\"/rooms\" data-testid=\"link-view-all-rooms\">\n                View All Rooms\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Link>\n            </Button>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {isLoading ? (\n              <>\n                <RoomCardSkeleton />\n                <RoomCardSkeleton />\n                <RoomCardSkeleton />\n              </>\n            ) : rooms && rooms.length > 0 ? (\n              rooms.slice(0, 6).map((room) => (\n                <RoomCard key={room._id} room={room} />\n              ))\n            ) : (\n              <div className=\"col-span-full text-center py-12\">\n                <p className=\"text-muted-foreground\">No rooms available at the moment.</p>\n              </div>\n            )}\n          </div>\n\n          <div className=\"mt-8 text-center md:hidden\">\n            <Button variant=\"outline\" asChild>\n              <Link href=\"/rooms\">\n                View All Rooms\n                <ArrowRight className=\"ml-2 h-4 w-4\" />\n              </Link>\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      <section className=\"py-16 md:py-24 bg-primary text-primary-foreground\">\n        <div className=\"container mx-auto px-4 text-center\">\n          <h2 className=\"text-3xl md:text-4xl font-serif font-bold mb-4\">\n            Ready to Experience Luxury?\n          </h2>\n          <p className=\"text-primary-foreground/80 max-w-2xl mx-auto mb-8\">\n            Book your stay today and discover why Grand Horizon Hotel is the \n            perfect destination for your next vacation.\n          </p>\n          <Button \n            size=\"lg\" \n            variant=\"secondary\" \n            asChild\n          >\n            <Link href=\"/rooms\" data-testid=\"link-cta-book\">\n              Book Your Stay\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n            </Link>\n          </Button>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":8878,"size_tokens":null},"client/src/pages/admin/AdminDashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport {\n  BedDouble,\n  Calendar,\n  DollarSign,\n  Users,\n  ArrowUpRight,\n  ArrowDownRight,\n} from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport type { BookingWithDetails, Room, BookingStatus } from \"@shared/schema\";\n\nconst statusColors: Record<BookingStatus, string> = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400\",\n  confirmed: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\",\n  checked_in: \"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400\",\n  checked_out: \"bg-gray-100 text-gray-800 dark:bg-gray-800/50 dark:text-gray-400\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400\",\n};\n\nconst statusLabels: Record<BookingStatus, string> = {\n  pending: \"Pending\",\n  confirmed: \"Confirmed\",\n  checked_in: \"Checked In\",\n  checked_out: \"Checked Out\",\n  cancelled: \"Cancelled\",\n};\n\ninterface DashboardStats {\n  totalRooms: number;\n  totalBookings: number;\n  totalRevenue: number;\n  occupancyRate: number;\n}\n\nexport default function AdminDashboard() {\n  const { data: stats, isLoading: isLoadingStats } = useQuery<DashboardStats>({\n    queryKey: [\"/api/admin/stats\"],\n  });\n\n  const { data: recentBookings, isLoading: isLoadingBookings } = useQuery<BookingWithDetails[]>({\n    queryKey: [\"/api/admin/bookings\", { limit: 5 }],\n  });\n\n  const statCards = [\n    {\n      title: \"Total Rooms\",\n      value: stats?.totalRooms ?? 0,\n      icon: BedDouble,\n      color: \"text-blue-600\",\n      bgColor: \"bg-blue-100 dark:bg-blue-900/30\",\n    },\n    {\n      title: \"Total Bookings\",\n      value: stats?.totalBookings ?? 0,\n      icon: Calendar,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-100 dark:bg-green-900/30\",\n    },\n    {\n      title: \"Total Revenue\",\n      value: `$${(stats?.totalRevenue ?? 0).toLocaleString()}`,\n      icon: DollarSign,\n      color: \"text-amber-600\",\n      bgColor: \"bg-amber-100 dark:bg-amber-900/30\",\n    },\n    {\n      title: \"Occupancy Rate\",\n      value: `${stats?.occupancyRate ?? 0}%`,\n      icon: Users,\n      color: \"text-purple-600\",\n      bgColor: \"bg-purple-100 dark:bg-purple-900/30\",\n    },\n  ];\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-bold\">Dashboard</h1>\n        <p className=\"text-muted-foreground\">Overview of your hotel operations.</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {statCards.map((stat) => (\n          <Card key={stat.title}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">{stat.title}</p>\n                  {isLoadingStats ? (\n                    <Skeleton className=\"h-8 w-20 mt-1\" />\n                  ) : (\n                    <p className=\"text-2xl font-bold\" data-testid={`stat-${stat.title.toLowerCase().replace(\" \", \"-\")}`}>\n                      {stat.value}\n                    </p>\n                  )}\n                </div>\n                <div className={`p-3 rounded-full ${stat.bgColor}`}>\n                  <stat.icon className={`h-5 w-5 ${stat.color}`} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Recent Bookings</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoadingBookings ? (\n            <div className=\"space-y-4\">\n              {[...Array(5)].map((_, i) => (\n                <div key={i} className=\"flex items-center gap-4\">\n                  <Skeleton className=\"h-12 w-12 rounded\" />\n                  <div className=\"space-y-2 flex-1\">\n                    <Skeleton className=\"h-4 w-1/4\" />\n                    <Skeleton className=\"h-3 w-1/3\" />\n                  </div>\n                  <Skeleton className=\"h-6 w-20\" />\n                </div>\n              ))}\n            </div>\n          ) : recentBookings && recentBookings.length > 0 ? (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Guest</TableHead>\n                  <TableHead>Room</TableHead>\n                  <TableHead>Check-in</TableHead>\n                  <TableHead>Check-out</TableHead>\n                  <TableHead>Total</TableHead>\n                  <TableHead>Status</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {recentBookings.map((booking) => (\n                  <TableRow key={booking._id} data-testid={`booking-row-${booking._id}`}>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">\n                          {booking.user?.firstName} {booking.user?.lastName}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {booking.user?.email}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell>{booking.room?.name}</TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkInDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkOutDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>${booking.totalPrice}</TableCell>\n                    <TableCell>\n                      <Badge className={statusColors[booking.status]}>\n                        {statusLabels[booking.status]}\n                      </Badge>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          ) : (\n            <p className=\"text-center text-muted-foreground py-8\">\n              No recent bookings.\n            </p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":6350,"size_tokens":null},"client/src/lib/theme.tsx":{"content":"import { createContext, useContext, useEffect, useState, ReactNode } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ninterface ThemeContextType {\n  theme: Theme;\n  toggleTheme: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: ReactNode }) {\n  const [theme, setTheme] = useState<Theme>(() => {\n    if (typeof window !== \"undefined\") {\n      const stored = localStorage.getItem(\"theme\") as Theme;\n      if (stored) return stored;\n      return window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n    }\n    return \"light\";\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme((prev) => (prev === \"light\" ? \"dark\" : \"light\"));\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":1267,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { AuthProvider } from \"@/lib/auth\";\nimport { ThemeProvider } from \"@/lib/theme\";\nimport { Header } from \"@/components/layout/Header\";\nimport { Footer } from \"@/components/layout/Footer\";\nimport { ProtectedRoute } from \"@/components/ProtectedRoute\";\n\nimport Home from \"@/pages/Home\";\nimport Rooms from \"@/pages/Rooms\";\nimport RoomDetail from \"@/pages/RoomDetail\";\nimport Booking from \"@/pages/Booking\";\nimport PaymentComplete from \"@/pages/PaymentComplete\";\nimport Dashboard from \"@/pages/Dashboard\";\nimport Login from \"@/pages/auth/Login\";\nimport Register from \"@/pages/auth/Register\";\nimport { AdminLayout } from \"@/pages/admin/AdminLayout\";\nimport AdminDashboard from \"@/pages/admin/AdminDashboard\";\nimport AdminRooms from \"@/pages/admin/AdminRooms\";\nimport AdminBookings from \"@/pages/admin/AdminBookings\";\nimport AdminPromoCodes from \"@/pages/admin/AdminPromoCodes\";\nimport { ManagerLayout } from \"@/pages/manager/ManagerLayout\";\nimport ManagerDashboard from \"@/pages/manager/ManagerDashboard\";\nimport ManagerBookings from \"@/pages/manager/ManagerBookings\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction PublicLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Header />\n      <main className=\"flex-1\">{children}</main>\n      <Footer />\n    </div>\n  );\n}\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\">\n        <PublicLayout>\n          <Home />\n        </PublicLayout>\n      </Route>\n      <Route path=\"/rooms\">\n        <PublicLayout>\n          <Rooms />\n        </PublicLayout>\n      </Route>\n      <Route path=\"/rooms/:id\">\n        <PublicLayout>\n          <RoomDetail />\n        </PublicLayout>\n      </Route>\n      <Route path=\"/login\">\n        <Login />\n      </Route>\n      <Route path=\"/register\">\n        <Register />\n      </Route>\n      <Route path=\"/booking\">\n        <ProtectedRoute>\n          <PublicLayout>\n            <Booking />\n          </PublicLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/payment/:bookingId\">\n        <ProtectedRoute>\n          <PublicLayout>\n            <PaymentComplete />\n          </PublicLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/dashboard\">\n        <ProtectedRoute>\n          <PublicLayout>\n            <Dashboard />\n          </PublicLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin\">\n        <ProtectedRoute requiredRole=\"admin\">\n          <AdminLayout>\n            <AdminDashboard />\n          </AdminLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/rooms\">\n        <ProtectedRoute requiredRole=\"admin\">\n          <AdminLayout>\n            <AdminRooms />\n          </AdminLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/bookings\">\n        <ProtectedRoute requiredRole=\"admin\">\n          <AdminLayout>\n            <AdminBookings />\n          </AdminLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/admin/promo-codes\">\n        <ProtectedRoute requiredRole=\"admin\">\n          <AdminLayout>\n            <AdminPromoCodes />\n          </AdminLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/manager\">\n        <ProtectedRoute requiredRole=\"manager\">\n          <ManagerLayout>\n            <ManagerDashboard />\n          </ManagerLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route path=\"/manager/bookings\">\n        <ProtectedRoute requiredRole=\"manager\">\n          <ManagerLayout>\n            <ManagerBookings />\n          </ManagerLayout>\n        </ProtectedRoute>\n      </Route>\n      <Route>\n        <PublicLayout>\n          <NotFound />\n        </PublicLayout>\n      </Route>\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider>\n        <AuthProvider>\n          <TooltipProvider>\n            <Toaster />\n            <Router />\n          </TooltipProvider>\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":4312,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"server/db/models/index.ts":{"content":"export { User } from './User';\nexport { Room } from './Room';\nexport { Booking } from './Booking';\nexport { Review } from './Review';\nexport { PromoCode } from './PromoCode';\nexport type { IUser } from './User';\nexport type { IRoom } from './Room';\nexport type { IBooking } from './Booking';\nexport type { IReview } from './Review';\nexport type { IPromoCode } from './PromoCode';\n","path":null,"size_bytes":380,"size_tokens":null},"client/src/pages/admin/AdminPromoCodes.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { format } from \"date-fns\";\nimport {\n  Plus,\n  Pencil,\n  Trash2,\n  Loader2,\n  Search,\n  Tag,\n  Percent,\n  DollarSign,\n  Calendar,\n  Power,\n  PowerOff,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { insertPromoCodeSchema, type PromoCode, type InsertPromoCode, discountTypes } from \"@shared/schema\";\nimport { z } from \"zod\";\n\nconst promoCodeFormSchema = insertPromoCodeSchema.extend({\n  validFrom: z.string(),\n  validTo: z.string(),\n});\n\ntype PromoCodeFormData = z.infer<typeof promoCodeFormSchema>;\n\nexport default function AdminPromoCodes() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingPromoCode, setEditingPromoCode] = useState<PromoCode | null>(null);\n  const [deletePromoCodeId, setDeletePromoCodeId] = useState<string | null>(null);\n\n  const { data: promoCodes, isLoading } = useQuery<PromoCode[]>({\n    queryKey: [\"/api/admin/promo-codes\"],\n  });\n\n  const form = useForm<PromoCodeFormData>({\n    resolver: zodResolver(promoCodeFormSchema),\n    defaultValues: {\n      code: \"\",\n      description: \"\",\n      discountType: \"percentage\",\n      discountValue: 10,\n      minBookingAmount: 0,\n      maxDiscountAmount: undefined,\n      validFrom: format(new Date(), \"yyyy-MM-dd\"),\n      validTo: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), \"yyyy-MM-dd\"),\n      usageLimit: undefined,\n      isActive: true,\n    },\n  });\n\n  const createMutation = useMutation({\n    mutationFn: (data: PromoCodeFormData) =>\n      apiRequest(\"POST\", \"/api/admin/promo-codes\", {\n        ...data,\n        validFrom: new Date(data.validFrom).toISOString(),\n        validTo: new Date(data.validTo).toISOString(),\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/promo-codes\"] });\n      setIsDialogOpen(false);\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: \"Promo code created successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create promo code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: (data: PromoCodeFormData) =>\n      apiRequest(\"PUT\", `/api/admin/promo-codes/${editingPromoCode?._id}`, {\n        ...data,\n        validFrom: new Date(data.validFrom).toISOString(),\n        validTo: new Date(data.validTo).toISOString(),\n      }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/promo-codes\"] });\n      setIsDialogOpen(false);\n      setEditingPromoCode(null);\n      form.reset();\n      toast({\n        title: \"Success\",\n        description: \"Promo code updated successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update promo code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(\"DELETE\", `/api/admin/promo-codes/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/promo-codes\"] });\n      setDeletePromoCodeId(null);\n      toast({\n        title: \"Success\",\n        description: \"Promo code deleted successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete promo code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const toggleMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(\"PATCH\", `/api/admin/promo-codes/${id}/toggle`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/promo-codes\"] });\n      toast({\n        title: \"Success\",\n        description: \"Promo code status updated\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to toggle promo code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const openCreateDialog = () => {\n    setEditingPromoCode(null);\n    form.reset({\n      code: \"\",\n      description: \"\",\n      discountType: \"percentage\",\n      discountValue: 10,\n      minBookingAmount: 0,\n      maxDiscountAmount: undefined,\n      validFrom: format(new Date(), \"yyyy-MM-dd\"),\n      validTo: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), \"yyyy-MM-dd\"),\n      usageLimit: undefined,\n      isActive: true,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const openEditDialog = (promoCode: PromoCode) => {\n    setEditingPromoCode(promoCode);\n    form.reset({\n      code: promoCode.code,\n      description: promoCode.description || \"\",\n      discountType: promoCode.discountType,\n      discountValue: promoCode.discountValue,\n      minBookingAmount: promoCode.minBookingAmount,\n      maxDiscountAmount: promoCode.maxDiscountAmount,\n      validFrom: format(new Date(promoCode.validFrom), \"yyyy-MM-dd\"),\n      validTo: format(new Date(promoCode.validTo), \"yyyy-MM-dd\"),\n      usageLimit: promoCode.usageLimit,\n      isActive: promoCode.isActive,\n    });\n    setIsDialogOpen(true);\n  };\n\n  const onSubmit = (data: PromoCodeFormData) => {\n    if (editingPromoCode) {\n      updateMutation.mutate(data);\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  const filteredPromoCodes = promoCodes?.filter((code) =>\n    code.code.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    code.description?.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const getStatusBadge = (promoCode: PromoCode) => {\n    const now = new Date();\n    const validFrom = new Date(promoCode.validFrom);\n    const validTo = new Date(promoCode.validTo);\n\n    if (!promoCode.isActive) {\n      return <Badge variant=\"secondary\" data-testid={`badge-status-inactive-${promoCode._id}`}>Inactive</Badge>;\n    }\n    if (now < validFrom) {\n      return <Badge variant=\"outline\" className=\"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-950 dark:text-blue-300 dark:border-blue-800\" data-testid={`badge-status-scheduled-${promoCode._id}`}>Scheduled</Badge>;\n    }\n    if (now > validTo) {\n      return <Badge variant=\"destructive\" data-testid={`badge-status-expired-${promoCode._id}`}>Expired</Badge>;\n    }\n    if (promoCode.usageLimit && promoCode.usageCount >= promoCode.usageLimit) {\n      return <Badge variant=\"secondary\" data-testid={`badge-status-limit-${promoCode._id}`}>Limit Reached</Badge>;\n    }\n    return <Badge variant=\"default\" className=\"bg-green-600\" data-testid={`badge-status-active-${promoCode._id}`}>Active</Badge>;\n  };\n\n  const formatDiscount = (promoCode: PromoCode) => {\n    if (promoCode.discountType === \"percentage\") {\n      return `${promoCode.discountValue}%`;\n    }\n    return `$${promoCode.discountValue.toFixed(2)}`;\n  };\n\n  // Stats\n  const activeCount = promoCodes?.filter(p => {\n    const now = new Date();\n    return p.isActive && new Date(p.validFrom) <= now && new Date(p.validTo) >= now &&\n      (!p.usageLimit || p.usageCount < p.usageLimit);\n  }).length || 0;\n\n  const scheduledCount = promoCodes?.filter(p => {\n    const now = new Date();\n    return p.isActive && new Date(p.validFrom) > now;\n  }).length || 0;\n\n  const expiredCount = promoCodes?.filter(p => {\n    const now = new Date();\n    return new Date(p.validTo) < now || (p.usageLimit && p.usageCount >= p.usageLimit);\n  }).length || 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold\" data-testid=\"text-page-title\">Promo Codes</h1>\n          <p className=\"text-muted-foreground\" data-testid=\"text-page-description\">\n            Manage discount codes and promotions\n          </p>\n        </div>\n        <Button onClick={openCreateDialog} data-testid=\"button-create-promo\">\n          <Plus className=\"mr-2 h-4 w-4\" />\n          Add Promo Code\n        </Button>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 grid-cols-2 lg:grid-cols-4\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Total Codes</CardTitle>\n            <Tag className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\" data-testid=\"text-total-codes\">\n              {isLoading ? <Skeleton className=\"h-8 w-16\" /> : promoCodes?.length || 0}\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Active</CardTitle>\n            <Power className=\"h-4 w-4 text-green-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-active-codes\">\n              {isLoading ? <Skeleton className=\"h-8 w-16\" /> : activeCount}\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Scheduled</CardTitle>\n            <Calendar className=\"h-4 w-4 text-blue-500\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"text-scheduled-codes\">\n              {isLoading ? <Skeleton className=\"h-8 w-16\" /> : scheduledCount}\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between gap-2 space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Expired</CardTitle>\n            <PowerOff className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-muted-foreground\" data-testid=\"text-expired-codes\">\n              {isLoading ? <Skeleton className=\"h-8 w-16\" /> : expiredCount}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Search */}\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n        <Input\n          placeholder=\"Search promo codes...\"\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          className=\"pl-10\"\n          data-testid=\"input-search-promo\"\n        />\n      </div>\n\n      {/* Table */}\n      <Card>\n        <CardContent className=\"p-0\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead>Code</TableHead>\n                <TableHead>Discount</TableHead>\n                <TableHead className=\"hidden md:table-cell\">Min. Amount</TableHead>\n                <TableHead className=\"hidden lg:table-cell\">Valid Period</TableHead>\n                <TableHead className=\"hidden md:table-cell\">Usage</TableHead>\n                <TableHead>Status</TableHead>\n                <TableHead className=\"text-right\">Actions</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {isLoading ? (\n                Array.from({ length: 5 }).map((_, i) => (\n                  <TableRow key={i}>\n                    <TableCell><Skeleton className=\"h-5 w-24\" /></TableCell>\n                    <TableCell><Skeleton className=\"h-5 w-16\" /></TableCell>\n                    <TableCell className=\"hidden md:table-cell\"><Skeleton className=\"h-5 w-16\" /></TableCell>\n                    <TableCell className=\"hidden lg:table-cell\"><Skeleton className=\"h-5 w-32\" /></TableCell>\n                    <TableCell className=\"hidden md:table-cell\"><Skeleton className=\"h-5 w-16\" /></TableCell>\n                    <TableCell><Skeleton className=\"h-5 w-20\" /></TableCell>\n                    <TableCell><Skeleton className=\"h-8 w-24 ml-auto\" /></TableCell>\n                  </TableRow>\n                ))\n              ) : filteredPromoCodes?.length === 0 ? (\n                <TableRow>\n                  <TableCell colSpan={7} className=\"h-24 text-center\">\n                    <div className=\"flex flex-col items-center gap-2 text-muted-foreground\">\n                      <Tag className=\"h-8 w-8\" />\n                      <p>No promo codes found</p>\n                      {searchQuery && (\n                        <Button\n                          variant=\"link\"\n                          onClick={() => setSearchQuery(\"\")}\n                          data-testid=\"button-clear-search\"\n                        >\n                          Clear search\n                        </Button>\n                      )}\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ) : (\n                filteredPromoCodes?.map((promoCode) => (\n                  <TableRow key={promoCode._id} data-testid={`row-promo-${promoCode._id}`}>\n                    <TableCell>\n                      <div className=\"flex flex-col\">\n                        <span className=\"font-mono font-semibold\" data-testid={`text-code-${promoCode._id}`}>\n                          {promoCode.code}\n                        </span>\n                        {promoCode.description && (\n                          <span className=\"text-sm text-muted-foreground line-clamp-1\">\n                            {promoCode.description}\n                          </span>\n                        )}\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      <div className=\"flex items-center gap-1\">\n                        {promoCode.discountType === \"percentage\" ? (\n                          <Percent className=\"h-3 w-3 text-muted-foreground\" />\n                        ) : (\n                          <DollarSign className=\"h-3 w-3 text-muted-foreground\" />\n                        )}\n                        <span className=\"font-semibold\" data-testid={`text-discount-${promoCode._id}`}>\n                          {formatDiscount(promoCode)}\n                        </span>\n                      </div>\n                      {promoCode.maxDiscountAmount && (\n                        <span className=\"text-xs text-muted-foreground\">\n                          Max: ${promoCode.maxDiscountAmount}\n                        </span>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"hidden md:table-cell\">\n                      ${promoCode.minBookingAmount.toFixed(2)}\n                    </TableCell>\n                    <TableCell className=\"hidden lg:table-cell\">\n                      <div className=\"flex flex-col text-sm\">\n                        <span>{format(new Date(promoCode.validFrom), \"MMM d, yyyy\")}</span>\n                        <span className=\"text-muted-foreground\">\n                          to {format(new Date(promoCode.validTo), \"MMM d, yyyy\")}\n                        </span>\n                      </div>\n                    </TableCell>\n                    <TableCell className=\"hidden md:table-cell\">\n                      <span data-testid={`text-usage-${promoCode._id}`}>\n                        {promoCode.usageCount}\n                        {promoCode.usageLimit && ` / ${promoCode.usageLimit}`}\n                      </span>\n                    </TableCell>\n                    <TableCell>\n                      {getStatusBadge(promoCode)}\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex items-center justify-end gap-2\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => toggleMutation.mutate(promoCode._id)}\n                          disabled={toggleMutation.isPending}\n                          title={promoCode.isActive ? \"Deactivate\" : \"Activate\"}\n                          data-testid={`button-toggle-${promoCode._id}`}\n                        >\n                          {promoCode.isActive ? (\n                            <PowerOff className=\"h-4 w-4\" />\n                          ) : (\n                            <Power className=\"h-4 w-4\" />\n                          )}\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => openEditDialog(promoCode)}\n                          data-testid={`button-edit-${promoCode._id}`}\n                        >\n                          <Pencil className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => setDeletePromoCodeId(promoCode._id)}\n                          className=\"text-destructive hover:text-destructive\"\n                          data-testid={`button-delete-${promoCode._id}`}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))\n              )}\n            </TableBody>\n          </Table>\n        </CardContent>\n      </Card>\n\n      {/* Create/Edit Dialog */}\n      <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-dialog-title\">\n              {editingPromoCode ? \"Edit Promo Code\" : \"Create Promo Code\"}\n            </DialogTitle>\n            <DialogDescription>\n              {editingPromoCode\n                ? \"Update the promo code details below\"\n                : \"Fill in the details to create a new promo code\"}\n            </DialogDescription>\n          </DialogHeader>\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"code\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Code</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          placeholder=\"SUMMER25\"\n                          className=\"uppercase\"\n                          data-testid=\"input-code\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        3-20 characters, will be converted to uppercase\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"discountType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Discount Type</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                        value={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-discount-type\">\n                            <SelectValue placeholder=\"Select type\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"percentage\">Percentage (%)</SelectItem>\n                          <SelectItem value=\"fixed\">Fixed Amount ($)</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Description (Optional)</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        {...field}\n                        placeholder=\"Summer sale discount...\"\n                        rows={2}\n                        data-testid=\"input-description\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"grid gap-4 sm:grid-cols-3\">\n                <FormField\n                  control={form.control}\n                  name=\"discountValue\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>\n                        Discount Value\n                        {form.watch(\"discountType\") === \"percentage\" ? \" (%)\" : \" ($)\"}\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          {...field}\n                          onChange={(e) => field.onChange(parseFloat(e.target.value) || 0)}\n                          min={0}\n                          max={form.watch(\"discountType\") === \"percentage\" ? 100 : undefined}\n                          step={form.watch(\"discountType\") === \"percentage\" ? 1 : 0.01}\n                          data-testid=\"input-discount-value\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"minBookingAmount\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Min. Booking ($)</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          {...field}\n                          onChange={(e) => field.onChange(parseFloat(e.target.value) || 0)}\n                          min={0}\n                          step={0.01}\n                          data-testid=\"input-min-amount\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"maxDiscountAmount\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Max Discount ($)</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            field.onChange(val ? parseFloat(val) : undefined);\n                          }}\n                          min={0}\n                          step={0.01}\n                          placeholder=\"No limit\"\n                          data-testid=\"input-max-discount\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Leave empty for no limit\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"validFrom\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Valid From</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"date\"\n                          {...field}\n                          data-testid=\"input-valid-from\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"validTo\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Valid To</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"date\"\n                          {...field}\n                          data-testid=\"input-valid-to\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"grid gap-4 sm:grid-cols-2\">\n                <FormField\n                  control={form.control}\n                  name=\"usageLimit\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Usage Limit</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          {...field}\n                          value={field.value ?? \"\"}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            field.onChange(val ? parseInt(val) : undefined);\n                          }}\n                          min={1}\n                          step={1}\n                          placeholder=\"Unlimited\"\n                          data-testid=\"input-usage-limit\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Leave empty for unlimited uses\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"isActive\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-4\">\n                      <div className=\"space-y-0.5\">\n                        <FormLabel className=\"text-base\">Active</FormLabel>\n                        <FormDescription>\n                          Enable or disable this promo code\n                        </FormDescription>\n                      </div>\n                      <FormControl>\n                        <Switch\n                          checked={field.value}\n                          onCheckedChange={field.onChange}\n                          data-testid=\"switch-is-active\"\n                        />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <DialogFooter>\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => setIsDialogOpen(false)}\n                  data-testid=\"button-cancel\"\n                >\n                  Cancel\n                </Button>\n                <Button\n                  type=\"submit\"\n                  disabled={createMutation.isPending || updateMutation.isPending}\n                  data-testid=\"button-submit\"\n                >\n                  {(createMutation.isPending || updateMutation.isPending) && (\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  )}\n                  {editingPromoCode ? \"Update\" : \"Create\"}\n                </Button>\n              </DialogFooter>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation */}\n      <AlertDialog\n        open={!!deletePromoCodeId}\n        onOpenChange={(open) => !open && setDeletePromoCodeId(null)}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Delete Promo Code</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to delete this promo code? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel data-testid=\"button-cancel-delete\">Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => deletePromoCodeId && deleteMutation.mutate(deletePromoCodeId)}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? (\n                <Loader2 className=\"h-4 w-4 animate-spin\" />\n              ) : (\n                \"Delete\"\n              )}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":30826,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/layout/ThemeToggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/lib/theme\";\n\nexport function ThemeToggle() {\n  const { theme, toggleTheme } = useTheme();\n\n  return (\n    <Button \n      variant=\"ghost\" \n      size=\"icon\" \n      onClick={toggleTheme}\n      data-testid=\"button-theme-toggle\"\n    >\n      {theme === \"dark\" ? (\n        <Sun className=\"h-5 w-5\" />\n      ) : (\n        <Moon className=\"h-5 w-5\" />\n      )}\n      <span className=\"sr-only\">Toggle theme</span>\n    </Button>\n  );\n}\n","path":null,"size_bytes":545,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"server/routes/reviews.ts":{"content":"import { Router, Response } from 'express';\nimport { Review, Booking } from '../db/models';\nimport { authenticate, AuthRequest } from '../middleware/auth';\nimport { z } from 'zod';\n\nconst router = Router();\n\nconst createReviewSchema = z.object({\n  bookingId: z.string(),\n  roomId: z.string(),\n  rating: z.number().int().min(1).max(5),\n  comment: z.string().min(10),\n});\n\nrouter.use(authenticate);\n\nrouter.post('/', async (req: AuthRequest, res: Response) => {\n  try {\n    const data = createReviewSchema.parse(req.body);\n\n    const booking = await Booking.findOne({\n      _id: data.bookingId,\n      userId: req.user!._id,\n      roomId: data.roomId,\n    });\n\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    if (booking.status !== 'checked_out') {\n      return res.status(400).json({ message: 'Can only review after checkout' });\n    }\n\n    const existingReview = await Review.findOne({ bookingId: data.bookingId });\n    if (existingReview) {\n      return res.status(400).json({ message: 'You have already reviewed this stay' });\n    }\n\n    const review = new Review({\n      userId: req.user!._id,\n      roomId: data.roomId,\n      bookingId: data.bookingId,\n      rating: data.rating,\n      comment: data.comment,\n    });\n\n    await review.save();\n\n    res.status(201).json(review.toJSON());\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Error creating review:', error);\n    res.status(500).json({ message: 'Failed to create review' });\n  }\n});\n\nrouter.get('/my', async (req: AuthRequest, res: Response) => {\n  try {\n    const reviews = await Review.find({ userId: req.user!._id })\n      .populate('roomId', 'name images')\n      .sort({ createdAt: -1 });\n\n    res.json(reviews.map((r) => ({\n      ...r.toJSON(),\n      room: r.roomId,\n    })));\n  } catch (error) {\n    console.error('Error fetching reviews:', error);\n    res.status(500).json({ message: 'Failed to fetch reviews' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":2076,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 45 100% 96.86%;\n  --foreground: 38.18 53.23% 24.31%;\n  --border: 44.21 26.76% 86.08%;\n  --card: 47.14 87.5% 96.86%;\n  --card-foreground: 39.27 43.31% 24.9%;\n  --card-border: 44.21 30% 92%;\n  --sidebar: 180 6.67% 97.06%;\n  --sidebar-foreground: 39.27 43.31% 24.9%;\n  --sidebar-border: 205 25% 90.59%;\n  --sidebar-primary: 38.23 87.6% 74.71%;\n  --sidebar-primary-foreground: 39.27 43.31% 24.9%;\n  --sidebar-accent: 211.58 51.35% 92.75%;\n  --sidebar-accent-foreground: 38.23 87.6% 65%;\n  --sidebar-ring: 38.23 87.6% 74.71%;\n  --popover: 0 0% 100%;\n  --popover-foreground: 39.27 43.31% 24.9%;\n  --popover-border: 44.21 26.76% 88%;\n  --primary: 38.23 87.6% 74.71%;\n  --primary-foreground: 39.27 43.31% 24.9%;\n  --secondary: 39.27 43.31% 24.9%;\n  --secondary-foreground: 39.75 86.96% 81.96%;\n  --muted: 38.4 60.98% 91.96%;\n  --muted-foreground: 38.18 53.23% 24.31%;\n  --accent: 74.4 39.68% 87.65%;\n  --accent-foreground: 91.43 10.55% 39.02%;\n  --destructive: 0.49 54.19% 55.49%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 44.21 26.76% 86.08%;\n  --ring: 39.27 43.31% 24.9%;\n  --chart-1: 203.89 88.28% 53.14%;\n  --chart-2: 159.78 100% 36.08%;\n  --chart-3: 42.03 92.83% 56.27%;\n  --chart-4: 147.14 78.5% 41.96%;\n  --chart-5: 341.49 75.2% 50.98%;\n  --font-sans: 'Lora', serif;\n  --font-serif: 'Geist', sans-serif;\n  --font-mono: 'Space Grotesk', sans-serif;\n  --radius: 0.875rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 0%;\n  --foreground: 200 6.67% 91.18%;\n  --border: 210 5.26% 14.90%;\n  --card: 228 9.8% 10%;\n  --card-foreground: 0 0% 85.10%;\n  --card-border: 210 5.26% 16%;\n  --sidebar: 228 9.8% 10%;\n  --sidebar-foreground: 0 0% 85.10%;\n  --sidebar-border: 205.71 15.79% 26.08%;\n  --sidebar-primary: 202.82 89.12% 53.14%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 205.71 70% 7.84%;\n  --sidebar-accent-foreground: 203.77 87.6% 52.55%;\n  --sidebar-ring: 202.82 89.12% 53.14%;\n  --popover: 0 0% 0%;\n  --popover-foreground: 200 6.67% 91.18%;\n  --popover-border: 210 5.26% 12%;\n  --primary: 203.77 87.6% 52.55%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 195 15.38% 94.90%;\n  --secondary-foreground: 210 25% 7.84%;\n  --muted: 0 0% 9.41%;\n  --muted-foreground: 210 3.39% 46.27%;\n  --accent: 205.71 70% 7.84%;\n  --accent-foreground: 203.77 87.6% 52.55%;\n  --destructive: 356.3 90.56% 54.31%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 207.69 27.66% 18.43%;\n  --ring: 202.82 89.12% 53.14%;\n  --chart-1: 203.89 88.28% 53.14%;\n  --chart-2: 159.78 100% 36.08%;\n  --chart-3: 42.03 92.83% 56.27%;\n  --chart-4: 147.14 78.5% 41.96%;\n  --chart-5: 341.49 75.2% 50.98%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","path":null,"size_bytes":11547,"size_tokens":null},"client/src/pages/RoomDetail.tsx":{"content":"import { useState } from \"react\";\nimport { useRoute, Link, useLocation } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { format, differenceInDays, addDays } from \"date-fns\";\nimport {\n  ArrowLeft,\n  Star,\n  Users,\n  ChevronLeft,\n  ChevronRight,\n  Check,\n  Calendar,\n  Minus,\n  Plus,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Calendar as CalendarComponent } from \"@/components/ui/calendar\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { useAuth } from \"@/lib/auth\";\nimport type { RoomWithReviews } from \"@shared/schema\";\n\nexport default function RoomDetail() {\n  const [, params] = useRoute(\"/rooms/:id\");\n  const [, setLocation] = useLocation();\n  const { isAuthenticated } = useAuth();\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n  const [checkIn, setCheckIn] = useState<Date>();\n  const [checkOut, setCheckOut] = useState<Date>();\n  const [guests, setGuests] = useState(1);\n\n  const { data: room, isLoading } = useQuery<RoomWithReviews>({\n    queryKey: [`/api/rooms/${params?.id}`],\n    enabled: !!params?.id,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <Skeleton className=\"h-8 w-32 mb-6\" />\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n            <div className=\"lg:col-span-2 space-y-6\">\n              <Skeleton className=\"aspect-[16/9] rounded-xl\" />\n              <Skeleton className=\"h-10 w-64\" />\n              <Skeleton className=\"h-20 w-full\" />\n            </div>\n            <div>\n              <Skeleton className=\"h-96 w-full rounded-xl\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!room) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-semibold mb-2\">Room not found</h2>\n          <p className=\"text-muted-foreground mb-4\">\n            The room you're looking for doesn't exist.\n          </p>\n          <Button asChild>\n            <Link href=\"/rooms\">Back to Rooms</Link>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  const nights = checkIn && checkOut ? differenceInDays(checkOut, checkIn) : 0;\n  const totalPrice = nights * room.pricePerNight;\n\n  const handleBookNow = () => {\n    if (!isAuthenticated) {\n      setLocation(\"/login?redirect=/rooms/\" + room._id);\n      return;\n    }\n    if (!checkIn || !checkOut) return;\n    \n    const bookingParams = new URLSearchParams({\n      roomId: room._id,\n      checkIn: checkIn.toISOString(),\n      checkOut: checkOut.toISOString(),\n      guests: String(guests),\n    });\n    setLocation(`/booking?${bookingParams.toString()}`);\n  };\n\n  const images = room?.images || [];\n  const reviews = room?.reviews || [];\n  const amenities = room?.amenities || [];\n\n  const nextImage = () => {\n    setCurrentImageIndex((prev) => \n      prev === images.length - 1 ? 0 : prev + 1\n    );\n  };\n\n  const prevImage = () => {\n    setCurrentImageIndex((prev) => \n      prev === 0 ? images.length - 1 : prev - 1\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <Button variant=\"ghost\" asChild className=\"mb-6 gap-2\">\n          <Link href=\"/rooms\" data-testid=\"link-back-to-rooms\">\n            <ArrowLeft className=\"h-4 w-4\" />\n            Back to Rooms\n          </Link>\n        </Button>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2 space-y-6\">\n            <div className=\"relative aspect-[16/9] rounded-xl overflow-hidden bg-muted\">\n              {images.length > 0 ? (\n                <>\n                  <img\n                    src={images[currentImageIndex]}\n                    alt={`${room.name} - Image ${currentImageIndex + 1}`}\n                    className=\"w-full h-full object-cover\"\n                  />\n                  {images.length > 1 && (\n                    <>\n                      <Button\n                        variant=\"secondary\"\n                        size=\"icon\"\n                        className=\"absolute left-4 top-1/2 -translate-y-1/2\"\n                        onClick={prevImage}\n                        data-testid=\"button-prev-image\"\n                      >\n                        <ChevronLeft className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"secondary\"\n                        size=\"icon\"\n                        className=\"absolute right-4 top-1/2 -translate-y-1/2\"\n                        onClick={nextImage}\n                        data-testid=\"button-next-image\"\n                      >\n                        <ChevronRight className=\"h-4 w-4\" />\n                      </Button>\n                      <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2\">\n                        {images.map((_, index) => (\n                          <button\n                            key={index}\n                            onClick={() => setCurrentImageIndex(index)}\n                            className={`w-2 h-2 rounded-full transition-colors ${\n                              index === currentImageIndex\n                                ? \"bg-white\"\n                                : \"bg-white/50\"\n                            }`}\n                            data-testid={`button-image-dot-${index}`}\n                          />\n                        ))}\n                      </div>\n                    </>\n                  )}\n                </>\n              ) : (\n                <div className=\"w-full h-full flex items-center justify-center\">\n                  <span className=\"text-muted-foreground\">No images available</span>\n                </div>\n              )}\n            </div>\n\n            {images.length > 1 && (\n              <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                {images.map((image, index) => (\n                  <button\n                    key={index}\n                    onClick={() => setCurrentImageIndex(index)}\n                    className={`shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-colors ${\n                      index === currentImageIndex\n                        ? \"border-primary\"\n                        : \"border-transparent\"\n                    }`}\n                    data-testid={`button-thumbnail-${index}`}\n                  >\n                    <img\n                      src={image}\n                      alt={`Thumbnail ${index + 1}`}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  </button>\n                ))}\n              </div>\n            )}\n\n            <div>\n              <div className=\"flex items-start justify-between gap-4 mb-4\">\n                <div>\n                  <Badge className=\"mb-2\">{room.category}</Badge>\n                  <h1 className=\"text-3xl font-serif font-bold\" data-testid=\"text-room-name\">\n                    {room.name}\n                  </h1>\n                </div>\n                {room.averageRating > 0 && (\n                  <div className=\"flex items-center gap-1 shrink-0\">\n                    <Star className=\"h-5 w-5 fill-yellow-400 text-yellow-400\" />\n                    <span className=\"text-lg font-semibold\">\n                      {room.averageRating.toFixed(1)}\n                    </span>\n                    <span className=\"text-sm text-muted-foreground\">\n                      ({reviews.length} reviews)\n                    </span>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex items-center gap-4 text-muted-foreground mb-4\">\n                <div className=\"flex items-center gap-1\">\n                  <Users className=\"h-4 w-4\" />\n                  <span>Up to {room.capacity} guests</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"font-semibold text-foreground\">\n                    Room {room.roomNumber}\n                  </span>\n                </div>\n              </div>\n\n              <p className=\"text-muted-foreground leading-relaxed\" data-testid=\"text-room-description\">\n                {room.description}\n              </p>\n            </div>\n\n            <div>\n              <h2 className=\"text-xl font-semibold mb-4\">Amenities</h2>\n              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n                {amenities.map((amenity) => (\n                  <div\n                    key={amenity}\n                    className=\"flex items-center gap-2 p-3 rounded-lg bg-muted\"\n                    data-testid={`amenity-${amenity}`}\n                  >\n                    <Check className=\"h-4 w-4 text-primary shrink-0\" />\n                    <span className=\"text-sm\">{amenity}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            <Separator />\n\n            <div>\n              <h2 className=\"text-xl font-semibold mb-4\">\n                Reviews ({reviews.length})\n              </h2>\n              {reviews.length > 0 ? (\n                <div className=\"space-y-4\">\n                  {reviews.map((review) => (\n                    <Card key={review._id} data-testid={`review-${review._id}`}>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-start gap-4\">\n                          <Avatar>\n                            <AvatarFallback>\n                              {(review as any).user?.firstName?.[0] || \"U\"}\n                              {(review as any).user?.lastName?.[0] || \"\"}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div>\n                                <p className=\"font-medium\">\n                                  {(review as any).user?.firstName}{\" \"}\n                                  {(review as any).user?.lastName}\n                                </p>\n                                <p className=\"text-xs text-muted-foreground\">\n                                  {format(new Date(review.createdAt), \"MMMM d, yyyy\")}\n                                </p>\n                              </div>\n                              <div className=\"flex items-center gap-1\">\n                                {Array.from({ length: 5 }).map((_, i) => (\n                                  <Star\n                                    key={i}\n                                    className={`h-4 w-4 ${\n                                      i < review.rating\n                                        ? \"fill-yellow-400 text-yellow-400\"\n                                        : \"text-muted\"\n                                    }`}\n                                  />\n                                ))}\n                              </div>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground\">\n                              {review.comment}\n                            </p>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              ) : (\n                <p className=\"text-muted-foreground\">\n                  No reviews yet. Be the first to review this room!\n                </p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"lg:col-span-1\">\n            <Card className=\"sticky top-24\">\n              <CardHeader>\n                <CardTitle className=\"flex items-baseline gap-2\">\n                  <span className=\"text-3xl font-bold\">${room.pricePerNight}</span>\n                  <span className=\"text-muted-foreground font-normal\">/night</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <div>\n                    <label className=\"text-sm font-medium mb-1 block\">Check-in</label>\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <Button\n                          variant=\"outline\"\n                          className=\"w-full justify-start text-left font-normal\"\n                          data-testid=\"button-check-in\"\n                        >\n                          <Calendar className=\"mr-2 h-4 w-4\" />\n                          {checkIn ? format(checkIn, \"MMM d\") : \"Select\"}\n                        </Button>\n                      </PopoverTrigger>\n                      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                        <CalendarComponent\n                          mode=\"single\"\n                          selected={checkIn}\n                          onSelect={setCheckIn}\n                          disabled={(date) => date < new Date()}\n                          initialFocus\n                        />\n                      </PopoverContent>\n                    </Popover>\n                  </div>\n                  <div>\n                    <label className=\"text-sm font-medium mb-1 block\">Check-out</label>\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <Button\n                          variant=\"outline\"\n                          className=\"w-full justify-start text-left font-normal\"\n                          data-testid=\"button-check-out\"\n                        >\n                          <Calendar className=\"mr-2 h-4 w-4\" />\n                          {checkOut ? format(checkOut, \"MMM d\") : \"Select\"}\n                        </Button>\n                      </PopoverTrigger>\n                      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                        <CalendarComponent\n                          mode=\"single\"\n                          selected={checkOut}\n                          onSelect={setCheckOut}\n                          disabled={(date) =>\n                            date < (checkIn ? addDays(checkIn, 1) : new Date())\n                          }\n                          initialFocus\n                        />\n                      </PopoverContent>\n                    </Popover>\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"text-sm font-medium mb-1 block\">Guests</label>\n                  <div className=\"flex items-center justify-between p-3 border rounded-md\">\n                    <span>{guests} guest{guests > 1 ? \"s\" : \"\"}</span>\n                    <div className=\"flex items-center gap-2\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"icon\"\n                        onClick={() => setGuests(Math.max(1, guests - 1))}\n                        disabled={guests <= 1}\n                        data-testid=\"button-decrease-guests\"\n                      >\n                        <Minus className=\"h-4 w-4\" />\n                      </Button>\n                      <span className=\"w-8 text-center\">{guests}</span>\n                      <Button\n                        variant=\"outline\"\n                        size=\"icon\"\n                        onClick={() => setGuests(Math.min(room.capacity, guests + 1))}\n                        disabled={guests >= room.capacity}\n                        data-testid=\"button-increase-guests\"\n                      >\n                        <Plus className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n\n                {nights > 0 && (\n                  <div className=\"space-y-2 pt-4 border-t\">\n                    <div className=\"flex justify-between text-sm\">\n                      <span>\n                        ${room.pricePerNight} x {nights} night{nights > 1 ? \"s\" : \"\"}\n                      </span>\n                      <span>${totalPrice}</span>\n                    </div>\n                    <Separator />\n                    <div className=\"flex justify-between font-semibold\">\n                      <span>Total</span>\n                      <span>${totalPrice}</span>\n                    </div>\n                  </div>\n                )}\n\n                <Button\n                  className=\"w-full\"\n                  size=\"lg\"\n                  disabled={!checkIn || !checkOut || nights < 1}\n                  onClick={handleBookNow}\n                  data-testid=\"button-book-now\"\n                >\n                  {isAuthenticated ? \"Book Now\" : \"Sign in to Book\"}\n                </Button>\n\n                {!isAuthenticated && (\n                  <p className=\"text-xs text-center text-muted-foreground\">\n                    You need to be signed in to make a booking.\n                  </p>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":17567,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"server/routes/manager.ts":{"content":"import { Router, Response } from 'express';\nimport { Booking, Room } from '../db/models';\nimport { authenticate, requireRole, AuthRequest } from '../middleware/auth';\n\nconst router = Router();\n\nrouter.use(authenticate);\nrouter.use(requireRole('manager', 'admin'));\n\nrouter.get('/stats', async (req: AuthRequest, res: Response) => {\n  try {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n\n    const [todayCheckIns, todayCheckOuts, currentGuests, pendingBookings] = await Promise.all([\n      Booking.countDocuments({\n        checkInDate: { $gte: today, $lt: tomorrow },\n        status: { $in: ['pending', 'confirmed'] },\n      }),\n      Booking.countDocuments({\n        checkOutDate: { $gte: today, $lt: tomorrow },\n        status: 'checked_in',\n      }),\n      Booking.countDocuments({ status: 'checked_in' }),\n      Booking.countDocuments({ status: 'pending' }),\n    ]);\n\n    res.json({\n      todayCheckIns,\n      todayCheckOuts,\n      currentGuests,\n      pendingBookings,\n    });\n  } catch (error) {\n    console.error('Error fetching manager stats:', error);\n    res.status(500).json({ message: 'Failed to fetch stats' });\n  }\n});\n\nrouter.get('/bookings', async (req: AuthRequest, res: Response) => {\n  try {\n    const bookings = await Booking.find()\n      .populate('userId', 'firstName lastName email phone')\n      .populate('roomId', 'name roomNumber category images')\n      .sort({ checkInDate: 1 });\n\n    const bookingsWithDetails = bookings.map((booking) => ({\n      ...booking.toJSON(),\n      user: booking.userId,\n      room: booking.roomId,\n    }));\n\n    res.json(bookingsWithDetails);\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    res.status(500).json({ message: 'Failed to fetch bookings' });\n  }\n});\n\nrouter.get('/bookings/today', async (req: AuthRequest, res: Response) => {\n  try {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const tomorrow = new Date(today);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n\n    const bookings = await Booking.find({\n      $or: [\n        {\n          checkInDate: { $gte: today, $lt: tomorrow },\n          status: { $in: ['pending', 'confirmed'] },\n        },\n        {\n          checkOutDate: { $gte: today, $lt: tomorrow },\n          status: 'checked_in',\n        },\n      ],\n    })\n      .populate('userId', 'firstName lastName email phone')\n      .populate('roomId', 'name roomNumber category images')\n      .sort({ checkInDate: 1 });\n\n    const bookingsWithDetails = bookings.map((booking) => ({\n      ...booking.toJSON(),\n      user: booking.userId,\n      room: booking.roomId,\n    }));\n\n    res.json(bookingsWithDetails);\n  } catch (error) {\n    console.error('Error fetching today bookings:', error);\n    res.status(500).json({ message: 'Failed to fetch bookings' });\n  }\n});\n\nrouter.patch('/bookings/:id/status', async (req: AuthRequest, res: Response) => {\n  try {\n    const { status } = req.body;\n    \n    if (!['checked_in', 'checked_out'].includes(status)) {\n      return res.status(400).json({ message: 'Managers can only check-in or check-out guests' });\n    }\n\n    const booking = await Booking.findById(req.params.id);\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    if (status === 'checked_in') {\n      if (!['pending', 'confirmed'].includes(booking.status)) {\n        return res.status(400).json({ message: 'Can only check-in pending or confirmed bookings' });\n      }\n    }\n\n    if (status === 'checked_out') {\n      if (booking.status !== 'checked_in') {\n        return res.status(400).json({ message: 'Can only check-out checked-in guests' });\n      }\n    }\n\n    booking.status = status;\n    await booking.save();\n\n    res.json(booking.toJSON());\n  } catch (error) {\n    console.error('Error updating booking status:', error);\n    res.status(500).json({ message: 'Failed to update status' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":3999,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/pages/auth/Register.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Hotel, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth\";\nimport { api } from \"@/lib/api\";\nimport { registerUserSchema, type RegisterUser, type AuthResponse } from \"@shared/schema\";\n\nexport default function Register() {\n  const [, setLocation] = useLocation();\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<RegisterUser>({\n    resolver: zodResolver(registerUserSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      role: \"customer\",\n    },\n  });\n\n  const onSubmit = async (data: RegisterUser) => {\n    setIsLoading(true);\n    try {\n      const { confirmPassword, ...registerData } = data;\n      const response = await api.post<AuthResponse>(\"/auth/register\", registerData);\n      login(response.token, response.user);\n      toast({\n        title: \"Welcome to Grand Horizon!\",\n        description: \"Your account has been created successfully.\",\n      });\n      setLocation(\"/\");\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to create account.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <Link href=\"/\" className=\"flex items-center justify-center gap-2 mb-4\">\n            <Hotel className=\"h-8 w-8 text-primary\" />\n            <span className=\"font-serif text-xl font-semibold\">Grand Horizon</span>\n          </Link>\n          <CardTitle className=\"text-2xl\">Create an account</CardTitle>\n          <CardDescription>\n            Join us for an unforgettable experience\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"firstName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>First Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"John\"\n                          {...field}\n                          data-testid=\"input-first-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"lastName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Last Name</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Doe\"\n                          {...field}\n                          data-testid=\"input-last-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"you@example.com\"\n                        {...field}\n                        data-testid=\"input-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"phone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Phone (optional)</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"tel\"\n                        placeholder=\"+1 (555) 123-4567\"\n                        {...field}\n                        data-testid=\"input-phone\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Create a password\"\n                        {...field}\n                        data-testid=\"input-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Confirm Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Confirm your password\"\n                        {...field}\n                        data-testid=\"input-confirm-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={isLoading}\n                data-testid=\"button-register\"\n              >\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                Create Account\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center text-sm\">\n            <span className=\"text-muted-foreground\">Already have an account? </span>\n            <Link\n              href=\"/login\"\n              className=\"text-primary hover:underline font-medium\"\n              data-testid=\"link-login\"\n            >\n              Sign in\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":7213,"size_tokens":null},"README.md":{"content":"# Grand Horizon Hotel Booking System\n\nA full-featured hotel booking system built with the MERN stack (MongoDB, Express, React, Node.js) featuring role-based access control, room management, booking workflows, Stripe payments, promo codes, and email notifications.\n\n## Features\n\n### For Customers\n- Browse available rooms with filters (category, price range, capacity)\n- View detailed room information with images, amenities, and reviews\n- Book rooms with date selection and guest count\n- Apply promo codes for discounts during checkout\n- Secure payment processing via Stripe\n- View booking history and status\n- Leave reviews for completed stays\n- Email confirmations for bookings\n\n### For Managers\n- Dashboard with real-time statistics\n- View and manage all bookings\n- Update booking statuses (pending, confirmed, checked_in, checked_out, cancelled)\n- Today's check-ins and check-outs view\n- Access booking analytics\n\n### For Administrators\n- Full room management (create, edit, delete rooms with images)\n- Room statistics by category (total, available, occupied)\n- Promo code management (create, edit, toggle, delete)\n- User management across all roles\n- System-wide analytics and reporting\n- Manage all bookings and reviews\n\n## Tech Stack\n\n- **Frontend:** React 18, TypeScript, TailwindCSS, Shadcn/UI, TanStack Query, Wouter\n- **Backend:** Node.js, Express, TypeScript\n- **Database:** MongoDB Atlas with Mongoose ODM\n- **Authentication:** JWT tokens with bcrypt password hashing\n- **Payments:** Stripe integration (test mode)\n- **Email:** Nodemailer with Gmail SMTP\n\n## Room Categories\n\n| Category | Description |\n|----------|-------------|\n| Standard | Budget-friendly options for comfortable stays |\n| Deluxe | Enhanced comfort with premium amenities |\n| Suite | Spacious accommodations with separate living areas |\n| Executive | Business-focused with lounge access |\n| Family | Designed for families with kids' amenities |\n| Presidential | Luxury suites with butler service |\n| Penthouse | Top-floor premium accommodations |\n\n## Booking Statuses\n\n| Status | Description |\n|--------|-------------|\n| `pending` | Booking created, awaiting payment |\n| `confirmed` | Payment received, reservation confirmed |\n| `checked_in` | Guest has arrived and checked in |\n| `checked_out` | Stay completed |\n| `cancelled` | Booking cancelled |\n\n## Promo Code System\n\nThe system supports flexible promo codes with:\n- **Discount Types:** Percentage (%) or Fixed amount ($)\n- **Usage Limits:** Optional maximum usage count\n- **Date Ranges:** Valid from/to dates\n- **Minimum Spend:** Optional minimum booking amount requirement\n- **Max Discount Cap:** Optional maximum discount limit for percentage codes\n\n---\n\n## Getting Started\n\n### Prerequisites\n\n- **Node.js 18 or higher** - Download from [nodejs.org](https://nodejs.org/)\n- **Git** - Download from [git-scm.com](https://git-scm.com/download/win)\n- **MongoDB Atlas account** (free tier available) - Sign up at [mongodb.com/atlas](https://www.mongodb.com/atlas)\n- **Gmail account** for SMTP email notifications (or other SMTP provider)\n- **Stripe account** for payment processing (optional) - Sign up at [stripe.com](https://stripe.com)\n\n---\n\n## Running Locally on Windows\n\n### Step 1: Install Prerequisites\n\n1. **Install Node.js:**\n   - Download the Windows installer from [nodejs.org](https://nodejs.org/) (LTS version recommended)\n   - Run the installer and follow the prompts\n   - Verify installation by opening Command Prompt or PowerShell:\n     ```cmd\n     node --version\n     npm --version\n     ```\n\n2. **Install Git:**\n   - Download from [git-scm.com](https://git-scm.com/download/win)\n   - Run the installer (default options are fine)\n   - Verify installation:\n     ```cmd\n     git --version\n     ```\n\n### Step 2: Set Up MongoDB Atlas (Free Cloud Database)\n\n1. Go to [mongodb.com/atlas](https://www.mongodb.com/atlas) and create a free account\n2. Create a new cluster (free tier M0 is sufficient)\n3. Click **\"Connect\"** on your cluster\n4. Choose **\"Connect your application\"**\n5. Copy the connection string (looks like: `mongodb+srv://username:<password>@cluster0.xxxxx.mongodb.net/`)\n6. Replace `<password>` with your actual database user password\n7. Add `/hotel` before the `?` to specify the database name:\n   ```\n   mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/hotel?retryWrites=true&w=majority\n   ```\n\n**Important:** In MongoDB Atlas, go to **Network Access** and either:\n- Add your current IP address, OR\n- Add `0.0.0.0/0` to allow access from anywhere (for development)\n\n### Step 3: Set Up Gmail for Email Notifications\n\n1. Go to your [Google Account Security Settings](https://myaccount.google.com/security)\n2. Enable **2-Step Verification** if not already enabled\n3. Go to **App passwords** (under 2-Step Verification)\n4. Select **Mail** and **Windows Computer**\n5. Click **Generate** and copy the 16-character password\n6. Use this password as your `SMTP_PASS` (not your regular Gmail password)\n\n### Step 4: Clone and Set Up the Project\n\nOpen Command Prompt or PowerShell and run:\n\n```cmd\n# Clone the repository\ngit clone <repository-url>\ncd grand-horizon-hotel\n\n# Install dependencies\nnpm install\n\n# Create environment file\ncopy .env.example .env\n```\n\n### Step 5: Configure Environment Variables\n\nOpen the `.env` file in a text editor (Notepad, VS Code, etc.) and fill in your values:\n\n```env\n# Database (Required)\nMONGODB_URI=mongodb+srv://your-username:your-password@cluster0.xxxxx.mongodb.net/hotel?retryWrites=true&w=majority\n\n# Session Secret (Required) - Any random string 32+ characters\nSESSION_SECRET=your-super-secret-key-at-least-32-characters-long\n\n# Email Configuration (Required for booking confirmations)\nSMTP_HOST=smtp.gmail.com\nSMTP_PORT=587\nSMTP_USER=your-email@gmail.com\nSMTP_PASS=your-16-char-app-password\n\n# Stripe (Optional - for payments)\nSTRIPE_SECRET_KEY=sk_test_your_stripe_secret_key\nVITE_STRIPE_PUBLIC_KEY=pk_test_your_stripe_public_key\n```\n\n### Step 6: Run the Application\n\n**Option A: Using PowerShell (Recommended)**\n```powershell\n$env:NODE_ENV=\"development\"; npx tsx server/index.ts\n```\n\n**Option B: Using Command Prompt (cmd)**\n```cmd\nset NODE_ENV=development && npx tsx server/index.ts\n```\n\n**Option C: Create a batch file**\n\nCreate a file named `start-dev.bat` in the project root with:\n```batch\n@echo off\nset NODE_ENV=development\nnpx tsx server/index.ts\n```\nThen double-click the file or run `start-dev.bat` from Command Prompt.\n\nThe application will start and be available at: **http://localhost:5000**\n\n### Step 7: Seed Sample Data (Optional)\n\nTo populate the database with sample rooms, users, and bookings:\n\n```cmd\nnpx tsx server/scripts/seed.ts\n```\n\nThis creates:\n- 11 sample rooms across all categories\n- 3 test user accounts (admin, manager, customer)\n- 5 sample customer accounts with booking history\n- Sample bookings with various statuses\n- Sample reviews for rooms\n\n---\n\n## Environment Variables Reference\n\n### Required Variables\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `MONGODB_URI` | MongoDB connection string | `mongodb+srv://user:pass@cluster.mongodb.net/hotel?retryWrites=true&w=majority` |\n| `SESSION_SECRET` | Secret key for session encryption (min 32 chars) | `my-super-secret-session-key-here` |\n\n### Email Configuration\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `SMTP_HOST` | SMTP server hostname | `smtp.gmail.com` |\n| `SMTP_PORT` | SMTP server port | `587` |\n| `SMTP_USER` | SMTP username/email | `your-email@gmail.com` |\n| `SMTP_PASS` | SMTP password or app password | `your-app-password` |\n\n### Payment Configuration (Optional)\n\n| Variable | Description | Example |\n|----------|-------------|---------|\n| `STRIPE_SECRET_KEY` | Stripe API secret key | `sk_test_...` |\n| `VITE_STRIPE_PUBLIC_KEY` | Stripe publishable key (frontend) | `pk_test_...` |\n\n---\n\n## Test Accounts\n\nUse these accounts to test the application:\n\n**Password for all accounts:** `Test@123`\n\n| Role | Email | Access Level |\n|------|-------|--------------|\n| Admin | `admin@grandhorizon.com` | Full system access, room management, promo codes, user management |\n| Manager | `manager@grandhorizon.com` | Booking management, status updates, dashboard |\n| Customer | `guest@grandhorizon.com` | Room browsing, booking, reviews |\n\n---\n\n## API Endpoints\n\n### Authentication\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/auth/register` | Register new user |\n| POST | `/api/auth/login` | User login |\n| GET | `/api/auth/me` | Get current user |\n\n### Rooms\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/rooms` | List all rooms with reviews |\n| GET | `/api/rooms/:id` | Get room details |\n| POST | `/api/admin/rooms` | Create room (admin) |\n| PUT | `/api/admin/rooms/:id` | Update room (admin) |\n| DELETE | `/api/admin/rooms/:id` | Delete room (admin) |\n\n### Bookings\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/bookings/my` | Get user's bookings |\n| POST | `/api/bookings` | Create booking |\n| POST | `/api/bookings/validate-promo` | Validate promo code |\n| POST | `/api/bookings/:id/confirm-payment` | Confirm payment |\n| PATCH | `/api/bookings/:id/cancel` | Cancel booking |\n\n### Manager Routes\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/manager/bookings` | All bookings |\n| GET | `/api/manager/bookings/today` | Today's check-ins |\n| GET | `/api/manager/stats` | Dashboard statistics |\n| PATCH | `/api/manager/bookings/:id/status` | Update booking status |\n\n### Admin Routes\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| GET | `/api/admin/stats` | Room statistics |\n| GET | `/api/admin/promo-codes` | List promo codes |\n| POST | `/api/admin/promo-codes` | Create promo code |\n| PUT | `/api/admin/promo-codes/:id` | Update promo code |\n| DELETE | `/api/admin/promo-codes/:id` | Delete promo code |\n| PATCH | `/api/admin/promo-codes/:id/toggle` | Toggle promo code active status |\n\n### Reviews\n| Method | Endpoint | Description |\n|--------|----------|-------------|\n| POST | `/api/reviews` | Create review (after checkout) |\n\n---\n\n## Project Structure\n\n```\ngrand-horizon-hotel/\n client/                     # React frontend\n    src/\n       components/         # Reusable UI components\n          ui/             # Shadcn UI components\n       pages/              # Page components\n          admin/          # Admin dashboard pages\n          manager/        # Manager dashboard pages\n          auth/           # Login/Register pages\n       lib/                # Utilities (auth, api, query client)\n       hooks/              # Custom React hooks\n    index.html\n server/                     # Express backend\n    db/\n       models/             # Mongoose models (User, Room, Booking, Review, PromoCode)\n       connection.ts       # MongoDB connection\n    routes/                 # API route handlers\n       auth.ts             # Authentication routes\n       rooms.ts            # Room routes\n       bookings.ts         # Booking routes\n       manager.ts          # Manager routes\n       admin.ts            # Admin routes\n       reviews.ts          # Review routes\n    middleware/             # Express middleware (auth)\n    services/               # Business logic (email service)\n    scripts/                # Utility scripts (seed)\n    index.ts                # Server entry point\n shared/                     # Shared types and schemas\n    schema.ts               # Zod schemas and types\n uploads/                    # Uploaded room images\n .env.example                # Example environment variables\n package.json\n tsconfig.json\n tailwind.config.ts\n vite.config.ts\n README.md\n```\n\n---\n\n## Deployment\n\n### On Replit\n\n1. Click the \"Deploy\" button in the Replit interface\n2. Configure environment secrets in the Secrets tab\n3. The application will be automatically deployed\n\n### Manual Deployment\n\n1. Build the application:\n   ```bash\n   npm run build\n   ```\n\n2. Start the production server:\n   ```bash\n   npm start\n   ```\n\n---\n\n## Troubleshooting\n\n### Common Issues\n\n1. **MongoDB Connection Fails**\n   - Verify your `MONGODB_URI` is correct\n   - Check if your IP is whitelisted in MongoDB Atlas\n   - Ensure the database user has proper permissions\n\n2. **Email Not Sending**\n   - For Gmail, ensure you're using an App Password (not your regular password)\n   - Check if 2-Step Verification is enabled on your Google account\n   - Verify SMTP settings are correct\n\n3. **Stripe Payments Not Working**\n   - Ensure you're using test mode keys (start with `sk_test_` and `pk_test_`)\n   - Check that your Stripe account is properly set up\n\n4. **Images Not Uploading**\n   - Ensure the `uploads/` directory exists and has write permissions\n   - Check file size limits (max 5MB per image)\n\n---\n\n## License\n\nThis project is for demonstration and educational purposes.\n\n---\n\n## Support\n\nFor issues or questions, please open an issue in the repository or contact the development team.\n","path":null,"size_bytes":13475,"size_tokens":null},"client/src/pages/manager/ManagerBookings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport { Search, Filter, UserCheck, UserMinus, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport type { BookingWithDetails, BookingStatus } from \"@shared/schema\";\nimport { bookingStatuses } from \"@shared/schema\";\n\nconst statusColors: Record<BookingStatus, string> = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400\",\n  confirmed: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\",\n  checked_in: \"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400\",\n  checked_out: \"bg-gray-100 text-gray-800 dark:bg-gray-800/50 dark:text-gray-400\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400\",\n};\n\nconst statusLabels: Record<BookingStatus, string> = {\n  pending: \"Pending\",\n  confirmed: \"Confirmed\",\n  checked_in: \"Checked In\",\n  checked_out: \"Checked Out\",\n  cancelled: \"Cancelled\",\n};\n\nexport default function ManagerBookings() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [updatingId, setUpdatingId] = useState<string | null>(null);\n\n  const { data: bookings, isLoading } = useQuery<BookingWithDetails[]>({\n    queryKey: [\"/api/manager/bookings\"],\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: string; status: BookingStatus }) => {\n      return api.patch(`/manager/bookings/${id}/status`, { status });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/manager/bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/manager/stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/manager/bookings/today\"] });\n      toast({ title: \"Booking status updated\" });\n      setUpdatingId(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update status\",\n        variant: \"destructive\",\n      });\n      setUpdatingId(null);\n    },\n  });\n\n  const handleCheckIn = (bookingId: string) => {\n    setUpdatingId(bookingId);\n    updateStatusMutation.mutate({ id: bookingId, status: \"checked_in\" });\n  };\n\n  const handleCheckOut = (bookingId: string) => {\n    setUpdatingId(bookingId);\n    updateStatusMutation.mutate({ id: bookingId, status: \"checked_out\" });\n  };\n\n  const filteredBookings = bookings?.filter((booking) => {\n    if (statusFilter !== \"all\" && booking.status !== statusFilter) {\n      return false;\n    }\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      return (\n        booking.user?.firstName?.toLowerCase().includes(query) ||\n        booking.user?.lastName?.toLowerCase().includes(query) ||\n        booking.user?.email?.toLowerCase().includes(query) ||\n        booking.room?.name?.toLowerCase().includes(query) ||\n        booking.room?.roomNumber?.toLowerCase().includes(query)\n      );\n    }\n    return true;\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-bold\">Bookings</h1>\n        <p className=\"text-muted-foreground\">\n          Manage guest check-ins and check-outs.\n        </p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex flex-col md:flex-row items-start md:items-center gap-4\">\n            <div className=\"relative flex-1 w-full md:w-auto\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search by guest, room, or room number...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search-bookings\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full md:w-48\" data-testid=\"select-status-filter\">\n                <Filter className=\"h-4 w-4 mr-2\" />\n                <SelectValue placeholder=\"Filter by status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                {bookingStatuses.map((status) => (\n                  <SelectItem key={status} value={status}>\n                    {statusLabels[status]}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[...Array(5)].map((_, i) => (\n                <div key={i} className=\"flex items-center gap-4\">\n                  <div className=\"space-y-2 flex-1\">\n                    <Skeleton className=\"h-4 w-1/4\" />\n                    <Skeleton className=\"h-3 w-1/3\" />\n                  </div>\n                  <Skeleton className=\"h-6 w-20\" />\n                  <Skeleton className=\"h-9 w-24\" />\n                </div>\n              ))}\n            </div>\n          ) : filteredBookings && filteredBookings.length > 0 ? (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Guest</TableHead>\n                  <TableHead>Room</TableHead>\n                  <TableHead>Check-in</TableHead>\n                  <TableHead>Check-out</TableHead>\n                  <TableHead>Guests</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead className=\"text-right\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredBookings.map((booking) => (\n                  <TableRow key={booking._id} data-testid={`booking-row-${booking._id}`}>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">\n                          {booking.user?.firstName} {booking.user?.lastName}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {booking.user?.email}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">{booking.room?.name}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Room {booking.room?.roomNumber}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkInDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkOutDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>{booking.guestCount}</TableCell>\n                    <TableCell>\n                      <Badge className={statusColors[booking.status]}>\n                        {statusLabels[booking.status]}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <div className=\"flex items-center justify-end gap-2\">\n                        {(booking.status === \"confirmed\" || booking.status === \"pending\") && (\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleCheckIn(booking._id)}\n                            disabled={updatingId === booking._id}\n                            data-testid={`button-checkin-${booking._id}`}\n                          >\n                            {updatingId === booking._id ? (\n                              <Loader2 className=\"mr-2 h-3 w-3 animate-spin\" />\n                            ) : (\n                              <UserCheck className=\"mr-2 h-3 w-3\" />\n                            )}\n                            Check In\n                          </Button>\n                        )}\n                        {booking.status === \"checked_in\" && (\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleCheckOut(booking._id)}\n                            disabled={updatingId === booking._id}\n                            data-testid={`button-checkout-${booking._id}`}\n                          >\n                            {updatingId === booking._id ? (\n                              <Loader2 className=\"mr-2 h-3 w-3 animate-spin\" />\n                            ) : (\n                              <UserMinus className=\"mr-2 h-3 w-3\" />\n                            )}\n                            Check Out\n                          </Button>\n                        )}\n                      </div>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          ) : (\n            <p className=\"text-center text-muted-foreground py-8\">\n              No bookings found.\n            </p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":9995,"size_tokens":null},"client/src/components/layout/Header.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Menu, X, User, LogOut, LayoutDashboard, Hotel, Calendar } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useAuth } from \"@/lib/auth\";\nimport { ThemeToggle } from \"./ThemeToggle\";\n\nexport function Header() {\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const { user, logout, isAuthenticated, isAdmin, isManager } = useAuth();\n  const [location, setLocation] = useLocation();\n\n  const handleLogout = () => {\n    logout();\n    setLocation(\"/\");\n  };\n\n  const navLinks = [\n    { href: \"/\", label: \"Home\" },\n    { href: \"/rooms\", label: \"Rooms\" },\n  ];\n\n  const getInitials = () => {\n    if (!user) return \"U\";\n    const first = user.firstName?.[0] || \"\";\n    const last = user.lastName?.[0] || \"\";\n    return (first + last).toUpperCase() || \"U\";\n  };\n\n  return (\n    <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex h-16 items-center justify-between gap-4\">\n          <Link href=\"/\" className=\"flex items-center gap-2\">\n            <Hotel className=\"h-8 w-8 text-primary\" />\n            <span className=\"font-serif text-xl font-semibold tracking-tight\">\n              Grand Horizon\n            </span>\n          </Link>\n\n          <nav className=\"hidden md:flex items-center gap-6\">\n            {navLinks.map((link) => (\n              <Link\n                key={link.href}\n                href={link.href}\n                className={`text-sm font-medium transition-colors hover:text-primary ${\n                  location === link.href ? \"text-primary\" : \"text-muted-foreground\"\n                }`}\n              >\n                {link.label}\n              </Link>\n            ))}\n          </nav>\n\n          <div className=\"flex items-center gap-2\">\n            <ThemeToggle />\n            \n            {isAuthenticated ? (\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"ghost\" className=\"relative h-9 w-9 rounded-full\" data-testid=\"button-user-menu\">\n                    <Avatar className=\"h-9 w-9\">\n                      <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                        {getInitials()}\n                      </AvatarFallback>\n                    </Avatar>\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n                  <div className=\"flex items-center justify-start gap-2 p-2\">\n                    <div className=\"flex flex-col space-y-1 leading-none\">\n                      <p className=\"font-medium\" data-testid=\"text-user-name\">\n                        {user?.firstName} {user?.lastName}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\" data-testid=\"text-user-email\">\n                        {user?.email}\n                      </p>\n                    </div>\n                  </div>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem asChild>\n                    <Link href=\"/dashboard\" className=\"w-full cursor-pointer\" data-testid=\"link-dashboard\">\n                      <Calendar className=\"mr-2 h-4 w-4\" />\n                      My Bookings\n                    </Link>\n                  </DropdownMenuItem>\n                  {(isAdmin || isManager) && (\n                    <>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem asChild>\n                        <Link \n                          href={isAdmin ? \"/admin\" : \"/manager\"} \n                          className=\"w-full cursor-pointer\"\n                          data-testid=\"link-admin-panel\"\n                        >\n                          <LayoutDashboard className=\"mr-2 h-4 w-4\" />\n                          {isAdmin ? \"Admin Panel\" : \"Manager Panel\"}\n                        </Link>\n                      </DropdownMenuItem>\n                    </>\n                  )}\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem \n                    onClick={handleLogout} \n                    className=\"cursor-pointer text-destructive\"\n                    data-testid=\"button-logout\"\n                  >\n                    <LogOut className=\"mr-2 h-4 w-4\" />\n                    Log out\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            ) : (\n              <div className=\"hidden md:flex items-center gap-2\">\n                <Button variant=\"ghost\" asChild>\n                  <Link href=\"/login\" data-testid=\"link-login\">Sign In</Link>\n                </Button>\n                <Button asChild>\n                  <Link href=\"/register\" data-testid=\"link-register\">Get Started</Link>\n                </Button>\n              </div>\n            )}\n\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"md:hidden\"\n              onClick={() => setIsMenuOpen(!isMenuOpen)}\n              data-testid=\"button-mobile-menu\"\n            >\n              {isMenuOpen ? <X className=\"h-5 w-5\" /> : <Menu className=\"h-5 w-5\" />}\n            </Button>\n          </div>\n        </div>\n\n        {isMenuOpen && (\n          <div className=\"md:hidden border-t py-4\">\n            <nav className=\"flex flex-col gap-2\">\n              {navLinks.map((link) => (\n                <Link\n                  key={link.href}\n                  href={link.href}\n                  onClick={() => setIsMenuOpen(false)}\n                  className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                    location === link.href\n                      ? \"bg-primary/10 text-primary\"\n                      : \"text-muted-foreground hover:bg-muted\"\n                  }`}\n                >\n                  {link.label}\n                </Link>\n              ))}\n              {!isAuthenticated && (\n                <>\n                  <Link\n                    href=\"/login\"\n                    onClick={() => setIsMenuOpen(false)}\n                    className=\"px-4 py-2 text-sm font-medium text-muted-foreground hover:bg-muted rounded-md\"\n                  >\n                    Sign In\n                  </Link>\n                  <Link\n                    href=\"/register\"\n                    onClick={() => setIsMenuOpen(false)}\n                    className=\"px-4 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-md text-center\"\n                  >\n                    Get Started\n                  </Link>\n                </>\n              )}\n            </nav>\n          </div>\n        )}\n      </div>\n    </header>\n  );\n}\n","path":null,"size_bytes":7074,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"server/db/models/Booking.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\n\nexport interface IBooking extends Document {\n  _id: mongoose.Types.ObjectId;\n  userId: mongoose.Types.ObjectId;\n  roomId: mongoose.Types.ObjectId;\n  checkInDate: Date;\n  checkOutDate: Date;\n  totalPrice: number;\n  discountAmount: number;\n  finalPrice: number;\n  promoCode?: string;\n  status: 'pending' | 'confirmed' | 'checked_in' | 'checked_out' | 'cancelled';\n  guestCount: number;\n  specialRequests?: string;\n  paymentIntentId?: string;\n  paymentStatus: 'pending' | 'paid' | 'refunded';\n  createdAt: Date;\n}\n\nconst bookingSchema = new Schema<IBooking>({\n  userId: {\n    type: Schema.Types.ObjectId,\n    ref: 'User',\n    required: true,\n  },\n  roomId: {\n    type: Schema.Types.ObjectId,\n    ref: 'Room',\n    required: true,\n  },\n  checkInDate: {\n    type: Date,\n    required: true,\n  },\n  checkOutDate: {\n    type: Date,\n    required: true,\n  },\n  totalPrice: {\n    type: Number,\n    required: true,\n    min: 0,\n  },\n  discountAmount: {\n    type: Number,\n    default: 0,\n    min: 0,\n  },\n  finalPrice: {\n    type: Number,\n    min: 0,\n  },\n  promoCode: {\n    type: String,\n  },\n  status: {\n    type: String,\n    enum: ['pending', 'confirmed', 'checked_in', 'checked_out', 'cancelled'],\n    default: 'pending',\n  },\n  guestCount: {\n    type: Number,\n    required: true,\n    min: 1,\n  },\n  specialRequests: {\n    type: String,\n  },\n  paymentIntentId: {\n    type: String,\n  },\n  paymentStatus: {\n    type: String,\n    enum: ['pending', 'paid', 'refunded'],\n    default: 'pending',\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\nbookingSchema.index({ userId: 1 });\nbookingSchema.index({ roomId: 1 });\nbookingSchema.index({ checkInDate: 1, checkOutDate: 1 });\n\n// Pre-save hook to set finalPrice to totalPrice if not set\nbookingSchema.pre('save', function() {\n  if (this.finalPrice === undefined || this.finalPrice === null) {\n    this.finalPrice = this.totalPrice - (this.discountAmount || 0);\n  }\n});\n\nbookingSchema.set('toJSON', {\n  transform: function (doc, ret) {\n    ret._id = ret._id.toString();\n    if (ret.userId) ret.userId = ret.userId.toString();\n    if (ret.roomId) ret.roomId = ret.roomId.toString();\n    delete ret.__v;\n    return ret;\n  },\n});\n\nexport const Booking = mongoose.model<IBooking>('Booking', bookingSchema);\n","path":null,"size_bytes":2310,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/components/layout/Footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { Hotel, Mail, Phone, MapPin } from \"lucide-react\";\n\nexport function Footer() {\n  return (\n    <footer className=\"bg-card border-t\">\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n          <div className=\"space-y-4\">\n            <Link href=\"/\" className=\"flex items-center gap-2\">\n              <Hotel className=\"h-8 w-8 text-primary\" />\n              <span className=\"font-serif text-xl font-semibold\">Grand Horizon</span>\n            </Link>\n            <p className=\"text-sm text-muted-foreground\">\n              Experience luxury and comfort at Grand Horizon Hotel. \n              Your perfect getaway awaits with stunning views and world-class amenities.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"font-semibold mb-4\">Quick Links</h3>\n            <ul className=\"space-y-2\">\n              <li>\n                <Link href=\"/rooms\" className=\"text-sm text-muted-foreground hover:text-primary transition-colors\">\n                  Our Rooms\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/dashboard\" className=\"text-sm text-muted-foreground hover:text-primary transition-colors\">\n                  My Bookings\n                </Link>\n              </li>\n            </ul>\n          </div>\n\n          <div>\n            <h3 className=\"font-semibold mb-4\">Contact Info</h3>\n            <ul className=\"space-y-3\">\n              <li className=\"flex items-start gap-2 text-sm text-muted-foreground\">\n                <MapPin className=\"h-4 w-4 mt-0.5 shrink-0\" />\n                <span>123 Ocean Drive, Paradise Bay, CA 90210</span>\n              </li>\n              <li className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <Phone className=\"h-4 w-4 shrink-0\" />\n                <span>+1 (555) 123-4567</span>\n              </li>\n              <li className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <Mail className=\"h-4 w-4 shrink-0\" />\n                <span>info@grandhorizon.com</span>\n              </li>\n            </ul>\n          </div>\n\n          <div>\n            <h3 className=\"font-semibold mb-4\">Hours</h3>\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\n              <li>Check-in: 3:00 PM</li>\n              <li>Check-out: 11:00 AM</li>\n              <li>Reception: 24/7</li>\n              <li>Restaurant: 7:00 AM - 10:00 PM</li>\n            </ul>\n          </div>\n        </div>\n\n        <div className=\"mt-12 pt-8 border-t text-center text-sm text-muted-foreground\">\n          <p>&copy; {new Date().getFullYear()} Grand Horizon Hotel. All rights reserved.</p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","path":null,"size_bytes":2804,"size_tokens":null},"client/src/lib/auth.tsx":{"content":"import { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\nimport type { User } from \"@shared/schema\";\n\ninterface AuthContextType {\n  user: Omit<User, \"password\"> | null;\n  token: string | null;\n  login: (token: string, user: Omit<User, \"password\">) => void;\n  logout: () => void;\n  isAuthenticated: boolean;\n  isAdmin: boolean;\n  isManager: boolean;\n  isLoading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<Omit<User, \"password\"> | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem(\"token\");\n    const storedUser = localStorage.getItem(\"user\");\n    \n    if (storedToken && storedUser) {\n      try {\n        setToken(storedToken);\n        setUser(JSON.parse(storedUser));\n      } catch (e) {\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"user\");\n      }\n    }\n    setIsLoading(false);\n  }, []);\n\n  const login = (newToken: string, newUser: Omit<User, \"password\">) => {\n    localStorage.setItem(\"token\", newToken);\n    localStorage.setItem(\"user\", JSON.stringify(newUser));\n    setToken(newToken);\n    setUser(newUser);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    setToken(null);\n    setUser(null);\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        token,\n        login,\n        logout,\n        isAuthenticated: !!token && !!user,\n        isAdmin: user?.role === \"admin\",\n        isManager: user?.role === \"manager\",\n        isLoading,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":2035,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/pages/admin/AdminBookings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format } from \"date-fns\";\nimport { Search, Filter, Eye } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { api } from \"@/lib/api\";\nimport type { BookingWithDetails, BookingStatus } from \"@shared/schema\";\nimport { bookingStatuses } from \"@shared/schema\";\n\nconst statusColors: Record<BookingStatus, string> = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400\",\n  confirmed: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\",\n  checked_in: \"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400\",\n  checked_out: \"bg-gray-100 text-gray-800 dark:bg-gray-800/50 dark:text-gray-400\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400\",\n};\n\nconst statusLabels: Record<BookingStatus, string> = {\n  pending: \"Pending\",\n  confirmed: \"Confirmed\",\n  checked_in: \"Checked In\",\n  checked_out: \"Checked Out\",\n  cancelled: \"Cancelled\",\n};\n\nexport default function AdminBookings() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [selectedBooking, setSelectedBooking] = useState<BookingWithDetails | null>(null);\n\n  const { data: bookings, isLoading } = useQuery<BookingWithDetails[]>({\n    queryKey: [\"/api/admin/bookings\"],\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ id, status }: { id: string; status: BookingStatus }) => {\n      return api.patch(`/admin/bookings/${id}/status`, { status });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/bookings\"] });\n      toast({ title: \"Booking status updated\" });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update status\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const filteredBookings = bookings?.filter((booking) => {\n    if (statusFilter !== \"all\" && booking.status !== statusFilter) {\n      return false;\n    }\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      return (\n        booking.user?.firstName?.toLowerCase().includes(query) ||\n        booking.user?.lastName?.toLowerCase().includes(query) ||\n        booking.user?.email?.toLowerCase().includes(query) ||\n        booking.room?.name?.toLowerCase().includes(query)\n      );\n    }\n    return true;\n  });\n\n  return (\n    <div className=\"p-6 space-y-6\">\n      <div>\n        <h1 className=\"text-2xl font-bold\">Bookings</h1>\n        <p className=\"text-muted-foreground\">View and manage all bookings.</p>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <div className=\"flex flex-col md:flex-row items-start md:items-center gap-4\">\n            <div className=\"relative flex-1 w-full md:w-auto\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n              <Input\n                placeholder=\"Search by guest or room...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10\"\n                data-testid=\"input-search-bookings\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full md:w-48\" data-testid=\"select-status-filter\">\n                <Filter className=\"h-4 w-4 mr-2\" />\n                <SelectValue placeholder=\"Filter by status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                {bookingStatuses.map((status) => (\n                  <SelectItem key={status} value={status}>\n                    {statusLabels[status]}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {isLoading ? (\n            <div className=\"space-y-4\">\n              {[...Array(5)].map((_, i) => (\n                <div key={i} className=\"flex items-center gap-4\">\n                  <Skeleton className=\"h-12 w-12 rounded\" />\n                  <div className=\"space-y-2 flex-1\">\n                    <Skeleton className=\"h-4 w-1/4\" />\n                    <Skeleton className=\"h-3 w-1/3\" />\n                  </div>\n                  <Skeleton className=\"h-6 w-20\" />\n                </div>\n              ))}\n            </div>\n          ) : filteredBookings && filteredBookings.length > 0 ? (\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Guest</TableHead>\n                  <TableHead>Room</TableHead>\n                  <TableHead>Check-in</TableHead>\n                  <TableHead>Check-out</TableHead>\n                  <TableHead>Guests</TableHead>\n                  <TableHead>Total</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead className=\"text-right\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredBookings.map((booking) => (\n                  <TableRow key={booking._id} data-testid={`booking-row-${booking._id}`}>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">\n                          {booking.user?.firstName} {booking.user?.lastName}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {booking.user?.email}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">{booking.room?.name}</p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          Room {booking.room?.roomNumber}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkInDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>\n                      {format(new Date(booking.checkOutDate), \"MMM d, yyyy\")}\n                    </TableCell>\n                    <TableCell>{booking.guestCount}</TableCell>\n                    <TableCell>${booking.totalPrice}</TableCell>\n                    <TableCell>\n                      <Badge className={statusColors[booking.status]}>\n                        {statusLabels[booking.status]}\n                      </Badge>\n                    </TableCell>\n                    <TableCell className=\"text-right\">\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => setSelectedBooking(booking)}\n                        data-testid={`button-view-${booking._id}`}\n                      >\n                        <Eye className=\"h-4 w-4\" />\n                      </Button>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          ) : (\n            <p className=\"text-center text-muted-foreground py-8\">\n              No bookings found.\n            </p>\n          )}\n        </CardContent>\n      </Card>\n\n      <Dialog open={!!selectedBooking} onOpenChange={() => setSelectedBooking(null)}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle>Booking Details</DialogTitle>\n          </DialogHeader>\n          {selectedBooking && (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-4\">\n                {selectedBooking.room?.images?.[0] && (\n                  <img\n                    src={selectedBooking.room.images[0]}\n                    alt={selectedBooking.room.name}\n                    className=\"w-20 h-20 object-cover rounded-lg\"\n                  />\n                )}\n                <div>\n                  <h3 className=\"font-semibold\">{selectedBooking.room?.name}</h3>\n                  <p className=\"text-sm text-muted-foreground\">\n                    Room {selectedBooking.room?.roomNumber}\n                  </p>\n                </div>\n              </div>\n\n              <Separator />\n\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <p className=\"text-muted-foreground\">Guest</p>\n                  <p className=\"font-medium\">\n                    {selectedBooking.user?.firstName} {selectedBooking.user?.lastName}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    {selectedBooking.user?.email}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">Guests</p>\n                  <p className=\"font-medium\">{selectedBooking.guestCount}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">Check-in</p>\n                  <p className=\"font-medium\">\n                    {format(new Date(selectedBooking.checkInDate), \"EEE, MMM d, yyyy\")}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">Check-out</p>\n                  <p className=\"font-medium\">\n                    {format(new Date(selectedBooking.checkOutDate), \"EEE, MMM d, yyyy\")}\n                  </p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">Total</p>\n                  <p className=\"font-medium\">${selectedBooking.totalPrice}</p>\n                </div>\n                <div>\n                  <p className=\"text-muted-foreground\">Payment</p>\n                  <Badge\n                    variant={\n                      selectedBooking.paymentStatus === \"paid\"\n                        ? \"default\"\n                        : \"secondary\"\n                    }\n                  >\n                    {selectedBooking.paymentStatus}\n                  </Badge>\n                </div>\n              </div>\n\n              {selectedBooking.specialRequests && (\n                <>\n                  <Separator />\n                  <div>\n                    <p className=\"text-sm text-muted-foreground mb-1\">Special Requests</p>\n                    <p className=\"text-sm\">{selectedBooking.specialRequests}</p>\n                  </div>\n                </>\n              )}\n\n              <Separator />\n\n              <div>\n                <p className=\"text-sm font-medium mb-2\">Update Status</p>\n                <Select\n                  value={selectedBooking.status}\n                  onValueChange={(value) => {\n                    updateStatusMutation.mutate({\n                      id: selectedBooking._id,\n                      status: value as BookingStatus,\n                    });\n                    setSelectedBooking({\n                      ...selectedBooking,\n                      status: value as BookingStatus,\n                    });\n                  }}\n                >\n                  <SelectTrigger data-testid=\"select-update-status\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {bookingStatuses.map((status) => (\n                      <SelectItem key={status} value={status}>\n                        {statusLabels[status]}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":12589,"size_tokens":null},"client/src/pages/Dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { format, isPast, isFuture } from \"date-fns\";\nimport {\n  Calendar,\n  Star,\n  X,\n  ArrowRight,\n  MessageSquare,\n  Loader2,\n  Hotel,\n  CreditCard,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/lib/auth\";\nimport { api } from \"@/lib/api\";\nimport type { BookingWithDetails, BookingStatus } from \"@shared/schema\";\n\nconst statusColors: Record<BookingStatus, string> = {\n  pending: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400\",\n  confirmed: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400\",\n  checked_in: \"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400\",\n  checked_out: \"bg-gray-100 text-gray-800 dark:bg-gray-800/50 dark:text-gray-400\",\n  cancelled: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400\",\n};\n\nconst statusLabels: Record<BookingStatus, string> = {\n  pending: \"Pending\",\n  confirmed: \"Confirmed\",\n  checked_in: \"Checked In\",\n  checked_out: \"Checked Out\",\n  cancelled: \"Cancelled\",\n};\n\nfunction BookingCard({\n  booking,\n  onCancel,\n  onReview,\n  isCancelling,\n}: {\n  booking: BookingWithDetails;\n  onCancel: (id: string) => void;\n  onReview: (booking: BookingWithDetails) => void;\n  isCancelling: boolean;\n}) {\n  const canCancel =\n    booking.status !== \"cancelled\" &&\n    booking.status !== \"checked_out\" &&\n    isFuture(new Date(booking.checkInDate));\n\n  const canReview =\n    booking.status === \"checked_out\" &&\n    isPast(new Date(booking.checkOutDate));\n\n  return (\n    <Card className=\"overflow-hidden\" data-testid={`booking-card-${booking._id}`}>\n      <div className=\"flex flex-col md:flex-row\">\n        <div className=\"md:w-48 lg:w-56 shrink-0\">\n          <div className=\"aspect-[4/3] md:aspect-auto md:h-full overflow-hidden\">\n            {booking.room?.images?.[0] ? (\n              <img\n                src={booking.room.images[0]}\n                alt={booking.room.name}\n                className=\"w-full h-full object-cover\"\n              />\n            ) : (\n              <div className=\"w-full h-full bg-muted flex items-center justify-center min-h-[150px]\">\n                <Hotel className=\"h-8 w-8 text-muted-foreground\" />\n              </div>\n            )}\n          </div>\n        </div>\n        <CardContent className=\"flex-1 p-5\">\n          <div className=\"flex items-start justify-between gap-4 mb-3\">\n            <div>\n              <h3 className=\"font-semibold text-lg\">{booking.room?.name}</h3>\n              <p className=\"text-sm text-muted-foreground\">\n                Room {booking.room?.roomNumber} - {booking.room?.category}\n              </p>\n            </div>\n            <Badge className={statusColors[booking.status]}>\n              {statusLabels[booking.status]}\n            </Badge>\n          </div>\n\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm\">\n            <div>\n              <p className=\"text-muted-foreground\">Check-in</p>\n              <p className=\"font-medium\">\n                {format(new Date(booking.checkInDate), \"MMM d, yyyy\")}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-muted-foreground\">Check-out</p>\n              <p className=\"font-medium\">\n                {format(new Date(booking.checkOutDate), \"MMM d, yyyy\")}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-muted-foreground\">Guests</p>\n              <p className=\"font-medium\">{booking.guestCount}</p>\n            </div>\n            <div>\n              <p className=\"text-muted-foreground\">Total</p>\n              <p className=\"font-medium\">${booking.totalPrice}</p>\n            </div>\n          </div>\n\n          <div className=\"flex flex-wrap gap-2\">\n            {booking.status === \"pending\" ? (\n              <Button size=\"sm\" asChild>\n                <Link href={`/payment/${booking._id}`} data-testid={`link-go-to-payment-${booking._id}`}>\n                  <CreditCard className=\"mr-2 h-3 w-3\" />\n                  Go to Payment\n                </Link>\n              </Button>\n            ) : (\n              <Button variant=\"outline\" size=\"sm\" asChild>\n                <Link href={`/rooms/${booking.room?._id || booking.roomId}`} data-testid={`link-view-room-${booking._id}`}>\n                  View Room\n                  <ArrowRight className=\"ml-2 h-3 w-3\" />\n                </Link>\n              </Button>\n            )}\n            {canCancel && (\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => onCancel(booking._id)}\n                disabled={isCancelling}\n                className=\"text-destructive hover:text-destructive\"\n                data-testid={`button-cancel-${booking._id}`}\n              >\n                {isCancelling ? (\n                  <Loader2 className=\"mr-2 h-3 w-3 animate-spin\" />\n                ) : (\n                  <X className=\"mr-2 h-3 w-3\" />\n                )}\n                Cancel Booking\n              </Button>\n            )}\n            {canReview && (\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => onReview(booking)}\n                data-testid={`button-review-${booking._id}`}\n              >\n                <MessageSquare className=\"mr-2 h-3 w-3\" />\n                Write Review\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </div>\n    </Card>\n  );\n}\n\nfunction BookingCardSkeleton() {\n  return (\n    <Card className=\"overflow-hidden\">\n      <div className=\"flex flex-col md:flex-row\">\n        <Skeleton className=\"aspect-[4/3] md:w-48 lg:w-56 md:aspect-auto md:h-48\" />\n        <CardContent className=\"flex-1 p-5 space-y-4\">\n          <div className=\"flex justify-between\">\n            <div className=\"space-y-2\">\n              <Skeleton className=\"h-6 w-40\" />\n              <Skeleton className=\"h-4 w-32\" />\n            </div>\n            <Skeleton className=\"h-6 w-20\" />\n          </div>\n          <div className=\"grid grid-cols-4 gap-4\">\n            {[...Array(4)].map((_, i) => (\n              <div key={i} className=\"space-y-1\">\n                <Skeleton className=\"h-4 w-16\" />\n                <Skeleton className=\"h-5 w-20\" />\n              </div>\n            ))}\n          </div>\n          <div className=\"flex gap-2\">\n            <Skeleton className=\"h-8 w-24\" />\n            <Skeleton className=\"h-8 w-32\" />\n          </div>\n        </CardContent>\n      </div>\n    </Card>\n  );\n}\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const [cancelBookingId, setCancelBookingId] = useState<string | null>(null);\n  const [reviewBooking, setReviewBooking] = useState<BookingWithDetails | null>(null);\n  const [rating, setRating] = useState(5);\n  const [reviewComment, setReviewComment] = useState(\"\");\n\n  const { data: bookings, isLoading } = useQuery<BookingWithDetails[]>({\n    queryKey: [\"/api/bookings/my\"],\n  });\n\n  const cancelMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return api.patch<{ success: boolean }>(`/bookings/${id}/cancel`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings/my\"] });\n      toast({\n        title: \"Booking Cancelled\",\n        description: \"Your booking has been successfully cancelled.\",\n      });\n      setCancelBookingId(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to cancel booking.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const reviewMutation = useMutation({\n    mutationFn: async (data: { bookingId: string; roomId: string; rating: number; comment: string }) => {\n      return api.post(\"/reviews\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/bookings/my\"] });\n      toast({\n        title: \"Review Submitted\",\n        description: \"Thank you for your feedback!\",\n      });\n      setReviewBooking(null);\n      setRating(5);\n      setReviewComment(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to submit review.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const activeBookings = bookings?.filter(\n    (b) => b.status !== \"cancelled\" && b.status !== \"checked_out\"\n  );\n  const pastBookings = bookings?.filter(\n    (b) => b.status === \"checked_out\" || b.status === \"cancelled\"\n  );\n\n  const handleSubmitReview = () => {\n    if (!reviewBooking || !reviewComment.trim()) return;\n    \n    reviewMutation.mutate({\n      bookingId: reviewBooking._id,\n      roomId: reviewBooking.roomId,\n      rating,\n      comment: reviewComment,\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"bg-card border-b\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <h1 className=\"text-3xl font-serif font-bold mb-2\">\n            Welcome back, {user?.firstName}!\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Manage your bookings and reviews.\n          </p>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <Tabs defaultValue=\"active\" className=\"space-y-6\">\n          <TabsList>\n            <TabsTrigger value=\"active\" data-testid=\"tab-active\">\n              Active Bookings\n              {activeBookings && activeBookings.length > 0 && (\n                <Badge variant=\"secondary\" className=\"ml-2\">\n                  {activeBookings.length}\n                </Badge>\n              )}\n            </TabsTrigger>\n            <TabsTrigger value=\"past\" data-testid=\"tab-past\">\n              Past Bookings\n              {pastBookings && pastBookings.length > 0 && (\n                <Badge variant=\"secondary\" className=\"ml-2\">\n                  {pastBookings.length}\n                </Badge>\n              )}\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"active\" className=\"space-y-4\">\n            {isLoading ? (\n              <>\n                <BookingCardSkeleton />\n                <BookingCardSkeleton />\n              </>\n            ) : activeBookings && activeBookings.length > 0 ? (\n              activeBookings.map((booking) => (\n                <BookingCard\n                  key={booking._id}\n                  booking={booking}\n                  onCancel={setCancelBookingId}\n                  onReview={setReviewBooking}\n                  isCancelling={cancelMutation.isPending}\n                />\n              ))\n            ) : (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <Calendar className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No active bookings</h3>\n                  <p className=\"text-muted-foreground mb-4\">\n                    You don't have any upcoming stays. Browse our rooms to book your next getaway!\n                  </p>\n                  <Button asChild>\n                    <Link href=\"/rooms\" data-testid=\"link-browse-rooms\">\n                      Browse Rooms\n                    </Link>\n                  </Button>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"past\" className=\"space-y-4\">\n            {isLoading ? (\n              <>\n                <BookingCardSkeleton />\n                <BookingCardSkeleton />\n              </>\n            ) : pastBookings && pastBookings.length > 0 ? (\n              pastBookings.map((booking) => (\n                <BookingCard\n                  key={booking._id}\n                  booking={booking}\n                  onCancel={setCancelBookingId}\n                  onReview={setReviewBooking}\n                  isCancelling={cancelMutation.isPending}\n                />\n              ))\n            ) : (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <Hotel className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">No past bookings</h3>\n                  <p className=\"text-muted-foreground\">\n                    Your booking history will appear here after your stays.\n                  </p>\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <AlertDialog open={!!cancelBookingId} onOpenChange={() => setCancelBookingId(null)}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Cancel Booking</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to cancel this booking? This action cannot be undone.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Keep Booking</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={() => cancelBookingId && cancelMutation.mutate(cancelBookingId)}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              Cancel Booking\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      <Dialog open={!!reviewBooking} onOpenChange={() => setReviewBooking(null)}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Write a Review</DialogTitle>\n            <DialogDescription>\n              Share your experience at {reviewBooking?.room?.name}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Rating</label>\n              <div className=\"flex gap-1\">\n                {[1, 2, 3, 4, 5].map((value) => (\n                  <button\n                    key={value}\n                    onClick={() => setRating(value)}\n                    className=\"p-1\"\n                    data-testid={`star-${value}`}\n                  >\n                    <Star\n                      className={`h-6 w-6 ${\n                        value <= rating\n                          ? \"fill-yellow-400 text-yellow-400\"\n                          : \"text-muted\"\n                      }`}\n                    />\n                  </button>\n                ))}\n              </div>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Your Review</label>\n              <Textarea\n                placeholder=\"Tell us about your stay...\"\n                value={reviewComment}\n                onChange={(e) => setReviewComment(e.target.value)}\n                className=\"min-h-[120px]\"\n                data-testid=\"input-review-comment\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setReviewBooking(null)}\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleSubmitReview}\n              disabled={!reviewComment.trim() || reviewMutation.isPending}\n              data-testid=\"button-submit-review\"\n            >\n              {reviewMutation.isPending && (\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n              )}\n              Submit Review\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":16483,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/pages/manager/ManagerLayout.tsx":{"content":"import { ReactNode } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Hotel, LayoutDashboard, Calendar, LogOut } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Sidebar,\n  SidebarContent,\n  SidebarGroup,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarMenu,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarProvider,\n  SidebarTrigger,\n} from \"@/components/ui/sidebar\";\nimport { ThemeToggle } from \"@/components/layout/ThemeToggle\";\nimport { useAuth } from \"@/lib/auth\";\n\ninterface ManagerLayoutProps {\n  children: ReactNode;\n}\n\nconst managerNavItems = [\n  { href: \"/manager\", icon: LayoutDashboard, label: \"Dashboard\" },\n  { href: \"/manager/bookings\", icon: Calendar, label: \"Bookings\" },\n];\n\nexport function ManagerLayout({ children }: ManagerLayoutProps) {\n  const [location, setLocation] = useLocation();\n  const { logout, user } = useAuth();\n\n  const handleLogout = () => {\n    logout();\n    setLocation(\"/\");\n  };\n\n  const style = {\n    \"--sidebar-width\": \"16rem\",\n    \"--sidebar-width-icon\": \"3rem\",\n  };\n\n  return (\n    <SidebarProvider style={style as React.CSSProperties}>\n      <div className=\"flex h-screen w-full\">\n        <Sidebar>\n          <SidebarHeader className=\"border-b p-4\">\n            <Link href=\"/\" className=\"flex items-center gap-2\">\n              <Hotel className=\"h-6 w-6 text-primary\" />\n              <span className=\"font-serif font-semibold\">Grand Horizon</span>\n            </Link>\n          </SidebarHeader>\n          <SidebarContent>\n            <SidebarGroup>\n              <SidebarGroupLabel>Manager Panel</SidebarGroupLabel>\n              <SidebarGroupContent>\n                <SidebarMenu>\n                  {managerNavItems.map((item) => (\n                    <SidebarMenuItem key={item.href}>\n                      <SidebarMenuButton\n                        asChild\n                        isActive={location === item.href}\n                      >\n                        <Link href={item.href} data-testid={`nav-${item.label.toLowerCase()}`}>\n                          <item.icon className=\"h-4 w-4\" />\n                          <span>{item.label}</span>\n                        </Link>\n                      </SidebarMenuButton>\n                    </SidebarMenuItem>\n                  ))}\n                </SidebarMenu>\n              </SidebarGroupContent>\n            </SidebarGroup>\n          </SidebarContent>\n          <div className=\"mt-auto p-4 border-t\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"w-8 h-8 rounded-full bg-primary flex items-center justify-center text-primary-foreground text-sm font-medium\">\n                {user?.firstName?.[0]}{user?.lastName?.[0]}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium truncate\">\n                  {user?.firstName} {user?.lastName}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">Manager</p>\n              </div>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              className=\"w-full gap-2\"\n              onClick={handleLogout}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"h-4 w-4\" />\n              Log out\n            </Button>\n          </div>\n        </Sidebar>\n        <div className=\"flex flex-col flex-1 overflow-hidden\">\n          <header className=\"flex items-center justify-between gap-4 p-4 border-b bg-background\">\n            <SidebarTrigger data-testid=\"button-sidebar-toggle\" />\n            <div className=\"flex items-center gap-2\">\n              <ThemeToggle />\n              <Button variant=\"outline\" size=\"sm\" asChild>\n                <Link href=\"/\" data-testid=\"link-view-site\">View Site</Link>\n              </Button>\n            </div>\n          </header>\n          <main className=\"flex-1 overflow-auto\">\n            {children}\n          </main>\n        </div>\n      </div>\n    </SidebarProvider>\n  );\n}\n","path":null,"size_bytes":4048,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Link } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Hotel } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-[60vh] flex items-center justify-center\">\n      <div className=\"text-center px-4\">\n        <Hotel className=\"h-16 w-16 mx-auto text-muted-foreground mb-6\" />\n        <h1 className=\"text-4xl font-serif font-bold mb-2\">404</h1>\n        <h2 className=\"text-xl font-semibold mb-4\">Page Not Found</h2>\n        <p className=\"text-muted-foreground mb-8 max-w-md mx-auto\">\n          Oops! The page you're looking for doesn't exist. \n          Let us help you find your way back.\n        </p>\n        <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n          <Button asChild>\n            <Link href=\"/\" data-testid=\"link-go-home\">Go Home</Link>\n          </Button>\n          <Button variant=\"outline\" asChild>\n            <Link href=\"/rooms\" data-testid=\"link-browse-rooms\">Browse Rooms</Link>\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1074,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"replit.md":{"content":"# Grand Horizon Hotel - Booking System\n\n## Overview\n\nGrand Horizon Hotel is a full-stack hotel booking and management platform built with React, Express, and MongoDB. The application provides a complete booking flow for customers, along with dedicated dashboards for managers and administrators to handle operations. The platform draws design inspiration from leading hospitality services like Airbnb, Booking.com, and Marriott to create a trustworthy and visually appealing experience.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework & Build System**\n- React 18 with TypeScript for type safety\n- Vite as the build tool and development server with hot module replacement (HMR)\n- Wouter for lightweight client-side routing instead of React Router\n- TanStack Query (React Query) for server state management and caching\n\n**UI Component System**\n- shadcn/ui component library (New York style variant) with Radix UI primitives\n- Tailwind CSS for utility-first styling with custom design tokens\n- Custom CSS variables for theming (light/dark mode support)\n- Component path aliases configured via TypeScript paths (@/components, @/lib, etc.)\n\n**State Management Strategy**\n- AuthContext for global authentication state (JWT token + user object)\n- ThemeContext for light/dark mode preferences\n- TanStack Query for all server state (rooms, bookings, reviews)\n- Local component state for UI interactions\n\n**Key Design Decisions**\n- Server-side rendering not used; single-page application (SPA) architecture\n- Authentication via JWT tokens stored in localStorage\n- API calls use custom fetch wrapper with automatic token injection\n- Protected routes implemented via ProtectedRoute wrapper component with role-based access\n\n### Backend Architecture\n\n**Server Framework**\n- Express.js for HTTP server and REST API endpoints\n- MongoDB with Mongoose ODM for data persistence\n- Custom middleware for authentication and authorization\n\n**API Structure**\n- `/api/auth` - User registration, login, token generation\n- `/api/rooms` - Room listings, filtering, and details\n- `/api/bookings` - Booking creation and management\n- `/api/reviews` - Post-stay review submissions\n- `/api/admin` - Administrative operations (room management, image uploads)\n- `/api/manager` - Manager dashboard statistics and booking operations\n\n**Authentication & Authorization**\n- JWT-based authentication with bcrypt password hashing\n- Three role types: customer, manager, admin\n- Middleware chain: authenticate  requireRole for protected endpoints\n- Token expiration set to 7 days\n\n**File Upload Handling**\n- Multer middleware for multipart/form-data processing\n- Image uploads stored in local `/uploads` directory\n- File type validation (jpeg, jpg, png, webp only)\n- 5MB file size limit per image\n\n**Email Service**\n- Nodemailer integration for booking confirmations\n- SMTP configuration via environment variables\n- HTML email templates with booking details\n\n### Data Models (MongoDB/Mongoose)\n\n**User Model**\n- Fields: email (unique), password (hashed), firstName, lastName, phone, role, createdAt\n- Password comparison method for authentication\n- Indexes on email field for query performance\n\n**Room Model**\n- Fields: name, description, category, pricePerNight, capacity, images[], amenities[], isAvailable, roomNumber, createdAt\n- Categories: Standard, Deluxe, Suite, Executive, Presidential, Family, Penthouse\n- Images stored as URL strings (path to uploaded files)\n\n**Booking Model**\n- Fields: userId (ref), roomId (ref), checkInDate, checkOutDate, totalPrice, discountAmount, finalPrice, promoCode, status, guestCount, specialRequests, paymentIntentId, paymentStatus, createdAt\n- Status types: pending, confirmed, checked_in, checked_out, cancelled\n- Payment status: pending, paid, refunded\n- Promo code support with discount tracking (discountAmount, finalPrice fields)\n- Pre-save hook auto-calculates finalPrice if not set\n- Populated references for user and room details in responses\n\n**PromoCode Model**\n- Fields: code (unique), description, discountType (percentage/fixed), discountValue, minBookingAmount, maxDiscountAmount, validFrom, validTo, usageLimit, usageCount, isActive, createdAt\n- Supports percentage and fixed discount types\n- Usage tracking with optional limits\n- Date range validation for validity period\n- Minimum booking amount requirement support\n\n**Review Model**\n- Fields: userId (ref), roomId (ref), bookingId (ref, unique), rating (1-5), comment, createdAt\n- One review per booking constraint via unique index\n- Can only review after checkout status\n- Reviews aggregated for room average ratings\n\n### Database Strategy\n\n**Initial Configuration**\n- Project configured for PostgreSQL with Drizzle ORM (drizzle.config.ts, schema references)\n- Actual implementation uses MongoDB with Mongoose\n- Database connection handles missing MONGODB_URI gracefully with warnings\n- Connection state tracking to prevent redundant connections\n\n**Migration Path**\n- Schema definitions exist in shared/schema.ts using Zod validators\n- These schemas mirror the Mongoose models for validation\n- Future migration to PostgreSQL possible by implementing Drizzle schema\n\n## External Dependencies\n\n### Core Infrastructure\n- **MongoDB**: Primary database (connection via MONGODB_URI environment variable)\n- **Neon Database (Configured but not active)**: PostgreSQL provider configured via @neondatabase/serverless package\n\n### Email Service\n- **SMTP Server**: Email delivery for booking confirmations\n  - Configuration: SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS environment variables\n  - Defaults to Ethereal Email for development/testing\n\n### Third-Party UI Libraries\n- **Radix UI**: Accessible component primitives (40+ packages including dialog, dropdown, select, etc.)\n- **Lucide React**: Icon library for consistent iconography\n- **Embla Carousel**: Carousel/slider functionality (via embla-carousel-react)\n- **React Day Picker**: Calendar component for date selection\n- **CMDK**: Command palette component\n- **Vaul**: Drawer component primitives\n\n### Development & Build Tools\n- **Replit-specific plugins**: \n  - @replit/vite-plugin-runtime-error-modal\n  - @replit/vite-plugin-cartographer\n  - @replit/vite-plugin-dev-banner\n- **ESBuild**: Server-side bundling for production builds\n- **PostCSS & Autoprefixer**: CSS processing pipeline\n\n### Utilities & Validation\n- **Zod**: Schema validation for API requests and responses\n- **React Hook Form**: Form state management with @hookform/resolvers\n- **date-fns**: Date manipulation and formatting\n- **clsx & tailwind-merge**: Conditional className utilities\n- **class-variance-authority**: Component variant management\n\n### Security & Authentication\n- **bcryptjs**: Password hashing\n- **jsonwebtoken**: JWT token generation and verification\n\n### File Processing\n- **Multer**: Multipart form data and file uploads\n\n### Payment Integration\n- Stripe integration for payment processing (test mode)\n- Payment-related fields in booking model (paymentIntentId, paymentStatus)\n- Simulated payment flow in development with actual Stripe in production","path":null,"size_bytes":7155,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"server/index.ts":{"content":"import { config } from \"dotenv\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\nconfig({ path: path.resolve(__dirname, \"../.env\") });\n\nimport express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  \n  // Use 0.0.0.0 on Replit/Linux, localhost on Windows for local development\n  const isReplit = process.env.REPL_ID || process.env.REPLIT;\n  const host = isReplit ? \"0.0.0.0\" : \"localhost\";\n  \n  const listenOptions: { port: number; host: string; reusePort?: boolean } = {\n    port,\n    host,\n  };\n  \n  // reusePort is not supported on Windows\n  if (isReplit) {\n    listenOptions.reusePort = true;\n  }\n  \n  httpServer.listen(listenOptions, () => {\n    log(`serving on http://${host}:${port}`);\n  });\n})();\n","path":null,"size_bytes":3154,"size_tokens":null},"server/db/models/User.ts":{"content":"import mongoose, { Schema, Document } from 'mongoose';\nimport bcrypt from 'bcryptjs';\n\nexport interface IUser extends Document {\n  _id: mongoose.Types.ObjectId;\n  email: string;\n  password: string;\n  firstName: string;\n  lastName: string;\n  phone?: string;\n  role: 'customer' | 'manager' | 'admin';\n  createdAt: Date;\n  comparePassword(candidatePassword: string): Promise<boolean>;\n}\n\nconst userSchema = new Schema<IUser>({\n  email: {\n    type: String,\n    required: true,\n    unique: true,\n    lowercase: true,\n    trim: true,\n  },\n  password: {\n    type: String,\n    required: true,\n    minlength: 6,\n  },\n  firstName: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  lastName: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  phone: {\n    type: String,\n    trim: true,\n  },\n  role: {\n    type: String,\n    enum: ['customer', 'manager', 'admin'],\n    default: 'customer',\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now,\n  },\n});\n\nuserSchema.pre('save', async function () {\n  if (!this.isModified('password')) return;\n  \n  const salt = await bcrypt.genSalt(10);\n  this.password = await bcrypt.hash(this.password, salt);\n});\n\nuserSchema.methods.comparePassword = async function (candidatePassword: string): Promise<boolean> {\n  return bcrypt.compare(candidatePassword, this.password);\n};\n\nuserSchema.set('toJSON', {\n  transform: function (doc, ret) {\n    ret._id = ret._id.toString();\n    delete ret.password;\n    delete ret.__v;\n    return ret;\n  },\n});\n\nexport const User = mongoose.model<IUser>('User', userSchema);\n","path":null,"size_bytes":1558,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ProtectedRoute.tsx":{"content":"import { ReactNode } from \"react\";\nimport { Redirect, useLocation } from \"wouter\";\nimport { Loader2 } from \"lucide-react\";\nimport { useAuth } from \"@/lib/auth\";\n\ninterface ProtectedRouteProps {\n  children: ReactNode;\n  requiredRole?: \"admin\" | \"manager\" | \"customer\";\n}\n\nexport function ProtectedRoute({ children, requiredRole }: ProtectedRouteProps) {\n  const { isAuthenticated, user, isLoading, isAdmin, isManager } = useAuth();\n  const [location] = useLocation();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Redirect to={`/login?redirect=${encodeURIComponent(location)}`} />;\n  }\n\n  if (requiredRole === \"admin\" && !isAdmin) {\n    return <Redirect to=\"/\" />;\n  }\n\n  if (requiredRole === \"manager\" && !isManager && !isAdmin) {\n    return <Redirect to=\"/\" />;\n  }\n\n  return <>{children}</>;\n}\n","path":null,"size_bytes":982,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4050,"size_tokens":null},"server/routes/auth.ts":{"content":"import { Router, Request, Response } from 'express';\nimport { User } from '../db/models';\nimport { generateToken, authenticate, AuthRequest } from '../middleware/auth';\nimport { z } from 'zod';\n\nconst router = Router();\n\nconst registerSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(6),\n  firstName: z.string().min(1),\n  lastName: z.string().min(1),\n  phone: z.string().optional(),\n  role: z.enum(['customer', 'manager', 'admin']).optional().default('customer'),\n});\n\nconst loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(1),\n});\n\nrouter.post('/register', async (req: Request, res: Response) => {\n  try {\n    const data = registerSchema.parse(req.body);\n    \n    const existingUser = await User.findOne({ email: data.email });\n    if (existingUser) {\n      return res.status(400).json({ message: 'Email already registered' });\n    }\n\n    const user = new User(data);\n    await user.save();\n\n    const token = generateToken(user._id.toString());\n    \n    res.status(201).json({\n      user: user.toJSON(),\n      token,\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Registration error:', error);\n    res.status(500).json({ message: 'Registration failed' });\n  }\n});\n\nrouter.post('/login', async (req: Request, res: Response) => {\n  try {\n    const data = loginSchema.parse(req.body);\n    \n    const user = await User.findOne({ email: data.email });\n    if (!user) {\n      return res.status(401).json({ message: 'Invalid email or password' });\n    }\n\n    const isValidPassword = await user.comparePassword(data.password);\n    if (!isValidPassword) {\n      return res.status(401).json({ message: 'Invalid email or password' });\n    }\n\n    const token = generateToken(user._id.toString());\n    \n    res.json({\n      user: user.toJSON(),\n      token,\n    });\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Login error:', error);\n    res.status(500).json({ message: 'Login failed' });\n  }\n});\n\nrouter.get('/me', authenticate, async (req: AuthRequest, res: Response) => {\n  res.json({ user: req.user?.toJSON() });\n});\n\nexport default router;\n","path":null,"size_bytes":2323,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"server/storage.ts":{"content":"import { type User, type InsertUser } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\n// modify the interface with any CRUD methods\n// you might need\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n\n  constructor() {\n    this.users = new Map();\n  }\n\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    return Array.from(this.users.values()).find(\n      (user) => user.username === username,\n    );\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const id = randomUUID();\n    const user: User = { ...insertUser, id };\n    this.users.set(id, user);\n    return user;\n  }\n}\n\nexport const storage = new MemStorage();\n","path":null,"size_bytes":993,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"server/scripts/seed.ts":{"content":"import mongoose from \"mongoose\";\nimport { User, Room, Booking, Review } from \"../db/models/index.js\";\nimport bcrypt from \"bcryptjs\";\n\nconst MONGODB_URI = process.env.MONGODB_URI!;\n\nconst sampleRooms = [\n  {\n    name: \"Presidential Suite\",\n    description: \"Our most luxurious accommodation featuring a private terrace with panoramic ocean views, a master bedroom with king-size bed, separate living area, marble bathroom with jacuzzi, and 24-hour butler service. Perfect for those seeking the ultimate in comfort and elegance.\",\n    category: \"Presidential\",\n    pricePerNight: 899,\n    capacity: 4,\n    roomNumber: \"PH01\",\n    images: [\n      \"https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=800\",\n      \"https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=800\",\n      \"https://images.unsplash.com/photo-1590490360182-c33d57733427?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Ocean View\", \"Mini Bar\", \"Room Service\", \"Jacuzzi\", \"Private Terrace\", \"Butler Service\"],\n    isAvailable: true\n  },\n  {\n    name: \"Deluxe Ocean View\",\n    description: \"Wake up to stunning sunrise views over the Pacific Ocean. This spacious room features a plush king-size bed, floor-to-ceiling windows, modern bathroom with rain shower, and a private balcony. Ideal for couples seeking a romantic getaway.\",\n    category: \"Deluxe\",\n    pricePerNight: 399,\n    capacity: 2,\n    roomNumber: \"301\",\n    images: [\n      \"https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800\",\n      \"https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Ocean View\", \"Mini Bar\", \"Balcony\", \"Rain Shower\"],\n    isAvailable: true\n  },\n  {\n    name: \"Garden Executive Suite\",\n    description: \"A private suite surrounded by tropical gardens, featuring two bedrooms, a private pool, outdoor dining area, and a fully equipped kitchen. Perfect for families or groups looking for privacy and space.\",\n    category: \"Executive\",\n    pricePerNight: 649,\n    capacity: 6,\n    roomNumber: \"V01\",\n    images: [\n      \"https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=800\",\n      \"https://images.unsplash.com/photo-1600585154340-be6161a56a0c?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Private Pool\", \"Kitchen\", \"Garden View\", \"BBQ Area\", \"Outdoor Dining\"],\n    isAvailable: true\n  },\n  {\n    name: \"Classic Double Room\",\n    description: \"Comfortable and elegantly appointed room featuring two queen-size beds, work desk, and modern amenities. An excellent choice for business travelers or friends traveling together.\",\n    category: \"Standard\",\n    pricePerNight: 199,\n    capacity: 4,\n    roomNumber: \"102\",\n    images: [\n      \"https://images.unsplash.com/photo-1611892440504-42a792e24d32?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Work Desk\", \"Coffee Maker\", \"Iron\"],\n    isAvailable: true\n  },\n  {\n    name: \"Executive Business Suite\",\n    description: \"Designed for the discerning business traveler, this suite offers a separate living room, executive work area, premium toiletries, and access to our exclusive Executive Lounge with complimentary refreshments.\",\n    category: \"Executive\",\n    pricePerNight: 499,\n    capacity: 2,\n    roomNumber: \"401\",\n    images: [\n      \"https://images.unsplash.com/photo-1578683010236-d716f9a3f461?w=800\",\n      \"https://images.unsplash.com/photo-1591088398332-8a7791972843?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Executive Lounge Access\", \"Mini Bar\", \"Work Desk\", \"City View\", \"Nespresso Machine\"],\n    isAvailable: true\n  },\n  {\n    name: \"Beachfront Deluxe\",\n    description: \"Step directly onto the sand from your private room. Features a king-size canopy bed, outdoor shower, hammock, and direct beach access. The perfect retreat for beach lovers.\",\n    category: \"Deluxe\",\n    pricePerNight: 549,\n    capacity: 2,\n    roomNumber: \"B01\",\n    images: [\n      \"https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?w=800\",\n      \"https://images.unsplash.com/photo-1439130490301-25e322d88054?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Beach Access\", \"Outdoor Shower\", \"Hammock\", \"Ocean View\"],\n    isAvailable: true\n  },\n  {\n    name: \"Family Suite\",\n    description: \"Spacious two-room suite designed for families. Features a master bedroom with king bed, kids' room with bunk beds, large bathroom, and a living area with entertainment system. Kids' welcome amenities included.\",\n    category: \"Family\",\n    pricePerNight: 449,\n    capacity: 5,\n    roomNumber: \"205\",\n    images: [\n      \"https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Mini Bar\", \"Kids' Amenities\", \"Gaming Console\", \"Extra Beds Available\"],\n    isAvailable: true\n  },\n  {\n    name: \"Penthouse Loft\",\n    description: \"Contemporary two-story loft with floor-to-ceiling windows offering 360-degree city views. Features a spiral staircase, rooftop terrace, designer furniture, and a state-of-the-art entertainment system.\",\n    category: \"Penthouse\",\n    pricePerNight: 1299,\n    capacity: 4,\n    roomNumber: \"PH02\",\n    images: [\n      \"https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800\",\n      \"https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"City View\", \"Rooftop Terrace\", \"Home Theater\", \"Wine Cellar\", \"Private Elevator\"],\n    isAvailable: true\n  },\n  {\n    name: \"Cozy Single Room\",\n    description: \"Perfect for solo travelers, this compact but comfortable room offers everything you need for a pleasant stay. Features a queen-size bed, workspace, and modern bathroom.\",\n    category: \"Standard\",\n    pricePerNight: 129,\n    capacity: 1,\n    roomNumber: \"105\",\n    images: [\n      \"https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"Work Desk\", \"Coffee Maker\"],\n    isAvailable: true\n  },\n  {\n    name: \"Spa Retreat Room\",\n    description: \"Wellness-focused room featuring an in-room jacuzzi, aromatherapy amenities, yoga mat, and complimentary spa credits. Designed for ultimate relaxation and rejuvenation.\",\n    category: \"Deluxe\",\n    pricePerNight: 379,\n    capacity: 2,\n    roomNumber: \"SPA01\",\n    images: [\n      \"https://images.unsplash.com/photo-1540518614846-7eded433c457?w=800\"\n    ],\n    amenities: [\"WiFi\", \"Air Conditioning\", \"In-Room Jacuzzi\", \"Spa Credits\", \"Yoga Mat\", \"Aromatherapy\", \"Meditation Corner\"],\n    isAvailable: true\n  }\n];\n\nconst reviewTexts = [\n  { rating: 5, text: \"Absolutely stunning room with breathtaking views! The staff was incredibly attentive and made our anniversary truly special. Will definitely be returning!\" },\n  { rating: 5, text: \"Best hotel experience we've ever had. The room was immaculate, the bed was heavenly, and the amenities exceeded our expectations.\" },\n  { rating: 4, text: \"Great location and beautiful room. The only minor issue was slow WiFi during peak hours, but otherwise perfect.\" },\n  { rating: 5, text: \"The attention to detail is remarkable. From the welcome amenities to the turndown service, everything was perfect.\" },\n  { rating: 4, text: \"Lovely room with great ocean views. The balcony was perfect for morning coffee. Would recommend to friends.\" },\n  { rating: 5, text: \"Exceeded all expectations! The room was spacious, clean, and beautifully decorated. The breakfast was also fantastic.\" },\n  { rating: 4, text: \"Very comfortable stay. The bed was extremely comfortable and the room was quiet despite being near the elevator.\" },\n  { rating: 5, text: \"We celebrated our honeymoon here and it was magical. The staff arranged flowers and champagne as a surprise!\" },\n  { rating: 3, text: \"Good room overall, but the air conditioning was a bit noisy. Location and service were excellent though.\" },\n  { rating: 5, text: \"Perfect for a business trip. The work desk was spacious, WiFi was fast, and the executive lounge was a nice touch.\" }\n];\n\nconst guestNames = [\n  \"Sarah Mitchell\", \"James Wilson\", \"Emily Chen\", \"Michael Brown\", \n  \"Jessica Taylor\", \"David Lee\", \"Amanda Johnson\", \"Robert Garcia\",\n  \"Jennifer Martinez\", \"Christopher Anderson\"\n];\n\nasync function seed() {\n  try {\n    await mongoose.connect(MONGODB_URI);\n    console.log(\"Connected to MongoDB\");\n\n    // Create sample customers if they don't exist\n    const customers = [];\n    for (let i = 0; i < 5; i++) {\n      const email = `customer${i + 1}@example.com`;\n      let customer = await User.findOne({ email });\n      if (!customer) {\n        const hashedPassword = await bcrypt.hash(\"password123\", 10);\n        customer = await User.create({\n          firstName: guestNames[i].split(\" \")[0],\n          lastName: guestNames[i].split(\" \")[1],\n          email,\n          password: hashedPassword,\n          role: \"customer\"\n        });\n        console.log(`Created customer: ${email}`);\n      }\n      customers.push(customer);\n    }\n\n    // Create rooms (skip if already exists by roomNumber)\n    const createdRooms = [];\n    for (const roomData of sampleRooms) {\n      let room = await Room.findOne({ roomNumber: roomData.roomNumber });\n      if (!room) {\n        room = await Room.create(roomData);\n        console.log(`Created room: ${room.name}`);\n      }\n      createdRooms.push(room);\n    }\n\n    // Create sample bookings with various statuses\n    const bookingStatuses = [\"pending\", \"confirmed\", \"checked-in\", \"checked-out\", \"cancelled\"];\n    const today = new Date();\n    \n    // Past bookings (checked_out)\n    for (let i = 0; i < 5; i++) {\n      const room = createdRooms[i % createdRooms.length];\n      const customer = customers[i % customers.length];\n      const checkIn = new Date(today);\n      checkIn.setDate(today.getDate() - 30 + (i * 5));\n      const checkOut = new Date(checkIn);\n      checkOut.setDate(checkIn.getDate() + 2 + (i % 3));\n      \n      const nights = Math.ceil((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24));\n      \n      const existingBooking = await Booking.findOne({ \n        roomId: room._id, \n        userId: customer._id,\n        checkInDate: checkIn \n      });\n      \n      if (!existingBooking) {\n        const booking = await Booking.create({\n          userId: customer._id,\n          roomId: room._id,\n          checkInDate: checkIn,\n          checkOutDate: checkOut,\n          totalPrice: room.pricePerNight * nights,\n          status: \"checked_out\",\n          guestCount: Math.min(2, room.capacity),\n          specialRequests: i % 2 === 0 ? \"Late check-out requested\" : undefined,\n          paymentStatus: \"paid\"\n        });\n        console.log(`Created past booking for ${room.name}`);\n\n        // Add review for checked_out bookings\n        const reviewData = reviewTexts[i % reviewTexts.length];\n        await Review.create({\n          userId: customer._id,\n          roomId: room._id,\n          bookingId: booking._id,\n          rating: reviewData.rating,\n          comment: reviewData.text\n        });\n        console.log(`Created review for ${room.name}`);\n      }\n    }\n\n    // Current bookings (confirmed, checked_in)\n    for (let i = 0; i < 3; i++) {\n      const room = createdRooms[(i + 5) % createdRooms.length];\n      const customer = customers[(i + 2) % customers.length];\n      const checkIn = new Date(today);\n      checkIn.setDate(today.getDate() - 1);\n      const checkOut = new Date(checkIn);\n      checkOut.setDate(checkIn.getDate() + 3);\n      \n      const nights = Math.ceil((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24));\n      \n      const existingBooking = await Booking.findOne({ \n        roomId: room._id, \n        status: { $in: [\"confirmed\", \"checked_in\"] }\n      });\n      \n      if (!existingBooking) {\n        await Booking.create({\n          userId: customer._id,\n          roomId: room._id,\n          checkInDate: checkIn,\n          checkOutDate: checkOut,\n          totalPrice: room.pricePerNight * nights,\n          status: i === 0 ? \"checked_in\" : \"confirmed\",\n          guestCount: Math.min(2, room.capacity),\n          paymentStatus: \"paid\"\n        });\n        console.log(`Created current booking for ${room.name} (${i === 0 ? \"checked_in\" : \"confirmed\"})`);\n      }\n    }\n\n    // Future bookings (pending)\n    for (let i = 0; i < 4; i++) {\n      const room = createdRooms[(i + 3) % createdRooms.length];\n      const customer = customers[i % customers.length];\n      const checkIn = new Date(today);\n      checkIn.setDate(today.getDate() + 7 + (i * 3));\n      const checkOut = new Date(checkIn);\n      checkOut.setDate(checkIn.getDate() + 2 + (i % 4));\n      \n      const nights = Math.ceil((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24));\n      \n      const existingBooking = await Booking.findOne({ \n        roomId: room._id, \n        checkInDate: checkIn \n      });\n      \n      if (!existingBooking) {\n        await Booking.create({\n          userId: customer._id,\n          roomId: room._id,\n          checkInDate: checkIn,\n          checkOutDate: checkOut,\n          totalPrice: room.pricePerNight * nights,\n          status: i % 2 === 0 ? \"pending\" : \"confirmed\",\n          guestCount: Math.min(2, room.capacity),\n          specialRequests: i === 1 ? \"Anniversary celebration - please arrange flowers\" : undefined,\n          paymentStatus: i % 2 === 0 ? \"pending\" : \"paid\"\n        });\n        console.log(`Created future booking for ${room.name}`);\n      }\n    }\n\n    // One cancelled booking\n    const cancelledRoom = createdRooms[7];\n    const cancelledCustomer = customers[4];\n    const cancelCheckIn = new Date(today);\n    cancelCheckIn.setDate(today.getDate() + 14);\n    const cancelCheckOut = new Date(cancelCheckIn);\n    cancelCheckOut.setDate(cancelCheckIn.getDate() + 3);\n    \n    const existingCancelled = await Booking.findOne({ \n      roomId: cancelledRoom._id, \n      status: \"cancelled\" \n    });\n    \n    if (!existingCancelled) {\n      await Booking.create({\n        userId: cancelledCustomer._id,\n        roomId: cancelledRoom._id,\n        checkInDate: cancelCheckIn,\n        checkOutDate: cancelCheckOut,\n        totalPrice: cancelledRoom.pricePerNight * 3,\n        status: \"cancelled\",\n        guestCount: 2,\n        paymentStatus: \"refunded\"\n      });\n      console.log(`Created cancelled booking for ${cancelledRoom.name}`);\n    }\n\n    // Update room average ratings based on reviews\n    const rooms = await Room.find();\n    for (const room of rooms) {\n      const reviews = await Review.find({ room: room._id });\n      if (reviews.length > 0) {\n        const avgRating = reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length;\n        await Room.findByIdAndUpdate(room._id, { averageRating: Math.round(avgRating * 10) / 10 });\n        console.log(`Updated average rating for ${room.name}: ${avgRating.toFixed(1)}`);\n      }\n    }\n\n    console.log(\"\\nSeeding complete!\");\n    console.log(`Total rooms: ${await Room.countDocuments()}`);\n    console.log(`Total bookings: ${await Booking.countDocuments()}`);\n    console.log(`Total reviews: ${await Review.countDocuments()}`);\n    console.log(`Total users: ${await User.countDocuments()}`);\n\n    await mongoose.disconnect();\n    process.exit(0);\n  } catch (error) {\n    console.error(\"Seeding error:\", error);\n    process.exit(1);\n  }\n}\n\nseed();\n","path":null,"size_bytes":15312,"size_tokens":null},"client/src/lib/api.ts":{"content":"const API_BASE = \"/api\";\n\nfunction getAuthHeaders(): HeadersInit {\n  const token = localStorage.getItem(\"token\");\n  return token ? { Authorization: `Bearer ${token}` } : {};\n}\n\nexport async function apiRequest<T>(\n  method: string,\n  endpoint: string,\n  data?: unknown\n): Promise<T> {\n  const headers: HeadersInit = {\n    \"Content-Type\": \"application/json\",\n    ...getAuthHeaders(),\n  };\n\n  const config: RequestInit = {\n    method,\n    headers,\n  };\n\n  if (data && method !== \"GET\") {\n    config.body = JSON.stringify(data);\n  }\n\n  const response = await fetch(`${API_BASE}${endpoint}`, config);\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: \"An error occurred\" }));\n    throw new Error(error.message || `HTTP error! status: ${response.status}`);\n  }\n\n  return response.json();\n}\n\nexport async function uploadImages(files: File[]): Promise<string[]> {\n  const formData = new FormData();\n  files.forEach((file) => {\n    formData.append(\"images\", file);\n  });\n\n  const token = localStorage.getItem(\"token\");\n  const headers: HeadersInit = token ? { Authorization: `Bearer ${token}` } : {};\n\n  const response = await fetch(`${API_BASE}/admin/upload`, {\n    method: \"POST\",\n    headers,\n    body: formData,\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: \"Upload failed\" }));\n    throw new Error(error.message);\n  }\n\n  const result = await response.json();\n  return result.urls;\n}\n\nexport const api = {\n  get: <T>(endpoint: string) => apiRequest<T>(\"GET\", endpoint),\n  post: <T>(endpoint: string, data?: unknown) => apiRequest<T>(\"POST\", endpoint, data),\n  put: <T>(endpoint: string, data?: unknown) => apiRequest<T>(\"PUT\", endpoint, data),\n  patch: <T>(endpoint: string, data?: unknown) => apiRequest<T>(\"PATCH\", endpoint, data),\n  delete: <T>(endpoint: string) => apiRequest<T>(\"DELETE\", endpoint),\n};\n","path":null,"size_bytes":1887,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"server/scripts/create-test-users.ts":{"content":"import mongoose from \"mongoose\";\nimport { User } from \"../db/models/index.js\";\n\nconst MONGODB_URI = process.env.MONGODB_URI!;\n\nasync function createTestUsers() {\n  try {\n    await mongoose.connect(MONGODB_URI);\n    console.log(\"Connected to MongoDB\");\n\n    const testPassword = \"Test@123\";\n\n    // Delete existing test accounts to recreate with correct password\n    await User.deleteOne({ email: \"admin@grandhorizon.com\" });\n    await User.deleteOne({ email: \"manager@grandhorizon.com\" });\n    await User.deleteOne({ email: \"guest@grandhorizon.com\" });\n\n    // Admin account - password will be hashed by pre-save hook\n    const admin = await User.create({\n      firstName: \"Admin\",\n      lastName: \"User\",\n      email: \"admin@grandhorizon.com\",\n      password: testPassword,\n      role: \"admin\"\n    });\n    console.log(`Created admin: ${admin.email}`);\n\n    // Manager account\n    const manager = await User.create({\n      firstName: \"Manager\",\n      lastName: \"User\",\n      email: \"manager@grandhorizon.com\",\n      password: testPassword,\n      role: \"manager\"\n    });\n    console.log(`Created manager: ${manager.email}`);\n\n    // Customer account\n    const customer = await User.create({\n      firstName: \"Guest\",\n      lastName: \"User\",\n      email: \"guest@grandhorizon.com\",\n      password: testPassword,\n      role: \"customer\"\n    });\n    console.log(`Created customer: ${customer.email}`);\n\n    console.log(\"\\n========================================\");\n    console.log(\"Test accounts created successfully!\");\n    console.log(\"========================================\");\n    console.log(\"\\nAll accounts use password: Test@123\");\n    console.log(\"\\nAdmin:    admin@grandhorizon.com\");\n    console.log(\"Manager:  manager@grandhorizon.com\");\n    console.log(\"Customer: guest@grandhorizon.com\");\n    console.log(\"========================================\\n\");\n\n    await mongoose.disconnect();\n    process.exit(0);\n  } catch (error) {\n    console.error(\"Error:\", error);\n    process.exit(1);\n  }\n}\n\ncreateTestUsers();\n","path":null,"size_bytes":2019,"size_tokens":null},"server/routes/admin.ts":{"content":"import { Router, Request, Response } from 'express';\nimport multer from 'multer';\nimport path from 'path';\nimport fs from 'fs';\nimport { Room, Booking, User, Review, PromoCode } from '../db/models';\nimport { authenticate, requireRole, AuthRequest } from '../middleware/auth';\nimport { z } from 'zod';\n\nconst router = Router();\n\nconst uploadsDir = path.join(process.cwd(), 'uploads');\nif (!fs.existsSync(uploadsDir)) {\n  fs.mkdirSync(uploadsDir, { recursive: true });\n}\n\nconst storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, uploadsDir);\n  },\n  filename: (req, file, cb) => {\n    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);\n    cb(null, uniqueSuffix + path.extname(file.originalname));\n  },\n});\n\nconst upload = multer({\n  storage,\n  limits: { fileSize: 5 * 1024 * 1024 },\n  fileFilter: (req, file, cb) => {\n    const allowedTypes = /jpeg|jpg|png|webp/;\n    const extname = allowedTypes.test(path.extname(file.originalname).toLowerCase());\n    const mimetype = allowedTypes.test(file.mimetype);\n    \n    if (extname && mimetype) {\n      return cb(null, true);\n    }\n    cb(new Error('Only image files are allowed'));\n  },\n});\n\nrouter.use(authenticate);\nrouter.use(requireRole('admin'));\n\nconst roomSchema = z.object({\n  name: z.string().min(1),\n  description: z.string().min(10),\n  category: z.enum(['Standard', 'Deluxe', 'Suite', 'Executive', 'Presidential', 'Family', 'Penthouse']),\n  pricePerNight: z.number().positive(),\n  capacity: z.number().int().positive(),\n  roomNumber: z.string().min(1),\n  images: z.array(z.string()).optional(),\n  amenities: z.array(z.string()).optional(),\n  isAvailable: z.boolean().optional(),\n});\n\nrouter.get('/room-stats', async (req: AuthRequest, res: Response) => {\n  try {\n    const rooms = await Room.find().lean();\n    const occupiedBookings = await Booking.find({ status: 'checked_in' }).lean();\n    \n    const occupiedRoomIdsSet = new Set(\n      occupiedBookings.map((b) => b.roomId.toString())\n    );\n    const occupiedRoomIds = Array.from(occupiedRoomIdsSet);\n\n    const categories = ['Standard', 'Deluxe', 'Suite', 'Executive', 'Presidential', 'Family', 'Penthouse'];\n    \n    const statsByCategory = categories.map((category) => {\n      const categoryRooms = rooms.filter((r) => r.category === category);\n      const totalRooms = categoryRooms.length;\n      const occupiedRooms = categoryRooms.filter((r) => occupiedRoomIdsSet.has(r._id.toString())).length;\n      const availableRooms = categoryRooms.filter(\n        (r) => r.isAvailable && !occupiedRoomIdsSet.has(r._id.toString())\n      ).length;\n\n      return {\n        category,\n        totalRooms,\n        availableRooms,\n        occupiedRooms,\n      };\n    });\n\n    const totals = {\n      totalRooms: rooms.length,\n      availableRooms: rooms.filter((r) => r.isAvailable && !occupiedRoomIdsSet.has(r._id.toString())).length,\n      occupiedRooms: occupiedRoomIdsSet.size,\n    };\n\n    res.json({ statsByCategory, totals, occupiedRoomIds });\n  } catch (error) {\n    console.error('Error fetching room stats:', error);\n    res.status(500).json({ message: 'Failed to fetch room statistics' });\n  }\n});\n\nrouter.get('/stats', async (req: AuthRequest, res: Response) => {\n  try {\n    const [totalRooms, totalBookings, revenueAgg, checkedInCount] = await Promise.all([\n      Room.countDocuments(),\n      Booking.countDocuments({ status: { $ne: 'cancelled' } }),\n      Booking.aggregate([\n        { $match: { paymentStatus: 'paid' } },\n        { $group: { _id: null, total: { $sum: '$totalPrice' } } },\n      ]),\n      Booking.countDocuments({ status: 'checked_in' }),\n    ]);\n\n    const totalRevenue = revenueAgg[0]?.total || 0;\n    const occupancyRate = totalRooms > 0 \n      ? Math.round((checkedInCount / totalRooms) * 100) \n      : 0;\n\n    res.json({\n      totalRooms,\n      totalBookings,\n      totalRevenue,\n      occupancyRate,\n    });\n  } catch (error) {\n    console.error('Error fetching admin stats:', error);\n    res.status(500).json({ message: 'Failed to fetch stats' });\n  }\n});\n\nrouter.get('/rooms', async (req: AuthRequest, res: Response) => {\n  try {\n    const rooms = await Room.find().sort({ createdAt: -1 });\n    res.json(rooms);\n  } catch (error) {\n    console.error('Error fetching rooms:', error);\n    res.status(500).json({ message: 'Failed to fetch rooms' });\n  }\n});\n\nrouter.post('/rooms', async (req: AuthRequest, res: Response) => {\n  try {\n    const data = roomSchema.parse(req.body);\n\n    const existingRoom = await Room.findOne({ roomNumber: data.roomNumber });\n    if (existingRoom) {\n      return res.status(400).json({ message: 'Room number already exists' });\n    }\n\n    const room = new Room({\n      ...data,\n      images: data.images || [],\n      amenities: data.amenities || [],\n      isAvailable: data.isAvailable ?? true,\n    });\n\n    await room.save();\n    res.status(201).json(room.toJSON());\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Error creating room:', error);\n    res.status(500).json({ message: 'Failed to create room' });\n  }\n});\n\nrouter.put('/rooms/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const data = roomSchema.partial().parse(req.body);\n\n    if (data.roomNumber) {\n      const existingRoom = await Room.findOne({\n        roomNumber: data.roomNumber,\n        _id: { $ne: req.params.id },\n      });\n      if (existingRoom) {\n        return res.status(400).json({ message: 'Room number already exists' });\n      }\n    }\n\n    const room = await Room.findByIdAndUpdate(req.params.id, data, { new: true });\n    if (!room) {\n      return res.status(404).json({ message: 'Room not found' });\n    }\n\n    res.json(room.toJSON());\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ message: error.errors[0].message });\n    }\n    console.error('Error updating room:', error);\n    res.status(500).json({ message: 'Failed to update room' });\n  }\n});\n\nrouter.delete('/rooms/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const activeBookings = await Booking.countDocuments({\n      roomId: req.params.id,\n      status: { $in: ['pending', 'confirmed', 'checked_in'] },\n    });\n\n    if (activeBookings > 0) {\n      return res.status(400).json({ message: 'Cannot delete room with active bookings' });\n    }\n\n    const room = await Room.findByIdAndDelete(req.params.id);\n    if (!room) {\n      return res.status(404).json({ message: 'Room not found' });\n    }\n\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting room:', error);\n    res.status(500).json({ message: 'Failed to delete room' });\n  }\n});\n\nrouter.post('/upload', upload.array('images', 5), async (req: Request, res: Response) => {\n  try {\n    const files = req.files as Express.Multer.File[];\n    if (!files || files.length === 0) {\n      return res.status(400).json({ message: 'No files uploaded' });\n    }\n\n    const urls = files.map((file) => `/uploads/${file.filename}`);\n    res.json({ urls });\n  } catch (error) {\n    console.error('Error uploading files:', error);\n    res.status(500).json({ message: 'Failed to upload files' });\n  }\n});\n\nrouter.get('/bookings', async (req: AuthRequest, res: Response) => {\n  try {\n    const { limit = '50' } = req.query;\n    \n    const bookings = await Booking.find()\n      .populate('userId', 'firstName lastName email phone')\n      .populate('roomId', 'name roomNumber category images')\n      .sort({ createdAt: -1 })\n      .limit(Number(limit));\n\n    const bookingsWithDetails = bookings.map((booking) => ({\n      ...booking.toJSON(),\n      user: booking.userId,\n      room: booking.roomId,\n    }));\n\n    res.json(bookingsWithDetails);\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    res.status(500).json({ message: 'Failed to fetch bookings' });\n  }\n});\n\nrouter.patch('/bookings/:id/status', async (req: AuthRequest, res: Response) => {\n  try {\n    const { status } = req.body;\n    \n    if (!['pending', 'confirmed', 'checked_in', 'checked_out', 'cancelled'].includes(status)) {\n      return res.status(400).json({ message: 'Invalid status' });\n    }\n\n    const booking = await Booking.findByIdAndUpdate(\n      req.params.id,\n      { status },\n      { new: true }\n    );\n\n    if (!booking) {\n      return res.status(404).json({ message: 'Booking not found' });\n    }\n\n    res.json(booking.toJSON());\n  } catch (error) {\n    console.error('Error updating booking status:', error);\n    res.status(500).json({ message: 'Failed to update status' });\n  }\n});\n\n// ============ PROMO CODE ROUTES ============\nconst promoCodeSchema = z.object({\n  code: z.string().min(3).max(20),\n  description: z.string().optional(),\n  discountType: z.enum(['percentage', 'fixed']),\n  discountValue: z.number().positive(),\n  minBookingAmount: z.number().min(0).default(0),\n  maxDiscountAmount: z.number().positive().optional(),\n  validFrom: z.string().transform((str) => new Date(str)),\n  validTo: z.string().transform((str) => new Date(str)),\n  usageLimit: z.number().int().positive().optional(),\n  isActive: z.boolean().default(true),\n});\n\nrouter.get('/promo-codes', async (req: AuthRequest, res: Response) => {\n  try {\n    const promoCodes = await PromoCode.find().sort({ createdAt: -1 });\n    res.json(promoCodes);\n  } catch (error) {\n    console.error('Error fetching promo codes:', error);\n    res.status(500).json({ message: 'Failed to fetch promo codes' });\n  }\n});\n\nrouter.get('/promo-codes/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const promoCode = await PromoCode.findById(req.params.id);\n    if (!promoCode) {\n      return res.status(404).json({ message: 'Promo code not found' });\n    }\n    res.json(promoCode.toJSON());\n  } catch (error) {\n    console.error('Error fetching promo code:', error);\n    res.status(500).json({ message: 'Failed to fetch promo code' });\n  }\n});\n\nrouter.post('/promo-codes', async (req: AuthRequest, res: Response) => {\n  try {\n    const validation = promoCodeSchema.safeParse(req.body);\n    if (!validation.success) {\n      return res.status(400).json({ \n        message: 'Validation failed', \n        errors: validation.error.errors \n      });\n    }\n\n    const data = validation.data;\n\n    // Check if code already exists\n    const existingCode = await PromoCode.findOne({ \n      code: data.code.toUpperCase() \n    });\n    if (existingCode) {\n      return res.status(400).json({ message: 'Promo code already exists' });\n    }\n\n    // Validate dates\n    if (data.validTo <= data.validFrom) {\n      return res.status(400).json({ message: 'End date must be after start date' });\n    }\n\n    // Validate percentage discount\n    if (data.discountType === 'percentage' && data.discountValue > 100) {\n      return res.status(400).json({ message: 'Percentage discount cannot exceed 100%' });\n    }\n\n    const promoCode = new PromoCode({\n      ...data,\n      code: data.code.toUpperCase(),\n    });\n    await promoCode.save();\n\n    res.status(201).json(promoCode.toJSON());\n  } catch (error) {\n    console.error('Error creating promo code:', error);\n    res.status(500).json({ message: 'Failed to create promo code' });\n  }\n});\n\nrouter.put('/promo-codes/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const validation = promoCodeSchema.partial().safeParse(req.body);\n    if (!validation.success) {\n      return res.status(400).json({ \n        message: 'Validation failed', \n        errors: validation.error.errors \n      });\n    }\n\n    const data = validation.data;\n\n    // Check if new code already exists (if code is being updated)\n    if (data.code) {\n      const existingCode = await PromoCode.findOne({ \n        code: data.code.toUpperCase(),\n        _id: { $ne: req.params.id }\n      });\n      if (existingCode) {\n        return res.status(400).json({ message: 'Promo code already exists' });\n      }\n      data.code = data.code.toUpperCase();\n    }\n\n    // Validate percentage discount\n    if (data.discountType === 'percentage' && data.discountValue && data.discountValue > 100) {\n      return res.status(400).json({ message: 'Percentage discount cannot exceed 100%' });\n    }\n\n    const promoCode = await PromoCode.findByIdAndUpdate(\n      req.params.id,\n      data,\n      { new: true }\n    );\n\n    if (!promoCode) {\n      return res.status(404).json({ message: 'Promo code not found' });\n    }\n\n    res.json(promoCode.toJSON());\n  } catch (error) {\n    console.error('Error updating promo code:', error);\n    res.status(500).json({ message: 'Failed to update promo code' });\n  }\n});\n\nrouter.delete('/promo-codes/:id', async (req: AuthRequest, res: Response) => {\n  try {\n    const promoCode = await PromoCode.findByIdAndDelete(req.params.id);\n    if (!promoCode) {\n      return res.status(404).json({ message: 'Promo code not found' });\n    }\n    res.json({ success: true });\n  } catch (error) {\n    console.error('Error deleting promo code:', error);\n    res.status(500).json({ message: 'Failed to delete promo code' });\n  }\n});\n\nrouter.patch('/promo-codes/:id/toggle', async (req: AuthRequest, res: Response) => {\n  try {\n    const promoCode = await PromoCode.findById(req.params.id);\n    if (!promoCode) {\n      return res.status(404).json({ message: 'Promo code not found' });\n    }\n\n    promoCode.isActive = !promoCode.isActive;\n    await promoCode.save();\n\n    res.json(promoCode.toJSON());\n  } catch (error) {\n    console.error('Error toggling promo code:', error);\n    res.status(500).json({ message: 'Failed to toggle promo code' });\n  }\n});\n\nexport default router;\n","path":null,"size_bytes":13585,"size_tokens":null},"client/src/pages/Rooms.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { \n  Search, \n  Star, \n  Filter, \n  X, \n  Users,\n  SlidersHorizontal \n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n  SheetFooter,\n} from \"@/components/ui/sheet\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Slider } from \"@/components/ui/slider\";\nimport type { Room, Review, RoomCategory, RoomFilters } from \"@shared/schema\";\nimport { roomCategories, predefinedAmenities } from \"@shared/schema\";\n\ninterface RoomWithReviews extends Room {\n  reviews: Review[];\n  averageRating: number;\n}\n\nfunction RoomCard({ room }: { room: RoomWithReviews }) {\n  return (\n    <Card className=\"overflow-hidden group hover-elevate\" data-testid={`card-room-${room._id}`}>\n      <div className=\"flex flex-col md:flex-row\">\n        <div className=\"relative md:w-72 lg:w-80 shrink-0\">\n          <div className=\"aspect-[4/3] md:aspect-auto md:h-full overflow-hidden\">\n            {room.images[0] ? (\n              <img\n                src={room.images[0]}\n                alt={room.name}\n                className=\"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\"\n              />\n            ) : (\n              <div className=\"w-full h-full bg-muted flex items-center justify-center min-h-[200px]\">\n                <span className=\"text-muted-foreground\">No image</span>\n              </div>\n            )}\n          </div>\n          <div className=\"absolute top-3 left-3\">\n            <Badge variant=\"secondary\" className=\"bg-primary text-primary-foreground\">\n              {room.category}\n            </Badge>\n          </div>\n        </div>\n        \n        <CardContent className=\"flex-1 p-5 flex flex-col\">\n          <div className=\"flex items-start justify-between gap-2 mb-2\">\n            <h3 className=\"font-semibold text-xl\">{room.name}</h3>\n            {room.averageRating > 0 && (\n              <div className=\"flex items-center gap-1 shrink-0\">\n                <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-400\" />\n                <span className=\"text-sm font-medium\">{room.averageRating.toFixed(1)}</span>\n                <span className=\"text-xs text-muted-foreground\">\n                  ({room.reviews.length} reviews)\n                </span>\n              </div>\n            )}\n          </div>\n          \n          <p className=\"text-sm text-muted-foreground line-clamp-2 mb-4\">\n            {room.description}\n          </p>\n          \n          <div className=\"flex flex-wrap gap-2 mb-4\">\n            {room.amenities.slice(0, 4).map((amenity) => (\n              <Badge key={amenity} variant=\"outline\" className=\"text-xs\">\n                {amenity}\n              </Badge>\n            ))}\n            {room.amenities.length > 4 && (\n              <Badge variant=\"outline\" className=\"text-xs\">\n                +{room.amenities.length - 4} more\n              </Badge>\n            )}\n          </div>\n          \n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-4\">\n            <Users className=\"h-4 w-4\" />\n            <span>Up to {room.capacity} guests</span>\n          </div>\n          \n          <div className=\"mt-auto flex items-center justify-between gap-4\">\n            <div>\n              <span className=\"text-2xl font-bold\">${room.pricePerNight}</span>\n              <span className=\"text-sm text-muted-foreground\">/night</span>\n            </div>\n            <Button asChild>\n              <Link href={`/rooms/${room._id}`} data-testid={`link-view-room-${room._id}`}>\n                View Details\n              </Link>\n            </Button>\n          </div>\n        </CardContent>\n      </div>\n    </Card>\n  );\n}\n\nfunction RoomCardSkeleton() {\n  return (\n    <Card className=\"overflow-hidden\">\n      <div className=\"flex flex-col md:flex-row\">\n        <Skeleton className=\"aspect-[4/3] md:w-72 lg:w-80 md:aspect-auto md:h-64\" />\n        <CardContent className=\"flex-1 p-5 space-y-4\">\n          <div className=\"flex justify-between\">\n            <Skeleton className=\"h-6 w-1/2\" />\n            <Skeleton className=\"h-4 w-16\" />\n          </div>\n          <Skeleton className=\"h-4 w-full\" />\n          <Skeleton className=\"h-4 w-3/4\" />\n          <div className=\"flex gap-2\">\n            <Skeleton className=\"h-6 w-16\" />\n            <Skeleton className=\"h-6 w-16\" />\n            <Skeleton className=\"h-6 w-16\" />\n          </div>\n          <div className=\"flex justify-between items-center pt-4\">\n            <Skeleton className=\"h-8 w-24\" />\n            <Skeleton className=\"h-10 w-28\" />\n          </div>\n        </CardContent>\n      </div>\n    </Card>\n  );\n}\n\nexport default function Rooms() {\n  const [filters, setFilters] = useState<RoomFilters>({});\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [priceRange, setPriceRange] = useState([0, 1000]);\n  const [selectedAmenities, setSelectedAmenities] = useState<string[]>([]);\n  const [isFilterOpen, setIsFilterOpen] = useState(false);\n\n  const queryParams = new URLSearchParams();\n  if (filters.category) queryParams.set(\"category\", filters.category);\n  if (filters.minPrice) queryParams.set(\"minPrice\", String(filters.minPrice));\n  if (filters.maxPrice) queryParams.set(\"maxPrice\", String(filters.maxPrice));\n  if (filters.amenities?.length) queryParams.set(\"amenities\", filters.amenities.join(\",\"));\n\n  const { data: rooms, isLoading } = useQuery<RoomWithReviews[]>({\n    queryKey: [\"/api/rooms\", queryParams.toString()],\n  });\n\n  const filteredRooms = rooms?.filter((room) => {\n    if (searchQuery) {\n      const query = searchQuery.toLowerCase();\n      if (\n        !room.name.toLowerCase().includes(query) &&\n        !room.description.toLowerCase().includes(query)\n      ) {\n        return false;\n      }\n    }\n    return true;\n  });\n\n  const applyFilters = () => {\n    setFilters({\n      ...filters,\n      minPrice: priceRange[0] > 0 ? priceRange[0] : undefined,\n      maxPrice: priceRange[1] < 1000 ? priceRange[1] : undefined,\n      amenities: selectedAmenities.length > 0 ? selectedAmenities : undefined,\n    });\n    setIsFilterOpen(false);\n  };\n\n  const clearFilters = () => {\n    setFilters({});\n    setPriceRange([0, 1000]);\n    setSelectedAmenities([]);\n    setSearchQuery(\"\");\n  };\n\n  const hasActiveFilters = \n    filters.category || \n    filters.minPrice || \n    filters.maxPrice || \n    (filters.amenities && filters.amenities.length > 0);\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"bg-card border-b\">\n        <div className=\"container mx-auto px-4 py-8\">\n          <h1 className=\"text-3xl md:text-4xl font-serif font-bold mb-2\">\n            Our Rooms\n          </h1>\n          <p className=\"text-muted-foreground\">\n            Find your perfect accommodation from our collection of luxury rooms.\n          </p>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"flex flex-col md:flex-row gap-4 mb-8\">\n          <div className=\"relative flex-1\">\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Search rooms...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"input-search-rooms\"\n            />\n          </div>\n\n          <Select\n            value={filters.category || \"all\"}\n            onValueChange={(value) =>\n              setFilters({\n                ...filters,\n                category: value === \"all\" ? undefined : (value as RoomCategory),\n              })\n            }\n          >\n            <SelectTrigger className=\"w-full md:w-48\" data-testid=\"select-category\">\n              <SelectValue placeholder=\"Category\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">All Categories</SelectItem>\n              {roomCategories.map((category) => (\n                <SelectItem key={category} value={category}>\n                  {category}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n\n          <Sheet open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"outline\" className=\"gap-2\" data-testid=\"button-filters\">\n                <SlidersHorizontal className=\"h-4 w-4\" />\n                Filters\n                {hasActiveFilters && (\n                  <Badge variant=\"secondary\" className=\"ml-1\">Active</Badge>\n                )}\n              </Button>\n            </SheetTrigger>\n            <SheetContent className=\"w-full sm:max-w-md\">\n              <SheetHeader>\n                <SheetTitle>Filter Rooms</SheetTitle>\n              </SheetHeader>\n              \n              <div className=\"py-6 space-y-6\">\n                <div className=\"space-y-4\">\n                  <Label>Price Range (per night)</Label>\n                  <Slider\n                    value={priceRange}\n                    onValueChange={setPriceRange}\n                    min={0}\n                    max={1000}\n                    step={50}\n                    data-testid=\"slider-price-range\"\n                  />\n                  <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                    <span>${priceRange[0]}</span>\n                    <span>${priceRange[1]}+</span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-4\">\n                  <Label>Amenities</Label>\n                  <div className=\"grid grid-cols-2 gap-3 max-h-64 overflow-y-auto\">\n                    {predefinedAmenities.filter(a => a !== \"Other\").map((amenity) => (\n                      <div key={amenity} className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id={amenity}\n                          checked={selectedAmenities.includes(amenity)}\n                          onCheckedChange={(checked) => {\n                            setSelectedAmenities(\n                              checked\n                                ? [...selectedAmenities, amenity]\n                                : selectedAmenities.filter((a) => a !== amenity)\n                            );\n                          }}\n                          data-testid={`checkbox-amenity-${amenity}`}\n                        />\n                        <label\n                          htmlFor={amenity}\n                          className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer\"\n                        >\n                          {amenity}\n                        </label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              <SheetFooter className=\"gap-2\">\n                <Button variant=\"outline\" onClick={clearFilters} data-testid=\"button-clear-filters\">\n                  Clear All\n                </Button>\n                <Button onClick={applyFilters} data-testid=\"button-apply-filters\">\n                  Apply Filters\n                </Button>\n              </SheetFooter>\n            </SheetContent>\n          </Sheet>\n\n          {hasActiveFilters && (\n            <Button \n              variant=\"ghost\" \n              size=\"icon\"\n              onClick={clearFilters}\n              data-testid=\"button-clear-all-filters\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          )}\n        </div>\n\n        {hasActiveFilters && (\n          <div className=\"flex flex-wrap gap-2 mb-6\">\n            {filters.category && (\n              <Badge variant=\"secondary\" className=\"gap-1\">\n                {filters.category}\n                <X\n                  className=\"h-3 w-3 cursor-pointer\"\n                  onClick={() => setFilters({ ...filters, category: undefined })}\n                />\n              </Badge>\n            )}\n            {(filters.minPrice || filters.maxPrice) && (\n              <Badge variant=\"secondary\" className=\"gap-1\">\n                ${filters.minPrice || 0} - ${filters.maxPrice || \"1000+\"}\n                <X\n                  className=\"h-3 w-3 cursor-pointer\"\n                  onClick={() => setFilters({ ...filters, minPrice: undefined, maxPrice: undefined })}\n                />\n              </Badge>\n            )}\n            {filters.amenities?.map((amenity) => (\n              <Badge key={amenity} variant=\"secondary\" className=\"gap-1\">\n                {amenity}\n                <X\n                  className=\"h-3 w-3 cursor-pointer\"\n                  onClick={() =>\n                    setFilters({\n                      ...filters,\n                      amenities: filters.amenities?.filter((a) => a !== amenity),\n                    })\n                  }\n                />\n              </Badge>\n            ))}\n          </div>\n        )}\n\n        <div className=\"space-y-6\">\n          {isLoading ? (\n            <>\n              <RoomCardSkeleton />\n              <RoomCardSkeleton />\n              <RoomCardSkeleton />\n            </>\n          ) : filteredRooms && filteredRooms.length > 0 ? (\n            filteredRooms.map((room) => (\n              <RoomCard key={room._id} room={room} />\n            ))\n          ) : (\n            <div className=\"text-center py-16\">\n              <Filter className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n              <h3 className=\"text-lg font-semibold mb-2\">No rooms found</h3>\n              <p className=\"text-muted-foreground mb-4\">\n                Try adjusting your filters or search criteria.\n              </p>\n              <Button variant=\"outline\" onClick={clearFilters}>\n                Clear Filters\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":14401,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null}},"version":2}